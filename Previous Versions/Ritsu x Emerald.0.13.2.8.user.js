// ==UserScript==
// @name         Ritsu x Emerald
// @version      0.13.2.8
// @description  Custom Emerald Chat themes and fixes.
// @author       Atsos/Ritsu, Aqua, Strawberry, Teriyaki
// @icon         https://i.imgur.com/KLtVhho.png
// @match        *://emeraldchat.com/app
// @match        *://www.emeraldchat.com/app
// @namespace    Emerald Bot - Ritsu Project
// @run-at       document-end
// @grant        GM_getValue
// @grant        GM_deleteValue
// @grant        unsafeWindow
// ==/UserScript==
/*! For license information please see ritsu-emerald.user.js.LICENSE.txt */
!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=72)}([function(t,e){t.exports=React},function(t,e,n){"use strict";(function(t,i){n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return y})),n.d(e,"c",(function(){return w})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return x})),n.d(e,"g",(function(){return f})),n.d(e,"h",(function(){return h})),n.d(e,"i",(function(){return A})),n.d(e,"j",(function(){return p})),n.d(e,"k",(function(){return b})),n.d(e,"l",(function(){return g})),n.d(e,"m",(function(){return v}));const r=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},o={_:null,q:null,tt:null,et:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.nt();const n=e?this.tt:this._,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],o=e+1<t.length,s=o?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=r>>2,l=(3&r)<<4|s>>4;let h=(15&s)<<2|c>>6,f=63&c;a||(f=64,o||(h=64)),i.push(n[u],n[l],n[h],n[f])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const o=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&o)}else if(r>239&&r<365){const o=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(o>>10)),e[i++]=String.fromCharCode(56320+(1023&o))}else{const o=t[n++],s=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.nt();const n=e?this.et:this.q,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const c=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==o||null==a||null==c)throw new s;const u=r<<2|o>>4;if(i.push(u),64!==a){const t=o<<4&240|a>>2;if(i.push(t),64!==c){const t=a<<6&192|c;i.push(t)}}}return i},nt(){if(!this._){this._={},this.q={},this.tt={},this.et={};for(let t=0;t<this.ENCODED_VALS.length;t++)this._[t]=this.ENCODED_VALS.charAt(t),this.q[this._[t]]=t,this.tt[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.et[this.tt[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.q[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.et[this.ENCODED_VALS.charAt(t)]=t)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(t){return function(t){const e=r(t);return o.encodeByteArray(e,!0)}(t).replace(/\./g,"")},c=function(t){try{return o.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const u=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}().it,l=()=>{try{return u()||(()=>{if(void 0===i||void 0===i.env)return;const t=i.env.it;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&c(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: "+t)}},h=t=>{const e=(t=>{var e,n;return null===(n=null===(e=l())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]},f=()=>{var t;return null===(t=l())||void 0===t?void 0:t.config};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,n))}}}function m(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:"https://securetoken.google.com/"+n,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(o)),""].join(".")}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function g(){return!function(){var e;const n=null===(e=l())||void 0===e?void 0:e.forceEnvironment;if("node"===n)return!0;if("browser"===n)return!1;try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(t){return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function b(){try{return"object"==typeof indexedDB}catch(t){return!1}}function v(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})}class w extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,y.prototype.create)}}class y{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],o=r?function(t,e){return t.replace(k,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(r,n):"Error",s=`${this.serviceName}: ${o} (${i}).`;return new w(i,s,n)}}const k=/\{\$([^}]+)}/g;function x(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],o=e[r];if(C(n)&&C(o)){if(!x(n,o))return!1}else if(n!==o)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function C(t){return null!==t&&"object"==typeof t}function A(t){return t&&t._delegate?t._delegate:t}}).call(this,n(13),n(14))},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var r=(s=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),o=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(t," */")}));return[n].concat(o).concat([r]).join("\n")}var s,a,c;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,i){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(i)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(r[s]=!0)}for(var a=0;a<t.length;a++){var c=[].concat(t[a]);i&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return li})),n.d(e,"b",(function(){return fi})),n.d(e,"c",(function(){return hi})),n.d(e,"d",(function(){return mi})),n.d(e,"e",(function(){return vi})),n.d(e,"f",(function(){return bi})),n.d(e,"g",(function(){return di})),n.d(e,"h",(function(){return pi})),n.d(e,"i",(function(){return gi})),n.d(e,"j",(function(){return ci})),n.d(e,"k",(function(){return ui}));var i,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},o={},s=s||{},a=r||self;function c(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function u(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var l="closure_uid_"+(1e9*Math.random()>>>0),h=0;function f(t,e,n){return t.call.apply(t.bind,arguments)}function d(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function m(t,e,n){return(m=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?f:d).apply(null,arguments)}function p(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function g(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var r=Array(arguments.length-2),o=2;o<arguments.length;o++)r[o-2]=arguments[o];return e.prototype[n].apply(t,r)}}function b(){this.s=this.s,this.o=this.o}b.prototype.s=!1,b.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,l)&&t[l]||(t[l]=++h))},b.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const v=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function w(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function y(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(c(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function k(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var x=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",()=>{},e),a.removeEventListener("test",()=>{},e)}catch(t){}return t}();function C(t){return/^[\s\xa0]*$/.test(t)}function A(){var t=a.navigator;return t&&(t=t.userAgent)?t:""}function R(t){return-1!=A().indexOf(t)}function E(t){return E[" "](t),t}E[" "]=function(){};var M,N,S,T=R("Opera"),_=R("Trident")||R("MSIE"),I=R("Edge"),D=I||_,O=R("Gecko")&&!(-1!=A().toLowerCase().indexOf("webkit")&&!R("Edge"))&&!(R("Trident")||R("MSIE"))&&!R("Edge"),$=-1!=A().toLowerCase().indexOf("webkit")&&!R("Edge");function P(){var t=a.document;return t?t.documentMode:void 0}t:{var U="",j=(N=A(),O?/rv:([^\);]+)(\)|;)/.exec(N):I?/Edge\/([\d\.]+)/.exec(N):_?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(N):$?/WebKit\/(\S+)/.exec(N):T?/(?:Version)[ \/]?(\S+)/.exec(N):void 0);if(j&&(U=j?j[1]:""),_){var F=P();if(null!=F&&F>parseFloat(U)){M=String(F);break t}}M=U}if(a.document&&_){var L=P();S=L||(parseInt(M,10)||void 0)}else S=void 0;var V=S;function B(t,e){if(k.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(O){t:{try{E(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:G[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&B.$.h.call(this)}}g(B,k);var G={2:"touch",3:"pen",4:"mouse"};B.prototype.h=function(){B.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var z="closure_listenable_"+(1e6*Math.random()|0),q=0;function H(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=r,this.key=++q,this.fa=this.ia=!1}function K(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Q(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function J(t){const e={};for(const n in t)e[n]=t[n];return e}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<W.length;e++)n=W[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function Y(t){this.src=t,this.g={},this.h=0}function Z(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],o=v(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(K(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function tt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.fa&&o.listener==e&&o.capture==!!n&&o.la==i)return r}return-1}Y.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=tt(t,e,i,r);return-1<s?(e=t[s],n||(e.ia=!1)):((e=new H(e,this.src,o,!!i,r)).ia=n,t.push(e)),e};var et="closure_lm_"+(1e6*Math.random()|0),nt={};function it(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=lt(i),e&&e[z]?e.P(n,i,u(r)?!!r.capture:!!r,o):rt(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)it(t,e[o],n,i,r);return null}return n=lt(n),t&&t[z]?t.O(e,n,u(i)?!!i.capture:!!i,r):rt(t,e,n,!1,i,r)}function rt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=u(r)?!!r.capture:!!r,a=ct(t);if(a||(t[et]=a=new Y(t)),(n=a.add(e,n,i,s,o)).proxy)return n;if(i=function(){const t=at;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)x||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(st(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function ot(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[z])Z(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(st(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=ct(e))?(Z(n,t),0==n.h&&(n.src=null,e[et]=null)):K(t)}}}function st(t){return t in nt?nt[t]:nt[t]="on"+t}function at(t,e){if(t.fa)t=!0;else{e=new B(e,this);var n=t.listener,i=t.la||t.src;t.ia&&ot(t),t=n.call(i,e)}return t}function ct(t){return(t=t[et])instanceof Y?t:null}var ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function lt(t){return"function"==typeof t?t:(t[ut]||(t[ut]=function(e){return t.handleEvent(e)}),t[ut])}function ht(){b.call(this),this.i=new Y(this),this.S=this,this.J=null}function ft(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new k(e,t);else if(e instanceof k)e.target=e.target||t;else{var r=e;X(e=new k(i,t),r)}if(r=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];r=dt(s,i,!0,e)&&r}if(r=dt(s=e.g=t,i,!0,e)&&r,r=dt(s,i,!1,e)&&r,n)for(o=0;o<n.length;o++)r=dt(s=e.g=n[o],i,!1,e)&&r}function dt(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.fa&&s.capture==n){var a=s.listener,c=s.la||s.src;s.ia&&Z(t.i,s),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}g(ht,b),ht.prototype[z]=!0,ht.prototype.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=u(r)?!!r.capture:!!r,i=lt(i),e&&e[z]?(e=e.i,(n=String(n).toString())in e.g&&(-1<(i=tt(s=e.g[n],i,r,o))&&(K(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.g[n],e.h--)))):e&&(e=ct(e))&&(n=e.g[n.toString()],e=-1,n&&(e=tt(n,i,r,o)),(i=-1<e?n[e]:null)&&ot(i))}(this,t,e,n,i)},ht.prototype.N=function(){if(ht.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)K(n[i]);delete e.g[t],e.h--}}this.J=null},ht.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},ht.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var mt=a.JSON.stringify;function pt(){var t=xt;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var gt=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new bt,t=>t.reset());class bt{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function vt(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function wt(t){a.setTimeout(()=>{throw t},0)}let yt,kt=!1,xt=new class{constructor(){this.h=this.g=null}add(t,e){const n=gt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},Ct=()=>{const t=a.Promise.resolve(void 0);yt=()=>{t.then(At)}};var At=()=>{for(var t;t=pt();){try{t.h.call(t.g)}catch(t){wt(t)}var e=gt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}kt=!1};function Rt(t,e){ht.call(this),this.h=t||1,this.g=e||a,this.j=m(this.qb,this),this.l=Date.now()}function Et(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function Mt(t,e,n){if("function"==typeof t)n&&(t=m(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=m(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}g(Rt,ht),(i=Rt.prototype).ga=!1,i.T=null,i.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ft(this,"tick"),this.ga&&(Et(this),this.start()))}},i.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},i.N=function(){Rt.$.N.call(this),Et(this),delete this.g};class Nt extends b{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:function t(e){e.g=Mt(()=>{e.g=null,e.i&&(e.i=!1,t(e))},e.j);const n=e.h;e.h=null,e.m.apply(null,n)}(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function St(t){b.call(this),this.h=t,this.g={}}g(St,b);var Tt=[];function _t(t,e,n,i){Array.isArray(n)||(n&&(Tt[0]=n.toString()),n=Tt);for(var r=0;r<n.length;r++){var o=it(e,n[r],i||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function It(t){Q(t.g,(function(t,e){this.g.hasOwnProperty(e)&&ot(t)}),t),t.g={}}function Dt(){this.g=!0}function Ot(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return mt(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}St.prototype.N=function(){St.$.N.call(this),It(this)},St.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Dt.prototype.Ea=function(){this.g=!1},Dt.prototype.info=function(){};var $t={},Pt=null;function Ut(){return Pt=Pt||new ht}function jt(t){k.call(this,$t.Ta,t)}function Ft(t){const e=Ut();ft(e,new jt(e))}function Lt(t,e){k.call(this,$t.STAT_EVENT,t),this.stat=e}function Vt(t){const e=Ut();ft(e,new Lt(e,t))}function Bt(t,e){k.call(this,$t.Ua,t),this.size=e}function Gt(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){t()}),e)}$t.Ta="serverreachability",g(jt,k),$t.STAT_EVENT="statevent",g(Lt,k),$t.Ua="timingevent",g(Bt,k);var zt={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},qt={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Ht(){}function Kt(t){return t.h||(t.h=t.i())}function Qt(){}Ht.prototype.h=null;var Jt,Wt={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Xt(){k.call(this,"d")}function Yt(){k.call(this,"c")}function Zt(){}function te(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new St(this),this.P=ne,t=D?125:void 0,this.V=new Rt(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new ee}function ee(){this.i=null,this.g="",this.h=!1}g(Xt,k),g(Yt,k),g(Zt,Ht),Zt.prototype.g=function(){return new XMLHttpRequest},Zt.prototype.i=function(){return{}},Jt=new Zt;var ne=45e3,ie={},re={};function oe(t,e,n){t.L=1,t.v=Ae(we(e)),t.s=n,t.S=!0,se(t,null)}function se(t,e){t.G=Date.now(),le(t),t.A=we(t.v);var n=t.A,i=t.W;Array.isArray(i)||(i=[String(i)]),Ue(n.i,"t",i),t.C=0,n=t.l.J,t.h=new ee,t.g=Pn(t.l,n?e:null,!t.s),0<t.O&&(t.M=new Nt(m(t.Pa,t,t.g),t.O)),_t(t.U,t.g,"readystatechange",t.nb),e=t.I?J(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Ft(),function(t,e,n,i,r,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+u+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.W,t.s)}function ae(t){return!!t.g&&("GET"==t.u&&2!=t.L&&t.l.Ha)}function ce(t,e,n){let i,r=!0;for(;!t.J&&t.C<n.length;){if(i=ue(t,n),i==re){4==e&&(t.o=4,Vt(14),r=!1),Ot(t.j,t.m,null,"[Incomplete Response]");break}if(i==ie){t.o=4,Vt(15),Ot(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}Ot(t.j,t.m,i,null),pe(t,i)}ae(t)&&i!=re&&i!=ie&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Vt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Nn(e),e.M=!0,Vt(11))):(Ot(t.j,t.m,n,"[Invalid Chunked Response]"),me(t),de(t))}function ue(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?re:(n=Number(e.substring(n,i)),isNaN(n)?ie:(i+=1)+n>e.length?re:(e=e.slice(i,i+n),t.C=i+n,e))}function le(t){t.Y=Date.now()+t.P,he(t,t.P)}function he(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Gt(m(t.lb,t),e)}function fe(t){t.B&&(a.clearTimeout(t.B),t.B=null)}function de(t){0==t.l.H||t.J||_n(t.l,t)}function me(t){fe(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,Et(t.V),It(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function pe(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||Ge(n.i,t)))if(!t.K&&Ge(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;Tn(n),yn(n)}Mn(n),Vt(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=Gt(m(n.ib,n),6e3));if(1>=Be(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else Dn(n,11)}else if((t.K||n.g==t)&&Tn(n),!C(e))for(r=n.Ja.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const e=u[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const r=u[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(i=1.5*l,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var o=i.i;o.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(ze(o,o.h),o.h=null))}if(i.F){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,Ce(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var s=t;if((i=n).wa=$n(i,i.J?i.pa:null,i.Y),s.K){qe(i.i,s);var a=s,c=i.L;c&&a.setTimeout(c),a.B&&(fe(a),le(a)),i.g=s}else En(i);0<n.j.length&&xn(n)}else"stop"!=u[0]&&"close"!=u[0]||Dn(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Dn(n,7):wn(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}Ft()}catch(t){}}function ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(c(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(c(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(c(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}(i=te.prototype).setTimeout=function(t){this.P=t},i.nb=function(t){t=t.target;const e=this.M;e&&3==dn(t)?e.l():this.Pa(t)},i.Pa=function(t){try{if(t==this.g)t:{const h=dn(this.g);var e=this.g.Ia();this.g.da();if(!(3>h)&&(3!=h||D||this.g&&(this.h.h||this.g.ja()||mn(this.g)))){this.J||4!=h||7==e||Ft(),fe(this);var n=this.g.da();this.ca=n;e:if(ae(this)){var i=mn(this.g);t="";var r=i.length,o=4==dn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){me(this),de(this);var s="";break e}this.h.i=new a.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:o&&e==r-1});i.splice(0,r),this.h.g+=t,this.C=0,s=this.h.g}else s=this.g.ja();if(this.i=200==n,function(t,e,n,i,r,o,s){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(c)){var l=c;break e}}l=null}if(!(n=l)){this.i=!1,this.o=3,Vt(12),me(this),de(this);break t}Ot(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,pe(this,n)}this.S?(ce(this,h,s),D&&this.i&&3==h&&(_t(this.U,this.V,"tick",this.mb),this.V.start())):(Ot(this.j,this.m,s,null),pe(this,s)),4==h&&me(this),this.i&&!this.J&&(4==h?_n(this.l,this):(this.i=!1,le(this)))}else(function(t){const e={};t=(t.g&&2<=dn(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(C(t[i]))continue;var n=vt(t[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const o=e[r]||[];e[r]=o,o.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.o=3,Vt(12)):(this.o=0,Vt(13)),me(this),de(this)}}}catch(t){}},i.mb=function(){if(this.g){var t=dn(this.g),e=this.g.ja();this.C<e.length&&(fe(this),ce(this,t,e),this.i&&4!=t&&le(this))}},i.cancel=function(){this.J=!0,me(this)},i.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.L&&(Ft(),Vt(17)),me(this),this.o=2,de(this)):he(this,this.Y-t)};var be=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ve(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof ve){this.h=t.h,ye(this,t.j),this.s=t.s,this.g=t.g,ke(this,t.m),this.l=t.l;var e=t.i,n=new De;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),xe(this,n),this.o=t.o}else t&&(e=String(t).match(be))?(this.h=!1,ye(this,e[1]||"",!0),this.s=Re(e[2]||""),this.g=Re(e[3]||"",!0),ke(this,e[4]),this.l=Re(e[5]||"",!0),xe(this,e[6]||"",!0),this.o=Re(e[7]||"")):(this.h=!1,this.i=new De(null,this.h))}function we(t){return new ve(t)}function ye(t,e,n){t.j=n?Re(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ke(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function xe(t,e,n){e instanceof De?(t.i=e,function(t,e){e&&!t.j&&(Oe(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&($e(this,e),Ue(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=Ee(e,_e)),t.i=new De(e,t.h))}function Ce(t,e,n){t.i.set(e,n)}function Ae(t){return Ce(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Re(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ee(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Me),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Me(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ve.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ee(e,Ne,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Ee(e,Ne,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ee(n,"/"==n.charAt(0)?Te:Se,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ee(n,Ie)),t.join("")};var Ne=/[#\/\?@]/g,Se=/[#\?:]/g,Te=/[#\?]/g,_e=/[#\?@]/g,Ie=/#/g;function De(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Oe(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function $e(t,e){Oe(t),e=je(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Pe(t,e){return Oe(t),e=je(t,e),t.g.has(e)}function Ue(t,e,n){$e(t,e),0<n.length&&(t.i=null,t.g.set(je(t,e),w(n)),t.h+=n.length)}function je(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(i=De.prototype).add=function(t,e){Oe(this),this.i=null,t=je(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},i.forEach=function(t,e){Oe(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},i.ta=function(){Oe(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},i.Z=function(t){Oe(this);let e=[];if("string"==typeof t)Pe(this,t)&&(e=e.concat(this.g.get(je(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},i.set=function(t,e){return Oe(this),this.i=null,Pe(this,t=je(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},i.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const o=encodeURIComponent(String(i)),s=this.Z(i);for(i=0;i<s.length;i++){var r=o;""!==s[i]&&(r+="="+encodeURIComponent(String(s[i]))),t.push(r)}}return this.i=t.join("&")};function Fe(t){this.l=t||Le,a.PerformanceNavigationTiming?t=0<(t=a.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(a.g&&a.g.Ka&&a.g.Ka()&&a.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Le=10;function Ve(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Be(t){return t.h?1:t.g?t.g.size:0}function Ge(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ze(t,e){t.g?t.g.add(e):t.h=e}function qe(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function He(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return w(t.i)}Fe.prototype.cancel=function(){if(this.i=He(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};function Ke(){this.g=new class{stringify(t){return a.JSON.stringify(t,void 0)}parse(t){return a.JSON.parse(t,void 0)}}}function Qe(t,e,n){const i=n||"";try{ge(t,(function(t,n){let r=t;u(t)&&(r=mt(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Je(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function We(t){this.l=t.ec||null,this.j=t.ob||!1}function Xe(t,e){ht.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Ye,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}g(We,Ht),We.prototype.g=function(){return new Xe(this.l,this.j)},We.prototype.i=function(t){return function(){return t}}({}),g(Xe,ht);var Ye=0;function Ze(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function tn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,en(t)}function en(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(i=Xe.prototype).open=function(t,e){if(this.readyState!=Ye)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,en(this)},i.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||a).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},i.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,tn(this)),this.readyState=Ye},i.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,en(this)),this.g&&(this.readyState=3,en(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==a.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ze(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},i.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?tn(this):en(this),3==this.readyState&&Ze(this)}},i.Za=function(t){this.g&&(this.response=this.responseText=t,tn(this))},i.Ya=function(t){this.g&&(this.response=t,tn(this))},i.ka=function(){this.g&&tn(this)},i.setRequestHeader=function(t,e){this.v.append(t,e)},i.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Xe.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var nn=a.JSON.parse;function rn(t){ht.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=on,this.L=this.M=!1}g(rn,ht);var on="",sn=/^https?$/i,an=["POST","PUT"];function cn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,un(t),hn(t)}function un(t){t.F||(t.F=!0,ft(t,"complete"),ft(t,"error"))}function ln(t){if(t.h&&void 0!==s&&(!t.C[1]||4!=dn(t)||2!=t.da()))if(t.v&&4==dn(t))Mt(t.La,0,t);else if(ft(t,"readystatechange"),4==dn(t)){t.h=!1;try{const s=t.da();t:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===s){var r=String(t.I).match(be)[1]||null;!r&&a.self&&a.self.location&&(r=a.self.location.protocol.slice(0,-1)),i=!sn.test(r?r.toLowerCase():"")}n=i}if(n)ft(t,"complete"),ft(t,"success");else{t.m=6;try{var o=2<dn(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.da()+"]",un(t)}}finally{hn(t)}}}function hn(t,e){if(t.g){fn(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||ft(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function fn(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(a.clearTimeout(t.A),t.A=null)}function dn(t){return t.g?t.g.readyState:0}function mn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case on:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function pn(t){let e="";return Q(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function gn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=pn(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ce(t,e,n))}function bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function vn(t){this.Ga=0,this.j=[],this.l=new Dt,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=bn("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=bn("baseRetryDelayMs",5e3,t),this.hb=bn("retryDelaySeedMs",1e4,t),this.eb=bn("forwardChannelMaxRetries",2,t),this.xa=bn("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Fe(t&&t.concurrentRequestLimit),this.Ja=new Ke,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function wn(t){if(kn(t),3==t.H){var e=t.W++,n=we(t.I);if(Ce(n,"SID",t.K),Ce(n,"RID",e),Ce(n,"TYPE","terminate"),An(t,n),(e=new te(t,t.l,e)).L=2,e.v=Ae(we(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(e.v.toString(),"")}catch(t){}!n&&a.Image&&((new Image).src=e.v,n=!0),n||(e.g=Pn(e.l,null),e.g.ha(e.v)),e.G=Date.now(),le(e)}On(t)}function yn(t){t.g&&(Nn(t),t.g.cancel(),t.g=null)}function kn(t){yn(t),t.u&&(a.clearTimeout(t.u),t.u=null),Tn(t),t.i.cancel(),t.m&&("number"==typeof t.m&&a.clearTimeout(t.m),t.m=null)}function xn(t){if(!Ve(t.i)&&!t.m){t.m=!0;var e=t.Na;yt||Ct(),kt||(yt(),kt=!0),xt.add(e,t),t.C=0}}function Cn(t,e){var n;n=e?e.m:t.W++;const i=we(t.I);Ce(i,"SID",t.K),Ce(i,"RID",n),Ce(i,"AID",t.V),An(t,i),t.o&&t.s&&gn(i,t.o,t.s),n=new te(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Rn(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),ze(t.i,n),oe(n,i,e)}function An(t,e){t.na&&Q(t.na,(function(t,n){Ce(e,n,t)})),t.h&&ge({},(function(t,n){Ce(e,n,t)}))}function Rn(t,e,n){n=Math.min(t.j.length,n);var i=t.h?m(t.h.Va,t.h,t):null;t:{var r=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let s=0;s<n;s++){let n=r[s].g;const a=r[s].map;if(n-=e,0>n)e=Math.max(0,r[s].g-100),o=!1;else try{Qe(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(o){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function En(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;yt||Ct(),kt||(yt(),kt=!0),xt.add(e,t),t.A=0}}function Mn(t){return!(t.g||t.u||3<=t.A)&&(t.ba++,t.u=Gt(m(t.Ma,t),In(t,t.A)),t.A++,!0)}function Nn(t){null!=t.B&&(a.clearTimeout(t.B),t.B=null)}function Sn(t){t.g=new te(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=we(t.wa);Ce(e,"RID","rpc"),Ce(e,"SID",t.K),Ce(e,"AID",t.V),Ce(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Ce(e,"TO",t.qa),Ce(e,"TYPE","xmlhttp"),An(t,e),t.o&&t.s&&gn(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=Ae(we(e)),n.s=null,n.S=!0,se(n,t)}function Tn(t){null!=t.v&&(a.clearTimeout(t.v),t.v=null)}function _n(t,e){var n=null;if(t.g==e){Tn(t),Nn(t),t.g=null;var i=2}else{if(!Ge(t.i,e))return;n=e.F,qe(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.G;var r=t.C;ft(i=Ut(),new Bt(i,n)),xn(t)}else En(t);else if(3==(r=e.o)||0==r&&0<e.ca||!(1==i&&function(t,e){return!(Be(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.j=e.F.concat(t.j),!0):!(1==t.H||2==t.H||t.C>=(t.cb?0:t.eb))&&(t.m=Gt(m(t.Na,t,e),In(t,t.C)),t.C++,!0))}(t,e)||2==i&&Mn(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:Dn(t,5);break;case 4:Dn(t,10);break;case 3:Dn(t,6);break;default:Dn(t,2)}}function In(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Dn(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=m(t.pb,t);n||(n=new ve("//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||ye(n,"https"),Ae(n)),function(t,e){const n=new Dt;if(a.Image){const i=new Image;i.onload=p(Je,n,i,"TestLoadImage: loaded",!0,e),i.onerror=p(Je,n,i,"TestLoadImage: error",!1,e),i.onabort=p(Je,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=p(Je,n,i,"TestLoadImage: timeout",!1,e),a.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else Vt(2);t.H=0,t.h&&t.h.za(e),On(t),kn(t)}function On(t){if(t.H=0,t.ma=[],t.h){const e=He(t.i);0==e.length&&0==t.j.length||(y(t.ma,e),y(t.ma,t.j),t.i.i.length=0,w(t.j),t.j.length=0),t.h.ya()}}function $n(t,e,n){var i=n instanceof ve?we(n):new ve(n);if(""!=i.g)e&&(i.g=e+"."+i.g),ke(i,i.m);else{var r=a.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var o=new ve(null);i&&ye(o,i),e&&(o.g=e),r&&ke(o,r),n&&(o.l=n),i=o}return n=t.F,e=t.Da,n&&e&&Ce(i,n,e),Ce(i,"VER",t.ra),An(t,i),i}function Pn(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ha&&!t.va?new rn(new We({ob:!0})):new rn(t.va)).Oa(t.J),e}function Un(){}function jn(){if(_&&!(10<=Number(V)))throw Error("Environmental error: no available transport.")}function Fn(t,e){ht.call(this),this.g=new vn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!C(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!C(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Bn(this)}function Ln(t){Xt.call(this),t.rt&&(this.headers=t.rt,this.statusCode=t.ot,delete t.rt,delete t.ot);var e=t.st;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Vn(){Yt.call(this),this.status=1}function Bn(t){this.g=t}function Gn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function zn(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var o=t.g[3],s=e+(o^n&(r^o))+i[0]+3614090360&4294967295;s=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=(n=(r=(o=(e=n+(s<<7&4294967295|s>>>25))+((s=o+(r^e&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(e^r&(o^e))+i[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^n&(r^o))+i[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(r^e&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(e^r&(o^e))+i[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^n&(r^o))+i[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(r^e&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(e^r&(o^e))+i[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^n&(r^o))+i[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(r^e&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(e^r&(o^e))+i[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=e+(r^o&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=r+(e^n&(o^e))+i[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^e&(r^o))+i[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=e+(r^o&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=r+(e^n&(o^e))+i[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^e&(r^o))+i[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=e+(r^o&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=r+(e^n&(o^e))+i[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^e&(r^o))+i[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=e+(r^o&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=r+(e^n&(o^e))+i[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^e&(r^o))+i[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=e+(n^r^o)+i[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^e)+i[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=e+(n^r^o)+i[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^e)+i[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=e+(n^r^o)+i[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^e)+i[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=e+(n^r^o)+i[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^e^n)+i[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^e)+i[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=e+(r^(n|~o))+i[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=r+(e^(o|~n))+i[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=e+(r^(n|~o))+i[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=r+(e^(o|~n))+i[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=e+(r^(n|~o))+i[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=r+(e^(o|~n))+i[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(e=n+((s=e+(r^(n|~o))+i[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((r=o+((s=r+(e^(o|~n))+i[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(s<<21&4294967295|s>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+o&4294967295}function qn(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var o=0|t[r];i&&o==e||(n[r]=o,i=!1)}this.g=n}(i=rn.prototype).Oa=function(t){this.M=t},i.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Jt.g(),this.C=this.u?Kt(this.u):Kt(Jt),this.g.onreadystatechange=m(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void cn(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find(t=>"content-type"==t.toLowerCase()),r=a.FormData&&t instanceof a.FormData,!(0<=v(an,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{fn(this),0<this.B&&((this.L=function(t){return _&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=m(this.ua,this)):this.A=Mt(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){cn(this,t)}},i.ua=function(){void 0!==s&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ft(this,"timeout"),this.abort(8))},i.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ft(this,"complete"),ft(this,"abort"),hn(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),hn(this,!0)),rn.$.N.call(this)},i.La=function(){this.s||(this.G||this.v||this.l?ln(this):this.kb())},i.kb=function(){ln(this)},i.isActive=function(){return!!this.g},i.da=function(){try{return 2<dn(this)?this.g.status:-1}catch(t){return-1}},i.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},i.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),nn(e)}},i.Ia=function(){return this.m},i.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(i=vn.prototype).ra=8,i.H=1,i.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new te(this,this.l,t);let o=this.s;if(this.U&&(o?(o=J(o),X(o,this.U)):o=this.U),null!==this.o||this.O||(r.I=o,o=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.at)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Rn(this,r,e),Ce(n=we(this.I),"RID",t),Ce(n,"CVER",22),this.F&&Ce(n,"X-HTTP-Session-Id",this.F),An(this,n),o&&(this.O?e="headers="+encodeURIComponent(String(pn(o)))+"&"+e:this.o&&gn(n,this.o,o)),ze(this.i,r),this.bb&&Ce(n,"TYPE","init"),this.P?(Ce(n,"$req",e),Ce(n,"SID","null"),r.aa=!0,oe(r,n,null)):oe(r,n,e),this.H=2}}else 3==this.H&&(t?Cn(this,t):0==this.j.length||Ve(this.i)||Cn(this))},i.Ma=function(){if(this.u=null,Sn(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Gt(m(this.jb,this),t)}},i.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Vt(10),yn(this),Sn(this))},i.ib=function(){null!=this.v&&(this.v=null,yn(this),Mn(this),Vt(19))},i.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Vt(2)):(this.l.info("Failed to ping google.com"),Vt(1))},i.isActive=function(){return!!this.h&&this.h.isActive(this)},(i=Un.prototype).Ba=function(){},i.Aa=function(){},i.za=function(){},i.ya=function(){},i.isActive=function(){return!0},i.Va=function(){},jn.prototype.g=function(t,e){return new Fn(t,e)},g(Fn,ht),Fn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Vt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=$n(t,null,t.Y),xn(t)},Fn.prototype.close=function(){wn(this.g)},Fn.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.at=t,t=n}else this.v&&((n={}).at=mt(t),t=n);e.j.push(new class{constructor(t,e){this.g=t,this.map=e}}(e.fb++,t)),3==e.H&&xn(e)},Fn.prototype.N=function(){this.g.h=null,delete this.j,wn(this.g),delete this.g,Fn.$.N.call(this)},g(Ln,Xt),g(Vn,Yt),g(Bn,Un),Bn.prototype.Ba=function(){ft(this.g,"a")},Bn.prototype.Aa=function(t){ft(this.g,new Ln(t))},Bn.prototype.za=function(t){ft(this.g,new Vn)},Bn.prototype.ya=function(){ft(this.g,"b")},g(Gn,(function(){this.blockSize=-1})),Gn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Gn.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,r=this.h,o=0;o<e;){if(0==r)for(;o<=n;)zn(this,t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(i[r++]=t.charCodeAt(o++),r==this.blockSize){zn(this,i),r=0;break}}else for(;o<e;)if(i[r++]=t[o++],r==this.blockSize){zn(this,i),r=0;break}}this.h=r,this.i+=e},Gn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var Hn={};function Kn(t){return-128<=t&&128>t?function(t,e){var n=Hn;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(t){return new qn([0|t],0>t?-1:0)})):new qn([0|t],0>t?-1:0)}function Qn(t){if(isNaN(t)||!isFinite(t))return Wn;if(0>t)return ei(Qn(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=Jn;return new qn(e,0)}var Jn=4294967296,Wn=Kn(0),Xn=Kn(1),Yn=Kn(16777216);function Zn(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function ti(t){return-1==t.h}function ei(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new qn(n,~t.h).add(Xn)}function ni(t,e){return t.add(ei(e))}function ii(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function ri(t,e){this.g=t,this.h=e}function oi(t,e){if(Zn(e))throw Error("division by zero");if(Zn(t))return new ri(Wn,Wn);if(ti(t))return e=oi(ei(t),e),new ri(ei(e.g),ei(e.h));if(ti(e))return e=oi(t,ei(e)),new ri(ei(e.g),e.h);if(30<t.g.length){if(ti(t)||ti(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Xn,i=e;0>=i.X(t);)n=si(n),i=si(i);var r=ai(n,1),o=ai(i,1);for(i=ai(i,2),n=ai(n,2);!Zn(i);){var s=o.add(i);0>=s.X(t)&&(r=r.add(n),o=s),i=ai(i,1),n=ai(n,1)}return e=ni(t,r.R(e)),new ri(r,e)}for(r=Wn;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),s=(o=Qn(n)).R(e);ti(s)||0<s.X(t);)s=(o=Qn(n-=i)).R(e);Zn(o)&&(o=Xn),r=r.add(o),t=ni(t,s)}return new ri(r,t)}function si(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new qn(n,t.h)}function ai(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],o=0;o<i;o++)r[o]=0<e?t.D(o+n)>>>e|t.D(o+n+1)<<32-e:t.D(o+n);return new qn(r,t.h)}(i=qn.prototype).ea=function(){if(ti(this))return-ei(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:Jn+i)*e,e*=Jn}return t},i.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Zn(this))return"0";if(ti(this))return"-"+ei(this).toString(t);for(var e=Qn(Math.pow(t,6)),n=this,i="";;){var r=oi(n,e).g,o=((0<(n=ni(n,r.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Zn(n=r))return o+i;for(;6>o.length;)o="0"+o;i=o+i}},i.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},i.X=function(t){return ti(t=ni(this,t))?-1:Zn(t)?0:1},i.abs=function(){return ti(this)?ei(this):this},i.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var o=i+(65535&this.D(r))+(65535&t.D(r)),s=(o>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);i=s>>>16,o&=65535,s&=65535,n[r]=s<<16|o}return new qn(n,-2147483648&n[n.length-1]?-1:0)},i.R=function(t){if(Zn(this)||Zn(t))return Wn;if(ti(this))return ti(t)?ei(this).R(ei(t)):ei(ei(this).R(t));if(ti(t))return ei(this.R(ei(t)));if(0>this.X(Yn)&&0>t.X(Yn))return Qn(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var o=this.D(i)>>>16,s=65535&this.D(i),a=t.D(r)>>>16,c=65535&t.D(r);n[2*i+2*r]+=s*c,ii(n,2*i+2*r),n[2*i+2*r+1]+=o*c,ii(n,2*i+2*r+1),n[2*i+2*r+1]+=s*a,ii(n,2*i+2*r+1),n[2*i+2*r+2]+=o*a,ii(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new qn(n,0)},i.gb=function(t){return oi(this,t).h},i.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new qn(n,this.h&t.h)},i.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new qn(n,this.h|t.h)},i.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new qn(n,this.h^t.h)},jn.prototype.createWebChannel=jn.prototype.g,Fn.prototype.send=Fn.prototype.u,Fn.prototype.open=Fn.prototype.m,Fn.prototype.close=Fn.prototype.close,zt.NO_ERROR=0,zt.TIMEOUT=8,zt.HTTP_ERROR=6,qt.COMPLETE="complete",Qt.EventType=Wt,Wt.OPEN="a",Wt.CLOSE="b",Wt.ERROR="c",Wt.MESSAGE="d",ht.prototype.listen=ht.prototype.O,rn.prototype.listenOnce=rn.prototype.P,rn.prototype.getLastError=rn.prototype.Sa,rn.prototype.getLastErrorCode=rn.prototype.Ia,rn.prototype.getStatus=rn.prototype.da,rn.prototype.getResponseJson=rn.prototype.Wa,rn.prototype.getResponseText=rn.prototype.ja,rn.prototype.send=rn.prototype.ha,rn.prototype.setWithCredentials=rn.prototype.Oa,Gn.prototype.digest=Gn.prototype.l,Gn.prototype.reset=Gn.prototype.reset,Gn.prototype.update=Gn.prototype.j,qn.prototype.add=qn.prototype.add,qn.prototype.multiply=qn.prototype.R,qn.prototype.modulo=qn.prototype.gb,qn.prototype.compare=qn.prototype.X,qn.prototype.toNumber=qn.prototype.ea,qn.prototype.toString=qn.prototype.toString,qn.prototype.getBits=qn.prototype.D,qn.fromNumber=Qn,qn.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return ei(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=Qn(Math.pow(n,8)),r=Wn,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),a=parseInt(e.substring(o,o+s),n);8>s?(s=Qn(Math.pow(n,s)),r=r.R(s).add(Qn(a))):r=(r=r.R(i)).add(Qn(a))}return r};var ci=o.createWebChannelTransport=function(){return new jn},ui=o.getStatEventTarget=function(){return Ut()},li=o.ErrorCode=zt,hi=o.EventType=qt,fi=o.Event=$t,di=o.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},mi=o.FetchXmlHttpFactory=We,pi=o.WebChannel=Qt,gi=o.XhrIo=rn,bi=o.Md5=Gn,vi=o.Integer=qn}).call(this,n(13))},function(t,e){t.exports=ReactDOM},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return h}));const i=[];var r;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(r||(r={}));const o={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},s=r.INFO,a={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},c=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=a[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class u{constructor(t){this.name=t,this._logLevel=s,this._logHandler=c,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in r))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?o[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...t),this._logHandler(this,r.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...t),this._logHandler(this,r.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,r.INFO,...t),this._logHandler(this,r.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,r.WARN,...t),this._logHandler(this,r.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...t),this._logHandler(this,r.ERROR,...t)}}function l(t){i.forEach(e=>{e.setLogLevel(t)})}function h(t,e){for(const n of i){let i=null;e&&e.level&&(i=o[e.level]),n.userLogHandler=null===t?null:(e,n,...o)=>{const s=o.map(t=>{if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}}).filter(t=>t).join(" ");n>=(null!=i?i:e.logLevel)&&t({level:r[n].toLowerCase(),message:s,args:o,type:e.name})}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return $})),n.d(e,"b",(function(){return T})),n.d(e,"c",(function(){return S})),n.d(e,"d",(function(){return _})),n.d(e,"e",(function(){return U})),n.d(e,"f",(function(){return P})),n.d(e,"g",(function(){return j}));var i=n(7),r=n(5),o=n(1);let s,a;const c=new WeakMap,u=new WeakMap,l=new WeakMap,h=new WeakMap,f=new WeakMap;let d={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return u.get(t);if("objectStoreNames"===e)return t.objectStoreNames||l.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return g(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function m(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(b(this),e),g(c.get(this))}:function(...e){return g(t.apply(b(this),e))}:function(e,...n){const i=t.call(b(this),e,...n);return l.set(i,e.sort?e.sort():[e]),g(i)}}function p(t){return"function"==typeof t?m(t):(t instanceof IDBTransaction&&function(t){if(u.has(t))return;const e=new Promise((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",o),t.removeEventListener("abort",o)},r=()=>{e(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",o),t.addEventListener("abort",o)});u.set(t,e)}(t),e=t,(s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(t,d):t);var e}function g(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",o)},r=()=>{e(g(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",o)});return e.then(e=>{e instanceof IDBCursor&&c.set(e,t)}).catch(()=>{}),f.set(e,t),e}(t);if(h.has(t))return h.get(t);const e=p(t);return e!==t&&(h.set(t,e),f.set(e,t)),e}const b=t=>f.get(t);const v=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],y=new Map;function k(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(y.get(e))return y.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=w.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!v.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,r?"readwrite":"readonly");let s=o.store;return i&&(s=s.index(e.shift())),(await Promise.all([s[n](...e),r&&o.done]))[0]};return y.set(e,o),o}d=(t=>({...t,get:(e,n,i)=>k(e,n)||t.get(e,n,i),has:(e,n)=>!!k(e,n)||t.has(e,n)}))(d);class x{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null}).filter(t=>t).join(" ")}}const C="@firebase/app",A=new r.b("@firebase/app"),R={[C]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},E=new Map,M=new Map;function N(t,e){try{t.container.addComponent(e)}catch(n){A.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function S(t){const e=t.name;if(M.has(e))return A.debug(`There were multiple attempts to register component ${e}.`),!1;M.set(e,t);for(const e of E.values())N(e,t);return!0}function T(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function _(t,e,n="[DEFAULT]"){T(t,e).clearInstance(n)}const I={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},D=new o.b("app","Firebase",I);class O{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.a("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw D.create("app-deleted",{appName:this._name})}}const $="10.6.0";function P(t,e={}){let n=t;if("object"!=typeof e){e={name:e}}const r=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},e),s=r.name;if("string"!=typeof s||!s)throw D.create("bad-app-name",{appName:String(s)});if(n||(n=Object(o.g)()),!n)throw D.create("no-options");const a=E.get(s);if(a){if(Object(o.f)(n,a.options)&&Object(o.f)(r,a.config))return a;throw D.create("duplicate-app",{appName:s})}const c=new i.b(s);for(const t of M.values())c.addComponent(t);const u=new O(n,r,c);return E.set(s,u),u}function U(t="[DEFAULT]"){const e=E.get(t);if(!e&&"[DEFAULT]"===t&&Object(o.g)())return P();if(!e)throw D.create("no-app",{appName:t});return e}function j(t,e,n){var r;let o=null!==(r=R[t])&&void 0!==r?r:t;n&&(o+="-"+n);const s=o.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const t=[`Unable to register library "${o}" with version "${e}":`];return s&&t.push(`library name "${o}" contains illegal characters (whitespace or "/")`),s&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void A.warn(t.join(" "))}S(new i.a(o+"-version",()=>({library:o,version:e}),"VERSION"))}const F="firebase-heartbeat-store";let L=null;function V(){return L||(L=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:o}={}){const s=indexedDB.open(t,e),a=g(s);return i&&s.addEventListener("upgradeneeded",t=>{i(g(s.result),t.oldVersion,t.newVersion,g(s.transaction),t)}),n&&s.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),a.then(t=>{o&&t.addEventListener("close",()=>o()),r&&t.addEventListener("versionchange",t=>r(t.oldVersion,t.newVersion,t))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(F)}}}).catch(t=>{throw D.create("idb-open",{originalErrorMessage:t.message})})),L}async function B(t,e){try{const n=(await V()).transaction(F,"readwrite"),i=n.objectStore(F);await i.put(e,G(t)),await n.done}catch(t){if(t instanceof o.c)A.warn(t.message);else{const e=D.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});A.warn(e.message)}}}function G(t){return`${t.name}!${t.options.appId}`}class z{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new H(e),this._heartbeatsCachePromise=this._storage.read().then(t=>(this._heartbeatsCache=t,t))}async triggerHeartbeat(){var t;const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=q();if(null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==n&&!this._heartbeatsCache.heartbeats.some(t=>t.date===n))return this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=q(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find(t=>t.agent===r.agent);if(t){if(t.dates.push(r.date),K(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),K(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=Object(o.d)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function q(){return(new Date).toISOString().substring(0,10)}class H{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Object(o.k)()&&Object(o.m)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){return await async function(t){try{const e=await V();return await e.transaction(F).objectStore(F).get(G(t))}catch(t){if(t instanceof o.c)A.warn(t.message);else{const e=D.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});A.warn(e.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return B(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return B(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function K(t){return Object(o.d)(JSON.stringify({version:2,heartbeats:t})).length}var Q;Q="",S(new i.a("platform-logger",t=>new x(t),"PRIVATE")),S(new i.a("heartbeat",t=>new z(t),"PRIVATE")),j(C,"0.9.23",Q),j(C,"0.9.23","esm2017"),j("fire-js","")},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return s}));var i=n(1);class r{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new i.a;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(t)&&e.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&t(o,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,"[DEFAULT]"===i?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class s{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},function(t,e,n){var i=n(57);t.exports="string"==typeof i?i:i.toString()},,,function(t,e,n){"use strict";var i=n(2),r=n.n(i)()(!0);r.push([t.i,'.vkijM9js5qD40n7Lxa8Z5Q\\=\\={margin:2em;text-align:center;color:#e33}.FAVDrTTj78xCOQQ0afY-3Q\\=\\={height:calc(100% - 46px);overflow:auto}.wko3KsMuRizugS2G1lpo9g\\=\\={padding-top:1em}.L0iyDASY7iJqc13r5Q-Mzg\\=\\={width:80px;height:80px}.L0iyDASY7iJqc13r5Q-Mzg\\=\\=:after{content:" ";display:block;width:64px;height:64px;margin:8px;border-radius:50%;border:6px solid #8ac;border-color:#8ac transparent #8ac transparent;animation:L0iyDASY7iJqc13r5Q-Mzg\\=\\= 1.2s linear infinite}@keyframes L0iyDASY7iJqc13r5Q-Mzg\\=\\={0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.qdUyv9EVJbNAGAWRZbfH1Q\\=\\={margin-left:.5em;cursor:pointer}',"",{version:3,sources:["webpack://src/components/style.module.scss"],names:[],mappings:"AAAA,4BACE,UAAA,CACA,iBAAA,CACA,UAAA,CAGF,4BACE,wBAAA,CACA,aAAA,CAGF,4BACE,eAAA,CAIF,4BACE,UAAA,CACA,WAAA,CAEF,kCACE,WAAA,CACA,aAAA,CACA,UAAA,CACA,WAAA,CACA,UAAA,CACA,iBAAA,CACA,qBAAA,CACA,8CAAA,CACA,yDAAA,CAEF,sCACE,GACE,sBAAA,CAEF,KACE,wBAAA,CAAA,CAIJ,4BACE,gBAAA,CACA,cAAA",sourcesContent:['.reload-warning {\r\n  margin: 2em;\r\n  text-align: center;\r\n  color: #e33;\r\n}\r\n\r\n.ritsu-menu-container {\r\n  height: calc(100% - 46px);\r\n  overflow: auto;\r\n}\r\n\r\n.settings-section {\r\n  padding-top: 1em;\r\n}\r\n\r\n// spinner thingy\r\n.lds-dual-ring {\r\n  width: 80px;\r\n  height: 80px;\r\n}\r\n.lds-dual-ring:after {\r\n  content: " ";\r\n  display: block;\r\n  width: 64px;\r\n  height: 64px;\r\n  margin: 8px;\r\n  border-radius: 50%;\r\n  border: 6px solid #8ac;\r\n  border-color: #8ac transparent #8ac transparent;\r\n  animation: lds-dual-ring 1.2s linear infinite;\r\n}\r\n@keyframes lds-dual-ring {\r\n  0% {\r\n    transform: rotate(0deg);\r\n  }\r\n  100% {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n.permamute-list {\r\n  margin-left: 0.5em;\r\n  cursor: pointer;\r\n}\r\n'],sourceRoot:""}]),r.locals={reloadWarning:"vkijM9js5qD40n7Lxa8Z5Q==",ritsuMenuContainer:"FAVDrTTj78xCOQQ0afY-3Q==",settingsSection:"wko3KsMuRizugS2G1lpo9g==",ldsDualRing:"L0iyDASY7iJqc13r5Q-Mzg==",permamuteList:"qdUyv9EVJbNAGAWRZbfH1Q=="},e.a=r},function(t,e){var n={utf8:{stringToBytes:function(t){return n.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(n.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}};t.exports=n},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var c,u=[],l=!1,h=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&d())}function d(){if(!l){var t=a(f);l=!0;for(var e=u.length;e;){for(c=u,u=[];++h<e;)c&&c[h].run();h=-1,e=u.length}c=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new m(t,e)),1!==u.length||l||a(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return oo})),n.d(e,"b",(function(){return Ir})),n.d(e,"c",(function(){return $r}));var i=n(6),r=n(7),o=n(5),s=n(1),a=n(3);const c="@firebase/firestore";class u{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}u.UNAUTHENTICATED=new u(null),u.GOOGLE_CREDENTIALS=new u("google-credentials-uid"),u.FIRST_PARTY=new u("first-party-uid"),u.MOCK_USER=new u("mock-user");let l="10.5.2";const h=new o.b("@firebase/firestore");function f(){return h.logLevel}function d(t,...e){if(h.logLevel<=o.a.DEBUG){const n=e.map(g);h.debug(`Firestore (${l}): ${t}`,...n)}}function m(t,...e){if(h.logLevel<=o.a.ERROR){const n=e.map(g);h.error(`Firestore (${l}): ${t}`,...n)}}function p(t,...e){if(h.logLevel<=o.a.WARN){const n=e.map(g);h.warn(`Firestore (${l}): ${t}`,...n)}}function g(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function b(t="Unexpected state"){const e=`FIRESTORE (${l}) INTERNAL ASSERTION FAILED: `+t;throw m(e),new Error(e)}function v(t,e){t||b()}function w(t,e){return t}const y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends s.c{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class x{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class C{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer "+t)}}class A{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(u.UNAUTHENTICATED))}shutdown(){}}class R{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class E{constructor(t){this.t=t,this.currentUser=u.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new x;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new x,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const e=r;t.enqueueRetryable(async()=>{await e.promise,await i(this.currentUser)})},s=t=>{d("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(t=>s(t)),setTimeout(()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?s(t):(d("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new x)}},0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.i!==t?(d("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(v("string"==typeof e.accessToken),new C(e.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return v(null===t||"string"==typeof t),new u(t)}}class M{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=u.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class N{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new M(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(u.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class S{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class T{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&d("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: "+t.error.message);const n=t.token!==this.R;return this.R=t.token,d("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable(()=>n(e))};const i=t=>{d("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit(t=>i(t)),setTimeout(()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):d("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(t=>t?(v("string"==typeof t.token),this.R=t.token,new S(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function _(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class I{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=_(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length))}return n}}function D(t,e){return t<e?-1:t>e?1:0}function O(t,e,n){return t.length===e.length&&t.every((t,i)=>n(t,e[i]))}class ${constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new k(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new k(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new k(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new k(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return $.fromMillis(Date.now())}static fromDate(t){return $.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new $(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?D(this.nanoseconds,t.nanoseconds):D(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class P{constructor(t){this.timestamp=t}static fromTimestamp(t){return new P(t)}static min(){return new P(new $(0,0))}static max(){return new P(new $(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class U{constructor(t,e,n){void 0===e?e=0:e>t.length&&b(),void 0===n?n=t.length-e:n>t.length-e&&b(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===U.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof U?t.forEach(t=>{e.push(t)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class j extends U{construct(t,e,n){return new j(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new k(y.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new j(e)}static emptyPath(){return new j([])}}const F=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class L extends U{construct(t,e,n){return new L(t,e,n)}static isValidIdentifier(t){return F.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),L.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new L(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new k(y.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let o=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new k(y.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new k(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(o=!o,i++):"."!==e||o?(n+=e,i++):(r(),i++)}if(r(),o)throw new k(y.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new L(e)}static emptyPath(){return new L([])}}class V{constructor(t){this.path=t}static fromPath(t){return new V(j.fromString(t))}static fromName(t){return new V(j.fromString(t).popFirst(5))}static empty(){return new V(j.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===j.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return j.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new V(new j(t.slice()))}}class B{constructor(t,e,n,i){this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=i}}B.UNKNOWN_ID=-1;function G(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=P.fromTimestamp(1e9===i?new $(n+1,0):new $(n,i));return new q(r,V.empty(),e)}function z(t){return new q(t.readTime,t.key,-1)}class q{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new q(P.min(),V.empty(),-1)}static max(){return new q(P.max(),V.empty(),-1)}}function H(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=V.comparator(t.documentKey,e.documentKey),0!==n?n:D(t.largestBatchId,e.largestBatchId))}const K="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Q{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}async function J(t){if(t.code!==y.FAILED_PRECONDITION||t.message!==K)throw t;d("LocalStore","Unexpectedly lost primary lease")}class W{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&b(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new W((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof W?e:W.resolve(e)}catch(t){return W.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):W.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):W.reject(e)}static resolve(t){return new W((e,n)=>{e(t)})}static reject(t){return new W((e,n)=>{n(t)})}static waitFor(t){return new W((e,n)=>{let i=0,r=0,o=!1;t.forEach(t=>{++i,t.next(()=>{++r,o&&r===i&&e()},t=>n(t))}),o=!0,r===i&&e()})}static or(t){let e=W.resolve(!1);for(const n of t)e=e.next(t=>t?W.resolve(t):n());return e}static forEach(t,e){const n=[];return t.forEach((t,i)=>{n.push(e.call(this,t,i))}),this.waitFor(n)}static mapArray(t,e){return new W((n,i)=>{const r=t.length,o=new Array(r);let s=0;for(let a=0;a<r;a++){const c=a;e(t[c]).next(t=>{o[c]=t,++s,s===r&&n(o)},t=>i(t))}})}static doWhile(t,e){return new W((n,i)=>{const r=()=>{!0===t()?e().next(()=>{r()},i):n()};r()})}}function X(t){return"IndexedDbTransactionError"===t.name}class Y{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function Z(t){return null==t}function tt(t){return 0===t&&1/t==-1/0}function et(t){return"number"==typeof t&&Number.isInteger(t)&&!tt(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}Y._e=-1;const nt=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],it=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],rt=it;function ot(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function st(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function at(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class ct{constructor(t,e){this.comparator=t,this.root=e||lt.EMPTY}insert(t,e){return new ct(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,lt.BLACK,null,null))}remove(t){return new ct(this.comparator,this.root.remove(t,this.comparator).copy(null,null,lt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.inorderTraversal((e,n)=>(t.push(`${e}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ut(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ut(this.root,t,this.comparator,!1)}getReverseIterator(){return new ut(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ut(this.root,t,this.comparator,!0)}}class ut{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class lt{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:lt.RED,this.left=null!=i?i:lt.EMPTY,this.right=null!=r?r:lt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new lt(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return lt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return lt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,lt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,lt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw b();if(this.right.isRed())throw b();const t=this.left.check();if(t!==this.right.check())throw b();return t+(this.isRed()?0:1)}}lt.EMPTY=null,lt.RED=!0,lt.BLACK=!1,lt.EMPTY=new class{constructor(){this.size=0}get key(){throw b()}get value(){throw b()}get color(){throw b()}get left(){throw b()}get right(){throw b()}copy(t,e,n,i,r){return this}insert(t,e,n){return new lt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ht{constructor(t){this.comparator=t,this.data=new ct(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,n)=>(t(e),!1))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new ft(this.data.getIterator())}getIteratorFrom(t){return new ft(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(t=>{e=e.add(t)}),e}isEqual(t){if(!(t instanceof ht))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new ht(this.comparator);return e.data=t,e}}class ft{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class dt{constructor(t){this.fields=t,t.sort(L.comparator)}static empty(){return new dt([])}unionWith(t){let e=new ht(L.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new dt(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return O(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class mt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class pt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new mt("Invalid base64 string: "+t):t}}(t);return new pt(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new pt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return D(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}pt.EMPTY_BYTE_STRING=new pt("");const gt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bt(t){if(v(!!t),"string"==typeof t){let e=0;const n=gt.exec(t);if(v(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:vt(t.seconds),nanos:vt(t.nanos)}}function vt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function wt(t){return"string"==typeof t?pt.fromBase64String(t):pt.fromUint8Array(t)}function yt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).ct)||void 0===n?void 0:n.stringValue)}function kt(t){const e=t.mapValue.fields.pt;return yt(e)?kt(e):e}function xt(t){const e=bt(t.mapValue.fields.bt.timestampValue);return new $(e.seconds,e.nanos)}class Ct{constructor(t,e,n,i,r,o,s,a,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=a,this.useFetchStreams=c}}class At{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new At("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof At&&t.projectId===this.projectId&&t.database===this.database}}const Rt={mapValue:{fields:{ct:{stringValue:"__max__"}}}};function Et(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yt(t)?4:Pt(t)?9007199254740991:10:b()}function Mt(t,e){if(t===e)return!0;const n=Et(t);if(n!==Et(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return xt(t).isEqual(xt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=bt(t.timestampValue),i=bt(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return wt(t.bytesValue).isEqual(wt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return vt(t.geoPointValue.latitude)===vt(e.geoPointValue.latitude)&&vt(t.geoPointValue.longitude)===vt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return vt(t.integerValue)===vt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=vt(t.doubleValue),i=vt(e.doubleValue);return n===i?tt(n)===tt(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return O(t.arrayValue.values||[],e.arrayValue.values||[],Mt);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(ot(n)!==ot(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Mt(n[t],i[t])))return!1;return!0}(t,e);default:return b()}}function Nt(t,e){return void 0!==(t.values||[]).find(t=>Mt(t,e))}function St(t,e){if(t===e)return 0;const n=Et(t),i=Et(e);if(n!==i)return D(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return D(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=vt(t.integerValue||t.doubleValue),i=vt(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Tt(t.timestampValue,e.timestampValue);case 4:return Tt(xt(t),xt(e));case 5:return D(t.stringValue,e.stringValue);case 6:return function(t,e){const n=wt(t),i=wt(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=D(n[t],i[t]);if(0!==e)return e}return D(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=D(vt(t.latitude),vt(e.latitude));return 0!==n?n:D(vt(t.longitude),vt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=St(n[t],i[t]);if(e)return e}return D(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===Rt.mapValue&&e===Rt.mapValue)return 0;if(t===Rt.mapValue)return 1;if(e===Rt.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(let t=0;t<i.length&&t<o.length;++t){const e=D(i[t],o[t]);if(0!==e)return e;const s=St(n[i[t]],r[o[t]]);if(0!==s)return s}return D(i.length,o.length)}(t.mapValue,e.mapValue);default:throw b()}}function Tt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return D(t,e);const n=bt(t),i=bt(e),r=D(n.seconds,i.seconds);return 0!==r?r:D(n.nanos,i.nanos)}function _t(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){const e=bt(t);return`time(${e.seconds},${e.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(t){return wt(t).toBase64()}(e.bytesValue):"referenceValue"in e?function(t){return V.fromName(t).toString()}(e.referenceValue):"geoPointValue"in e?function(t){return`geo(${t.latitude},${t.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let n="[",i=!0;for(const r of e.values||[])i?i=!1:n+=",",n+=t(r);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){const n=Object.keys(e.fields||{}).sort();let i="{",r=!0;for(const o of n)r?r=!1:i+=",",i+=`${o}:${t(e.fields[o])}`;return i+"}"}(e.mapValue):b()}(t)}function It(t){return!!t&&"integerValue"in t}function Dt(t){return!!t&&"arrayValue"in t}function Ot(t){return!!t&&"mapValue"in t}function $t(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return st(t.mapValue.fields,(t,n)=>e.mapValue.fields[t]=$t(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=$t(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Pt(t){return"__max__"===(((t.mapValue||{}).fields||{}).ct||{}).stringValue}class Ut{constructor(t){this.value=t}static empty(){return new Ut({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Ot(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=$t(e)}setAll(t){let e=L.emptyPath(),n={},i=[];t.forEach((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=$t(t):i.push(r.lastSegment())});const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Ot(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Mt(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Ot(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){st(e,(e,n)=>t[e]=n);for(const e of n)delete t[e]}clone(){return new Ut($t(this.value))}}function jt(t){const e=[];return st(t.fields,(t,n)=>{const i=new L([t]);if(Ot(n)){const t=jt(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)}),new dt(e)}class Ft{constructor(t,e,n,i,r,o,s){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=o,this.documentState=s}static newInvalidDocument(t){return new Ft(t,0,P.min(),P.min(),P.min(),Ut.empty(),0)}static newFoundDocument(t,e,n,i){return new Ft(t,1,e,P.min(),n,i,0)}static newNoDocument(t,e){return new Ft(t,2,e,P.min(),P.min(),Ut.empty(),0)}static newUnknownDocument(t,e){return new Ft(t,3,e,P.min(),P.min(),Ut.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(P.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=P.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Ft&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ft(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Lt{constructor(t,e){this.position=t,this.inclusive=e}}function Vt(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const o=e[r],s=t.position[r];if(i=o.field.isKeyField()?V.comparator(V.fromName(s.referenceValue),n.key):St(s,n.data.field(o.field)),"desc"===o.dir&&(i*=-1),0!==i)break}return i}function Bt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mt(t.position[n],e.position[n]))return!1;return!0}class Gt{constructor(t,e="asc"){this.field=t,this.dir=e}}function zt(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class qt{}class Ht extends qt{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Zt(t,e,n):"array-contains"===e?new ie(t,n):"in"===e?new re(t,n):"not-in"===e?new oe(t,n):"array-contains-any"===e?new se(t,n):new Ht(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new te(t,n):new ee(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(St(e,this.value)):null!==e&&Et(this.value)===Et(e)&&this.matchesComparison(St(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return b()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Kt extends qt{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new Kt(t,e)}matches(t){return Qt(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Qt(t){return"and"===t.op}function Jt(t){return Wt(t)&&Qt(t)}function Wt(t){for(const e of t.filters)if(e instanceof Kt)return!1;return!0}function Xt(t,e){return t instanceof Ht?function(t,e){return e instanceof Ht&&t.op===e.op&&t.field.isEqual(e.field)&&Mt(t.value,e.value)}(t,e):t instanceof Kt?function(t,e){return e instanceof Kt&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce((t,n,i)=>t&&Xt(n,e.filters[i]),!0)}(t,e):void b()}function Yt(t){return t instanceof Ht?function(t){return`${t.field.canonicalString()} ${t.op} ${_t(t.value)}`}(t):t instanceof Kt?function(t){return t.op.toString()+" {"+t.getFilters().map(Yt).join(" ,")+"}"}(t):"Filter"}class Zt extends Ht{constructor(t,e,n){super(t,e,n),this.key=V.fromName(n.referenceValue)}matches(t){const e=V.comparator(t.key,this.key);return this.matchesComparison(e)}}class te extends Ht{constructor(t,e){super(t,"in",e),this.keys=ne("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class ee extends Ht{constructor(t,e){super(t,"not-in",e),this.keys=ne("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function ne(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>V.fromName(t.referenceValue))}class ie extends Ht{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Dt(e)&&Nt(e.arrayValue,this.value)}}class re extends Ht{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Nt(this.value.arrayValue,e)}}class oe extends Ht{constructor(t,e){super(t,"not-in",e)}matches(t){if(Nt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Nt(this.value.arrayValue,e)}}class se extends Ht{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Dt(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>Nt(this.value.arrayValue,t))}}class ae{constructor(t,e=null,n=[],i=[],r=null,o=null,s=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.ce=null}}function ce(t,e=null,n=[],i=[],r=null,o=null,s=null){return new ae(t,e,n,i,r,o,s)}function ue(t){const e=w(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(t=>function t(e){if(e instanceof Ht)return e.field.canonicalString()+e.op.toString()+_t(e.value);if(Jt(e))return e.filters.map(e=>t(e)).join(",");{const n=e.filters.map(e=>t(e)).join(",");return`${e.op}(${n})`}}(t)).join(","),t+="|ob:",t+=e.orderBy.map(t=>function(t){return t.field.canonicalString()+t.dir}(t)).join(","),Z(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(t=>_t(t)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(t=>_t(t)).join(",")),e.ce=t}return e.ce}function le(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!zt(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Xt(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bt(t.startAt,e.startAt)&&Bt(t.endAt,e.endAt)}class he{constructor(t,e=null,n=[],i=[],r=null,o="F",s=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=o,this.startAt=s,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function fe(t,e,n,i,r,o,s,a){return new he(t,e,n,i,r,o,s,a)}function de(t){return new he(t)}function me(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function pe(t){return null!==t.collectionGroup}function ge(t){const e=w(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(t){let e=new ht(L.comparator);return t.filters.forEach(t=>{t.getFlattenedFilters().forEach(t=>{t.isInequality()&&(e=e.add(t.field))})}),e})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.le.push(new Gt(i,n))}),t.has(L.keyField().canonicalString())||e.le.push(new Gt(L.keyField(),n))}return e.le}function be(t){const e=w(t);return e.he||(e.he=ve(e,ge(t))),e.he}function ve(t,e){if("F"===t.limitType)return ce(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(t=>{const e="desc"===t.dir?"asc":"desc";return new Gt(t.field,e)});const n=t.endAt?new Lt(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Lt(t.startAt.position,t.startAt.inclusive):null;return ce(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function we(t,e,n){return new he(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ye(t,e){return le(be(t),be(e))&&t.limitType===e.limitType}function ke(t){return`${ue(be(t))}|lt:${t.limitType}`}function xe(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(t=>Yt(t)).join(", ")}]`),Z(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(t=>_t(t)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(t=>_t(t)).join(",")),`Target(${e})`}(be(t))}; limitType=${t.limitType})`}function Ce(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):V.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of ge(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Vt(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,ge(t),e))&&!(t.endAt&&!function(t,e,n){const i=Vt(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,ge(t),e))}(t,e)}function Ae(t){return(e,n)=>{let i=!1;for(const r of ge(t)){const t=Re(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function Re(t,e,n){const i=t.field.isKeyField()?V.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?St(i,r):b()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return b()}}class Ee{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){st(this.inner,(e,n)=>{for(const[e,i]of n)t(e,i)})}isEmpty(){return at(this.inner)}size(){return this.innerSize}}const Me=new ct(V.comparator);function Ne(){return Me}const Se=new ct(V.comparator);function Te(...t){let e=Se;for(const n of t)e=e.insert(n.key,n);return e}function _e(t){let e=Se;return t.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Ie(){return Oe()}function De(){return Oe()}function Oe(){return new Ee(t=>t.toString(),(t,e)=>t.isEqual(e))}const $e=new ct(V.comparator),Pe=new ht(V.comparator);function Ue(...t){let e=Pe;for(const n of t)e=e.add(n);return e}const je=new ht(D);function Fe(){return je}function Le(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tt(e)?"-0":e}}function Ve(t){return{integerValue:""+t}}function Be(t,e){return et(e)?Ve(e):Le(t,e)}class Ge{constructor(){this.vt=void 0}}function ze(t,e,n){return t instanceof Ke?function(t,e){const n={fields:{ct:{stringValue:"server_timestamp"},bt:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&yt(e)&&(e=kt(e)),e&&(n.fields.pt=e),{mapValue:n}}(n,e):t instanceof Qe?Je(t,e):t instanceof We?Xe(t,e):function(t,e){const n=He(t,e),i=Ze(n)+Ze(t.Ie);return It(n)&&It(t.Ie)?Ve(i):Le(t.serializer,i)}(t,e)}function qe(t,e,n){return t instanceof Qe?Je(t,e):t instanceof We?Xe(t,e):n}function He(t,e){return t instanceof Ye?function(t){return It(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Ke extends Ge{}class Qe extends Ge{constructor(t){super(),this.elements=t}}function Je(t,e){const n=tn(e);for(const e of t.elements)n.some(t=>Mt(t,e))||n.push(e);return{arrayValue:{values:n}}}class We extends Ge{constructor(t){super(),this.elements=t}}function Xe(t,e){let n=tn(e);for(const e of t.elements)n=n.filter(t=>!Mt(t,e));return{arrayValue:{values:n}}}class Ye extends Ge{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Ze(t){return vt(t.integerValue||t.doubleValue)}function tn(t){return Dt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class en{constructor(t,e){this.version=t,this.transformResults=e}}class nn{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new nn}static exists(t){return new nn(void 0,t)}static updateTime(t){return new nn(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function rn(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class on{}function sn(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new gn(t.key,nn.none()):new hn(t.key,t.data,nn.none());{const n=t.data,i=Ut.empty();let r=new ht(L.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new fn(t.key,i,new dt(r.toArray()),nn.none())}}function an(t,e,n){t instanceof hn?function(t,e,n){const i=t.value.clone(),r=mn(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof fn?function(t,e,n){if(!rn(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=mn(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(dn(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function cn(t,e,n,i){return t instanceof hn?function(t,e,n,i){if(!rn(t.precondition,e))return n;const r=t.value.clone(),o=pn(t.fieldTransforms,i,e);return r.setAll(o),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof fn?function(t,e,n,i){if(!rn(t.precondition,e))return n;const r=pn(t.fieldTransforms,i,e),o=e.data;return o.setAll(dn(t)),o.setAll(r),e.convertToFoundDocument(e.version,o).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map(t=>t.field))}(t,e,n,i):function(t,e,n){return rn(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function un(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=He(i.transform,t||null);null!=r&&(null===n&&(n=Ut.empty()),n.set(i.field,r))}return n||null}function ln(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&O(t,e,(t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Qe&&e instanceof Qe||t instanceof We&&e instanceof We?O(t.elements,e.elements,Mt):t instanceof Ye&&e instanceof Ye?Mt(t.Ie,e.Ie):t instanceof Ke&&e instanceof Ke}(t.transform,e.transform)}(t,e))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class hn extends on{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class fn extends on{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function dn(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}}),e}function mn(t,e,n){const i=new Map;v(t.length===n.length);for(let r=0;r<n.length;r++){const o=t[r],s=o.transform,a=e.data.field(o.field);i.set(o.field,qe(s,a,n[r]))}return i}function pn(t,e,n){const i=new Map;for(const r of t){const t=r.transform,o=n.data.field(r.field);i.set(r.field,ze(t,o,e))}return i}class gn extends on{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bn extends on{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class vn{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&an(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=cn(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=cn(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=De();return this.mutations.forEach(i=>{const r=t.get(i.key),o=r.overlayedDocument;let s=this.applyToLocalView(o,r.mutatedFields);s=e.has(i.key)?null:s;const a=sn(o,s);null!==a&&n.set(i.key,a),o.isValidDocument()||o.convertToNoDocument(P.min())}),n}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Ue())}isEqual(t){return this.batchId===t.batchId&&O(this.mutations,t.mutations,(t,e)=>ln(t,e))&&O(this.baseMutations,t.baseMutations,(t,e)=>ln(t,e))}}class wn{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){v(t.mutations.length===n.length);let i=$e;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new wn(t,e,n,i)}}class yn{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var kn,xn;function Cn(t){switch(t){default:return b();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function An(t){if(void 0===t)return m("GRPC error has no .code"),y.UNKNOWN;switch(t){case kn.OK:return y.OK;case kn.CANCELLED:return y.CANCELLED;case kn.UNKNOWN:return y.UNKNOWN;case kn.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case kn.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case kn.INTERNAL:return y.INTERNAL;case kn.UNAVAILABLE:return y.UNAVAILABLE;case kn.UNAUTHENTICATED:return y.UNAUTHENTICATED;case kn.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case kn.NOT_FOUND:return y.NOT_FOUND;case kn.ALREADY_EXISTS:return y.ALREADY_EXISTS;case kn.PERMISSION_DENIED:return y.PERMISSION_DENIED;case kn.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case kn.ABORTED:return y.ABORTED;case kn.OUT_OF_RANGE:return y.OUT_OF_RANGE;case kn.UNIMPLEMENTED:return y.UNIMPLEMENTED;case kn.DATA_LOSS:return y.DATA_LOSS;default:return b()}}(xn=kn||(kn={}))[xn.OK=0]="OK",xn[xn.CANCELLED=1]="CANCELLED",xn[xn.UNKNOWN=2]="UNKNOWN",xn[xn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xn[xn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xn[xn.NOT_FOUND=5]="NOT_FOUND",xn[xn.ALREADY_EXISTS=6]="ALREADY_EXISTS",xn[xn.PERMISSION_DENIED=7]="PERMISSION_DENIED",xn[xn.UNAUTHENTICATED=16]="UNAUTHENTICATED",xn[xn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xn[xn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xn[xn.ABORTED=10]="ABORTED",xn[xn.OUT_OF_RANGE=11]="OUT_OF_RANGE",xn[xn.UNIMPLEMENTED=12]="UNIMPLEMENTED",xn[xn.INTERNAL=13]="INTERNAL",xn[xn.UNAVAILABLE=14]="UNAVAILABLE",xn[xn.DATA_LOSS=15]="DATA_LOSS";new a.e([4294967295,4294967295],0);Error;class Rn{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function En(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mn(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Nn(t,e){return En(t,e.toTimestamp())}function Sn(t){return v(!!t),P.fromTimestamp(function(t){const e=bt(t);return new $(e.seconds,e.nanos)}(t))}function Tn(t,e){return function(t){return new j(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function _n(t){const e=j.fromString(t);return v(Vn(e)),e}function In(t,e){return Tn(t.databaseId,e.path)}function Dn(t){const e=_n(t);return 4===e.length?j.emptyPath():$n(e)}function On(t){return new j(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $n(t){return v(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Pn(t,e,n){return{name:In(t,e),fields:n.value.mapValue.fields}}function Un(t,e){let n;if(e instanceof hn)n={update:Pn(t,e.key,e.value)};else if(e instanceof gn)n={delete:In(t,e.key)};else if(e instanceof fn)n={update:Pn(t,e.key,e.data),updateMask:Ln(e.fieldMask)};else{if(!(e instanceof bn))return b();n={verify:In(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(t=>function(t,e){const n=e.transform;if(n instanceof Ke)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Qe)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof We)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ye)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw b()}(0,t))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Nn(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:b()}(t,e.precondition)),n}function jn(t){let e=Dn(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){v(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let o=[];n.where&&(o=function(t){const e=function t(e){return void 0!==e.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Fn(t.unaryFilter.field);return Ht.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Fn(t.unaryFilter.field);return Ht.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Fn(t.unaryFilter.field);return Ht.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Fn(t.unaryFilter.field);return Ht.create(r,"!=",{nullValue:"NULL_VALUE"});default:return b()}}(e):void 0!==e.fieldFilter?function(t){return Ht.create(Fn(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return b()}}(t.fieldFilter.op),t.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Kt.create(e.compositeFilter.filters.map(e=>t(e)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return b()}}(e.compositeFilter.op))}(e):b()}(t);return e instanceof Kt&&Jt(e)?e.getFilters():[e]}(n.where));let s=[];n.orderBy&&(s=function(t){return t.map(t=>function(t){return new Gt(Fn(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Z(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new Lt(n,e)}(n.startAt));let u=null;return n.endAt&&(u=function(t){const e=!t.before,n=t.values||[];return new Lt(n,e)}(n.endAt)),fe(e,r,s,o,a,"F",c,u)}function Fn(t){return L.fromServerFormat(t.fieldPath)}function Ln(t){const e=[];return t.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Vn(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Bn{constructor(t){this.ut=t}}function Gn(t){const e=jn({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?we(e,e.limit,"L"):e}class zn{constructor(){}ht(t,e){this.Pt(t,e),e.It()}Pt(t,e){if("nullValue"in t)this.Tt(e,5);else if("booleanValue"in t)this.Tt(e,10),e.Et(t.booleanValue?1:0);else if("integerValue"in t)this.Tt(e,15),e.Et(vt(t.integerValue));else if("doubleValue"in t){const n=vt(t.doubleValue);isNaN(n)?this.Tt(e,13):(this.Tt(e,15),tt(n)?e.Et(0):e.Et(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Tt(e,20),"string"==typeof n?e.dt(n):(e.dt(""+(n.seconds||"")),e.Et(n.nanos||0))}else if("stringValue"in t)this.At(t.stringValue,e),this.Rt(e);else if("bytesValue"in t)this.Tt(e,30),e.Vt(wt(t.bytesValue)),this.Rt(e);else if("referenceValue"in t)this.ft(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Tt(e,45),e.Et(n.latitude||0),e.Et(n.longitude||0)}else"mapValue"in t?Pt(t)?this.Tt(e,Number.MAX_SAFE_INTEGER):(this.gt(t.mapValue,e),this.Rt(e)):"arrayValue"in t?(this.yt(t.arrayValue,e),this.Rt(e)):b()}At(t,e){this.Tt(e,25),this.wt(t,e)}wt(t,e){e.dt(t)}gt(t,e){const n=t.fields||{};this.Tt(e,55);for(const t of Object.keys(n))this.At(t,e),this.Pt(n[t],e)}yt(t,e){const n=t.values||[];this.Tt(e,50);for(const t of n)this.Pt(t,e)}ft(t,e){this.Tt(e,37),V.fromName(t).path.forEach(t=>{this.Tt(e,60),this.wt(t,e)})}Tt(t,e){t.Et(e)}Rt(t){t.Et(2)}}zn.St=new zn;class qn{constructor(){this.on=new Hn}addToCollectionParentIndex(t,e){return this.on.add(e),W.resolve()}getCollectionParents(t,e){return W.resolve(this.on.getEntries(e))}addFieldIndex(t,e){return W.resolve()}deleteFieldIndex(t,e){return W.resolve()}deleteAllFieldIndexes(t){return W.resolve()}createTargetIndexes(t,e){return W.resolve()}getDocumentsMatchingTarget(t,e){return W.resolve(null)}getIndexType(t,e){return W.resolve(0)}getFieldIndexes(t,e){return W.resolve([])}getNextCollectionGroupToUpdate(t){return W.resolve(null)}getMinOffset(t,e){return W.resolve(q.min())}getMinOffsetFromCollectionGroup(t,e){return W.resolve(q.min())}updateCollectionGroup(t,e,n){return W.resolve()}updateIndexEntries(t,e){return W.resolve()}}class Hn{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new ht(j.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new ht(j.comparator)).toArray()}}new Uint8Array(0);class Kn{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Kn(t,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Kn.DEFAULT_COLLECTION_PERCENTILE=10,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kn.DEFAULT=new Kn(41943040,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kn.DISABLED=new Kn(-1,0,0);class Qn{constructor(t){this.xn=t}next(){return this.xn+=2,this.xn}static On(){return new Qn(0)}static Nn(){return new Qn(-1)}}class Jn{constructor(){this.changes=new Ee(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ft.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?W.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Wn{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Xn{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next(i=>(n=i,this.remoteDocumentCache.getEntry(t,e))).next(t=>(null!==n&&cn(n.mutation,t,dt.empty(),$.now()),t))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.getLocalViewOfDocuments(t,e,Ue()).next(()=>e))}getLocalViewOfDocuments(t,e,n=Ue()){const i=Ie();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,n).next(t=>{let e=Te();return t.forEach((t,n)=>{e=e.insert(t,n.overlayedDocument)}),e}))}getOverlayedDocuments(t,e){const n=Ie();return this.populateOverlays(t,n,e).next(()=>this.computeViews(t,e,n,Ue()))}populateOverlays(t,e,n){const i=[];return n.forEach(t=>{e.has(t)||i.push(t)}),this.documentOverlayCache.getOverlays(t,i).next(t=>{t.forEach((t,n)=>{e.set(t,n)})})}computeViews(t,e,n,i){let r=Ne();const o=Oe(),s=Oe();return e.forEach((t,e)=>{const s=n.get(e.key);i.has(e.key)&&(void 0===s||s.mutation instanceof fn)?r=r.insert(e.key,e):void 0!==s?(o.set(e.key,s.mutation.getFieldMask()),cn(s.mutation,e,s.mutation.getFieldMask(),$.now())):o.set(e.key,dt.empty())}),this.recalculateAndSaveOverlays(t,r).next(t=>(t.forEach((t,e)=>o.set(t,e)),e.forEach((t,e)=>{var n;return s.set(t,new Wn(e,null!==(n=o.get(t))&&void 0!==n?n:null))}),s))}recalculateAndSaveOverlays(t,e){const n=Oe();let i=new ct((t,e)=>t-e),r=Ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(t=>{for(const r of t)r.keys().forEach(t=>{const o=e.get(t);if(null===o)return;let s=n.get(t)||dt.empty();s=r.applyToLocalView(o,s),n.set(t,s);const a=(i.get(r.batchId)||Ue()).add(t);i=i.insert(r.batchId,a)})}).next(()=>{const o=[],s=i.getReverseIterator();for(;s.hasNext();){const i=s.getNext(),a=i.key,c=i.value,u=De();c.forEach(t=>{if(!r.has(t)){const i=sn(e.get(t),n.get(t));null!==i&&u.set(t,i),r=r.add(t)}}),o.push(this.documentOverlayCache.saveOverlays(t,a,u))}return W.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.recalculateAndSaveOverlays(t,e))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return V.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):pe(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next(r=>{const o=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):W.resolve(Ie());let s=-1,a=r;return o.next(e=>W.forEach(e,(e,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),r.get(e)?W.resolve():this.remoteDocumentCache.getEntry(t,e).next(t=>{a=a.insert(e,t)}))).next(()=>this.populateOverlays(t,e,r)).next(()=>this.computeViews(t,a,e,Ue())).next(t=>({batchId:s,changes:_e(t)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new V(e)).next(t=>{let e=Te();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const r=e.collectionGroup;let o=Te();return this.indexManager.getCollectionParents(t,r).next(s=>W.forEach(s,s=>{const a=function(t,e){return new he(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(r));return this.getDocumentsMatchingCollectionQuery(t,a,n,i).next(t=>{t.forEach((t,e)=>{o=o.insert(t,e)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,e,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,r,i))).next(t=>{r.forEach((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,Ft.newInvalidDocument(i)))});let n=Te();return t.forEach((t,i)=>{const o=r.get(t);void 0!==o&&cn(o.mutation,i,dt.empty(),$.now()),Ce(e,i)&&(n=n.insert(t,i))}),n})}}class Yn{constructor(t){this.serializer=t,this.ur=new Map,this.cr=new Map}getBundleMetadata(t,e){return W.resolve(this.ur.get(e))}saveBundleMetadata(t,e){return this.ur.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Sn(t.createTime)}}(e)),W.resolve()}getNamedQuery(t,e){return W.resolve(this.cr.get(e))}saveNamedQuery(t,e){return this.cr.set(e.name,function(t){return{name:t.name,query:Gn(t.bundledQuery),readTime:Sn(t.readTime)}}(e)),W.resolve()}}class Zn{constructor(){this.overlays=new ct(V.comparator),this.lr=new Map}getOverlay(t,e){return W.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Ie();return W.forEach(e,e=>this.getOverlay(t,e).next(t=>{null!==t&&n.set(e,t)})).next(()=>n)}saveOverlays(t,e,n){return n.forEach((n,i)=>{this.lt(t,e,i)}),W.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.lr.get(n);return void 0!==i&&(i.forEach(t=>this.overlays=this.overlays.remove(t)),this.lr.delete(n)),W.resolve()}getOverlaysForCollection(t,e,n){const i=Ie(),r=e.length+1,o=new V(e.child("")),s=this.overlays.getIteratorFrom(o);for(;s.hasNext();){const t=s.getNext().value,o=t.getKey();if(!e.isPrefixOf(o.path))break;o.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return W.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new ct((t,e)=>t-e);const o=this.overlays.getIterator();for(;o.hasNext();){const t=o.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=Ie(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const s=Ie(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((t,e)=>s.set(t,e)),!(s.size()>=i)););return W.resolve(s)}lt(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.lr.get(i.largestBatchId).delete(n.key);this.lr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new yn(e,n));let r=this.lr.get(e);void 0===r&&(r=Ue(),this.lr.set(e,r)),this.lr.set(e,r.add(n.key))}}class ti{constructor(){this.hr=new ht(ei.Pr),this.Ir=new ht(ei.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(t,e){const n=new ei(t,e);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}Er(t,e){t.forEach(t=>this.addReference(t,e))}removeReference(t,e){this.dr(new ei(t,e))}Ar(t,e){t.forEach(t=>this.removeReference(t,e))}Rr(t){const e=new V(new j([])),n=new ei(e,t),i=new ei(e,t+1),r=[];return this.Ir.forEachInRange([n,i],t=>{this.dr(t),r.push(t.key)}),r}Vr(){this.hr.forEach(t=>this.dr(t))}dr(t){this.hr=this.hr.delete(t),this.Ir=this.Ir.delete(t)}mr(t){const e=new V(new j([])),n=new ei(e,t),i=new ei(e,t+1);let r=Ue();return this.Ir.forEachInRange([n,i],t=>{r=r.add(t.key)}),r}containsKey(t){const e=new ei(t,0),n=this.hr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class ei{constructor(t,e){this.key=t,this.gr=e}static Pr(t,e){return V.comparator(t.key,e.key)||D(t.gr,e.gr)}static Tr(t,e){return D(t.gr,e.gr)||V.comparator(t.key,e.key)}}class ni{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.pr=1,this.yr=new ht(ei.Pr)}checkEmpty(t){return W.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new vn(r,e,n,i);this.mutationQueue.push(o);for(const e of i)this.yr=this.yr.add(new ei(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return W.resolve(o)}lookupMutationBatch(t,e){return W.resolve(this.wr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.Sr(n),r=i<0?0:i;return W.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(t){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new ei(e,0),i=new ei(e,Number.POSITIVE_INFINITY),r=[];return this.yr.forEachInRange([n,i],t=>{const e=this.wr(t.gr);r.push(e)}),W.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new ht(D);return e.forEach(t=>{const e=new ei(t,0),i=new ei(t,Number.POSITIVE_INFINITY);this.yr.forEachInRange([e,i],t=>{n=n.add(t.gr)})}),W.resolve(this.br(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;V.isDocumentKey(r)||(r=r.child(""));const o=new ei(new V(r),0);let s=new ht(D);return this.yr.forEachWhile(t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(s=s.add(t.gr)),!0)},o),W.resolve(this.br(s))}br(t){const e=[];return t.forEach(t=>{const n=this.wr(t);null!==n&&e.push(n)}),e}removeMutationBatch(t,e){v(0===this.Dr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.yr;return W.forEach(e.mutations,i=>{const r=new ei(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.yr=n})}Fn(t){}containsKey(t,e){const n=new ei(e,0),i=this.yr.firstAfterOrEqual(n);return W.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,W.resolve()}Dr(t,e){return this.Sr(t)}Sr(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}wr(t){const e=this.Sr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class ii{constructor(t){this.Cr=t,this.docs=new ct(V.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,o=this.Cr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return W.resolve(n?n.document.mutableCopy():Ft.newInvalidDocument(e))}getEntries(t,e){let n=Ne();return e.forEach(t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Ft.newInvalidDocument(t))}),W.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let r=Ne();const o=e.path,s=new V(o.child("")),a=this.docs.getIteratorFrom(s);for(;a.hasNext();){const{key:t,value:{document:s}}=a.getNext();if(!o.isPrefixOf(t.path))break;t.path.length>o.length+1||H(z(s),n)<=0||(i.has(s.key)||Ce(e,s))&&(r=r.insert(s.key,s.mutableCopy()))}return W.resolve(r)}getAllFromCollectionGroup(t,e,n,i){b()}vr(t,e){return W.forEach(this.docs,t=>e(t))}newChangeBuffer(t){return new ri(this)}getSize(t){return W.resolve(this.size)}}class ri extends Jn{constructor(t){super(),this._r=t}applyChanges(t){const e=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?e.push(this._r.addEntry(t,i)):this._r.removeEntry(n)}),W.waitFor(e)}getFromCache(t,e){return this._r.getEntry(t,e)}getAllFromCache(t,e){return this._r.getEntries(t,e)}}class oi{constructor(t){this.persistence=t,this.Fr=new Ee(t=>ue(t),le),this.lastRemoteSnapshotVersion=P.min(),this.highestTargetId=0,this.Mr=0,this.Or=new ti,this.targetCount=0,this.Nr=Qn.On()}forEachTarget(t,e){return this.Fr.forEach((t,n)=>e(n)),W.resolve()}getLastRemoteSnapshotVersion(t){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return W.resolve(this.Mr)}allocateTargetId(t){return this.highestTargetId=this.Nr.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Mr&&(this.Mr=e),W.resolve()}kn(t){this.Fr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Nr=new Qn(e),this.highestTargetId=e),t.sequenceNumber>this.Mr&&(this.Mr=t.sequenceNumber)}addTargetData(t,e){return this.kn(e),this.targetCount+=1,W.resolve()}updateTargetData(t,e){return this.kn(e),W.resolve()}removeTargetData(t,e){return this.Fr.delete(e.target),this.Or.Rr(e.targetId),this.targetCount-=1,W.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Fr.forEach((o,s)=>{s.sequenceNumber<=e&&null===n.get(s.targetId)&&(this.Fr.delete(o),r.push(this.removeMatchingKeysForTargetId(t,s.targetId)),i++)}),W.waitFor(r).next(()=>i)}getTargetCount(t){return W.resolve(this.targetCount)}getTargetData(t,e){const n=this.Fr.get(e)||null;return W.resolve(n)}addMatchingKeys(t,e,n){return this.Or.Er(e,n),W.resolve()}removeMatchingKeys(t,e,n){this.Or.Ar(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach(e=>{r.push(i.markPotentiallyOrphaned(t,e))}),W.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Or.Rr(e),W.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Or.mr(e);return W.resolve(n)}containsKey(t,e){return W.resolve(this.Or.containsKey(e))}}class si{constructor(t,e){this.Br={},this.overlays={},this.Lr=new Y(0),this.kr=!1,this.kr=!0,this.referenceDelegate=t(this),this.qr=new oi(this),this.indexManager=new qn,this.remoteDocumentCache=function(t){return new ii(t)}(t=>this.referenceDelegate.Qr(t)),this.serializer=new Bn(e),this.Kr=new Yn(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Zn,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Br[t.toKey()];return n||(n=new ni(e,this.referenceDelegate),this.Br[t.toKey()]=n),n}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(t,e,n){d("MemoryPersistence","Starting transaction:",t);const i=new ai(this.Lr.next());return this.referenceDelegate.$r(),n(i).next(t=>this.referenceDelegate.Ur(i).next(()=>t)).toPromise().then(t=>(i.raiseOnCommittedEvent(),t))}Wr(t,e){return W.or(Object.values(this.Br).map(n=>()=>n.containsKey(t,e)))}}class ai extends Q{constructor(t){super(),this.currentSequenceNumber=t}}class ci{constructor(t){this.persistence=t,this.Gr=new ti,this.zr=null}static jr(t){return new ci(t)}get Hr(){if(this.zr)return this.zr;throw b()}addReference(t,e,n){return this.Gr.addReference(n,e),this.Hr.delete(n.toString()),W.resolve()}removeReference(t,e,n){return this.Gr.removeReference(n,e),this.Hr.add(n.toString()),W.resolve()}markPotentiallyOrphaned(t,e){return this.Hr.add(e.toString()),W.resolve()}removeTarget(t,e){this.Gr.Rr(e.targetId).forEach(t=>this.Hr.add(t.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next(t=>{t.forEach(t=>this.Hr.add(t.toString()))}).next(()=>n.removeTargetData(t,e))}$r(){this.zr=new Set}Ur(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.Hr,n=>{const i=V.fromPath(n);return this.Jr(t,i).next(t=>{t||e.removeEntry(i,P.min())})}).next(()=>(this.zr=null,e.apply(t)))}updateLimboDocument(t,e){return this.Jr(t,e).next(t=>{t?this.Hr.delete(e.toString()):this.Hr.add(e.toString())})}Qr(t){return 0}Jr(t,e){return W.or([()=>W.resolve(this.Gr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Wr(t,e)])}}class ui{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.ki=n,this.qi=i}static Qi(t,e){let n=Ue(),i=Ue();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new ui(t,e.fromCache,n,i)}}class li{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class hi{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(t,e){this.Gi=t,this.indexManager=e,this.Ki=!0}getDocumentsMatchingQuery(t,e,n,i){const r={result:null};return this.zi(t,e).next(t=>{r.result=t}).next(()=>{if(!r.result)return this.ji(t,e,i,n).next(t=>{r.result=t})}).next(()=>{if(r.result)return;const n=new li;return this.Hi(t,e,n).next(i=>{if(r.result=i,this.$i)return this.Ji(t,e,n,i.size)})}).next(()=>r.result)}Ji(t,e,n,i){return n.documentReadCount<this.Ui?(f()<=o.a.DEBUG&&d("QueryEngine","SDK will not create cache indexes for query:",xe(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),W.resolve()):(f()<=o.a.DEBUG&&d("QueryEngine","Query:",xe(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Wi*i?(f()<=o.a.DEBUG&&d("QueryEngine","The SDK decides to create cache indexes for query:",xe(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,be(e))):W.resolve())}zi(t,e){if(me(e))return W.resolve(null);let n=be(e);return this.indexManager.getIndexType(t,n).next(i=>0===i?null:(null!==e.limit&&1===i&&(e=we(e,null,"F"),n=be(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next(i=>{const r=Ue(...i);return this.Gi.getDocuments(t,r).next(i=>this.indexManager.getMinOffset(t,n).next(n=>{const o=this.Yi(e,i);return this.Zi(e,o,r,n.readTime)?this.zi(t,we(e,null,"F")):this.Xi(t,o,e,n)}))})))}ji(t,e,n,i){return me(e)||i.isEqual(P.min())?W.resolve(null):this.Gi.getDocuments(t,n).next(r=>{const s=this.Yi(e,r);return this.Zi(e,s,n,i)?W.resolve(null):(f()<=o.a.DEBUG&&d("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xe(e)),this.Xi(t,s,e,G(i,-1)).next(t=>t))})}Yi(t,e){let n=new ht(Ae(t));return e.forEach((e,i)=>{Ce(t,i)&&(n=n.add(i))}),n}Zi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Hi(t,e,n){return f()<=o.a.DEBUG&&d("QueryEngine","Using full collection scan to execute query:",xe(e)),this.Gi.getDocumentsMatchingQuery(t,e,q.min(),n)}Xi(t,e,n,i){return this.Gi.getDocumentsMatchingQuery(t,n,i).next(t=>(e.forEach(e=>{t=t.insert(e.key,e)}),t))}}class fi{constructor(t,e,n,i){this.persistence=t,this.es=e,this.serializer=i,this.ts=new ct(D),this.ns=new Ee(t=>ue(t),le),this.rs=new Map,this.ss=t.getRemoteDocumentCache(),this.qr=t.getTargetCache(),this.Kr=t.getBundleCache(),this.os(n)}os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Xn(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.ts))}}function di(t,e,n,i){return new fi(t,e,n,i)}async function mi(t,e){const n=w(t);return await n.persistence.runTransaction("Handle user change","readonly",t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next(r=>(i=r,n.os(e),n.mutationQueue.getAllMutationBatches(t))).next(e=>{const r=[],o=[];let s=Ue();for(const t of i){r.push(t.batchId);for(const e of t.mutations)s=s.add(e.key)}for(const t of e){o.push(t.batchId);for(const e of t.mutations)s=s.add(e.key)}return n.localDocuments.getDocuments(t,s).next(t=>({_s:t,removedBatchIds:r,addedBatchIds:o}))})})}function pi(t){const e=w(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function gi(t,e){const n=w(t);return n.persistence.runTransaction("Get next mutation batch","readonly",t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e)))}class bi{constructor(){this.activeTargetIds=Fe()}ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}As(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Es(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class vi{constructor(){this.eo=new bi,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.eo.ds(t),this.no[t]||"not-current"}updateQueryState(t,e,n){this.no[t]=e}removeLocalQueryTarget(t){this.eo.As(t)}isLocalQueryTarget(t){return this.eo.activeTargetIds.has(t)}clearQueryState(t){delete this.no[t]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(t){return this.eo.activeTargetIds.has(t)}start(){return this.eo=new bi,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class wi{ro(t){}shutdown(){}}class yi{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(t){this.ao.push(t)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){d("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ao)t(0)}_o(){d("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ao)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ki=null;function xi(){return null===ki?ki=268435456+Math.round(2147483648*Math.random()):ki++,"0x"+ki.toString(16)}const Ci={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ai{constructor(t){this.co=t.co,this.lo=t.lo}ho(t){this.Po=t}Io(t){this.To=t}onMessage(t){this.Eo=t}close(){this.lo()}send(t){this.co(t)}Ao(){this.Po()}Ro(t){this.To(t)}Vo(t){this.Eo(t)}}const Ri="WebChannelConnection";class Ei extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.mo=e+"://"+t.host,this.fo=`projects/${n}/databases/${i}`,this.po="(default)"===this.databaseId.database?"project_id="+n:`project_id=${n}&database_id=${i}`}get yo(){return!1}wo(t,e,n,i,r){const o=xi(),s=this.So(t,e);d("RestConnection",`Sending RPC '${t}' ${o}:`,s,n);const a={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(a,i,r),this.Do(t,s,a,n).then(e=>(d("RestConnection",`Received RPC '${t}' ${o}: `,e),e),e=>{throw p("RestConnection",`RPC '${t}' ${o} failed with error: `,e,"url: ",s,"request:",n),e})}Co(t,e,n,i,r,o){return this.wo(t,e,n,i,r)}bo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+l,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((e,n)=>t[n]=e),n&&n.headers.forEach((e,n)=>t[n]=e)}So(t,e){const n=Ci[t];return`${this.mo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Do(t,e,n,i){const r=xi();return new Promise((o,s)=>{const c=new a.i;c.setWithCredentials(!0),c.listenOnce(a.c.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case a.a.NO_ERROR:const e=c.getResponseJson();d(Ri,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(e)),o(e);break;case a.a.TIMEOUT:d(Ri,`RPC '${t}' ${r} timed out`),s(new k(y.DEADLINE_EXCEEDED,"Request time out"));break;case a.a.HTTP_ERROR:const n=c.getStatus();if(d(Ri,`RPC '${t}' ${r} failed with status:`,n,"response text:",c.getResponseText()),n>0){let t=c.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(e)>=0?e:y.UNKNOWN}(e.status);s(new k(t,e.message))}else s(new k(y.UNKNOWN,"Server responded with status "+c.getStatus()))}else s(new k(y.UNAVAILABLE,"Connection failed."));break;default:b()}}finally{d(Ri,`RPC '${t}' ${r} completed.`)}});const u=JSON.stringify(i);d(Ri,`RPC '${t}' ${r} sending request:`,i),c.send(e,"POST",u,n,15)})}vo(t,e,n){const i=xi(),r=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Object(a.j)(),s=Object(a.k)(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new a.d({})),this.bo(c.initMessageHeaders,e,n),c.encodeInitMessageHeaders=!0;const l=r.join("");d(Ri,`Creating RPC '${t}' stream ${i}: ${l}`,c);const h=o.createWebChannel(l,c);let f=!1,m=!1;const g=new Ai({co:e=>{m?d(Ri,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(f||(d(Ri,`Opening RPC '${t}' stream ${i} transport.`),h.open(),f=!0),d(Ri,`RPC '${t}' stream ${i} sending:`,e),h.send(e))},lo:()=>h.close()}),b=(t,e,n)=>{t.listen(e,t=>{try{n(t)}catch(t){setTimeout(()=>{throw t},0)}})};return b(h,a.h.EventType.OPEN,()=>{m||d(Ri,`RPC '${t}' stream ${i} transport opened.`)}),b(h,a.h.EventType.CLOSE,()=>{m||(m=!0,d(Ri,`RPC '${t}' stream ${i} transport closed`),g.Ro())}),b(h,a.h.EventType.ERROR,e=>{m||(m=!0,p(Ri,`RPC '${t}' stream ${i} transport errored:`,e),g.Ro(new k(y.UNAVAILABLE,"The operation could not be completed")))}),b(h,a.h.EventType.MESSAGE,e=>{var n;if(!m){const r=e.data[0];v(!!r);const o=r,s=o.error||(null===(n=o[0])||void 0===n?void 0:n.error);if(s){d(Ri,`RPC '${t}' stream ${i} received error:`,s);const e=s.status;let n=function(t){const e=kn[t];if(void 0!==e)return An(e)}(e),r=s.message;void 0===n&&(n=y.INTERNAL,r="Unknown error status: "+e+" with message "+s.message),m=!0,g.Ro(new k(n,r)),h.close()}else d(Ri,`RPC '${t}' stream ${i} received:`,r),g.Vo(r)}}),b(s,a.b.STAT_EVENT,e=>{e.stat===a.g.PROXY?d(Ri,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===a.g.NOPROXY&&d(Ri,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.Ao()},0),g}}function Mi(){return"undefined"!=typeof document?document:null}function Ni(t){return new Rn(t,!0)}class Si{constructor(t,e,n=1e3,i=1.5,r=6e4){this.si=t,this.timerId=e,this.Fo=n,this.Mo=i,this.xo=r,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(t){this.cancel();const e=Math.floor(this.Oo+this.qo()),n=Math.max(0,Date.now()-this.Bo),i=Math.max(0,e-n);i>0&&d("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),t())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class Ti{constructor(t,e,n,i,r,o,s,a){this.si=t,this.Ko=n,this.$o=i,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=a,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Si(t,e)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}kt(t){this.xt(),this.stream.send(t)}async Xo(){if(this.Ho())return this.close(0)}xt(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}Ct(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(t,e){this.xt(),this.Ct(),this.zo.cancel(),this.Uo++,4!==t?this.zo.reset():e&&e.code===y.RESOURCE_EXHAUSTED?(m(e.toString()),m("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):e&&e.code===y.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Mt(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Io(e)}Mt(){}auth(){this.state=1;const t=this.Nt(this.Uo),e=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([t,n])=>{this.Uo===e&&this._t(t,n)},e=>{t(()=>{const t=new k(y.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Dt(t)})})}_t(t,e){const n=this.Nt(this.Uo);this.stream=this.Ot(t,e),this.stream.ho(()=>{n(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(t=>{n(()=>this.Dt(t))}),this.stream.onMessage(t=>{n(()=>this.onMessage(t))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}Dt(t){return d("PersistentStream","close with error: "+t),this.stream=null,this.close(4,t)}Nt(t){return e=>{this.si.enqueueAndForget(()=>this.Uo===t?e():(d("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _i extends Ti{constructor(t,e,n,i,r,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,o),this.serializer=r,this.$t=!1}get Ut(){return this.$t}start(){this.$t=!1,this.lastStreamToken=void 0,super.start()}Mt(){this.$t&&this.jt([])}Ot(t,e){return this.connection.vo("Write",t,e)}onMessage(t){if(v(!!t.streamToken),this.lastStreamToken=t.streamToken,this.$t){this.zo.reset();const e=function(t,e){return t&&t.length>0?(v(void 0!==e),t.map(t=>function(t,e){let n=t.updateTime?Sn(t.updateTime):Sn(e);return n.isEqual(P.min())&&(n=Sn(e)),new en(n,t.transformResults||[])}(t,e))):[]}(t.writeResults,t.commitTime),n=Sn(t.commitTime);return this.listener.Ft(n,e)}return v(!t.writeResults||0===t.writeResults.length),this.$t=!0,this.listener.Lt()}Bt(){const t={};t.database=On(this.serializer),this.kt(t)}jt(t){const e={streamToken:this.lastStreamToken,writes:t.map(t=>Un(this.serializer,t))};this.kt(e)}}class Ii extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.Gt=!1}zt(){if(this.Gt)throw new k(y.FAILED_PRECONDITION,"The client has already been terminated.")}wo(t,e,n){return this.zt(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,r])=>this.connection.wo(t,e,n,i,r)).catch(t=>{throw"FirebaseError"===t.name?(t.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new k(y.UNKNOWN,t.toString())})}Co(t,e,n,i){return this.zt(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.Co(t,e,n,r,o,i)).catch(t=>{throw"FirebaseError"===t.name?(t.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new k(y.UNKNOWN,t.toString())})}terminate(){this.Gt=!0}}class Di{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.qt=0,this.Ht=null,this.Kt=!0}Qt(){0===this.qt&&(this.Jt("Unknown"),this.Ht=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.Ht=null,this.Wt("Backend didn't respond within 10 seconds."),this.Jt("Offline"),Promise.resolve())))}Xt(t){"Online"===this.state?this.Jt("Unknown"):(this.qt++,this.qt>=1&&(this.Yt(),this.Wt("Connection failed 1 times. Most recent error: "+t.toString()),this.Jt("Offline")))}set(t){this.Yt(),this.qt=0,"Online"===t&&(this.Kt=!1),this.Jt(t)}Jt(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}Wt(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Kt?(m(e),this.Kt=!1):d("OnlineStateTracker",e)}Yt(){null!==this.Ht&&(this.Ht.cancel(),this.Ht=null)}}class Oi{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Zt=[],this.te=new Map,this.ee=new Set,this.ne=[],this.ie=r,this.ie.ro(t=>{n.enqueueAndForget(async()=>{Ui(this)&&(d("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=w(t);e.ee.add(4),await Pi(e),e.re.set("Unknown"),e.ee.delete(4),await $i(e)}(this))})}),this.re=new Di(n,i)}}async function $i(t){if(Ui(t))for(const e of t.ne)await e(!0)}async function Pi(t){for(const e of t.ne)await e(!1)}function Ui(t){return 0===w(t).ee.size}async function ji(t,e,n){if(!X(e))throw e;t.ee.add(1),await Pi(t),t.re.set("Offline"),n||(n=()=>pi(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{d("RemoteStore","Retrying IndexedDB access"),await n(),t.ee.delete(1),await $i(t)})}function Fi(t,e){return e().catch(n=>ji(t,n,e))}async function Li(t){const e=w(t),n=Xi(e);let i=e.Zt.length>0?e.Zt[e.Zt.length-1].batchId:-1;for(;Vi(e);)try{const t=await gi(e.localStore,i);if(null===t){0===e.Zt.length&&n.Zo();break}i=t.batchId,Bi(e,t)}catch(t){await ji(e,t)}Gi(e)&&zi(e)}function Vi(t){return Ui(t)&&t.Zt.length<10}function Bi(t,e){t.Zt.push(e);const n=Xi(t);n.Ho()&&n.Ut&&n.jt(e.mutations)}function Gi(t){return Ui(t)&&!Xi(t).jo()&&t.Zt.length>0}function zi(t){Xi(t).start()}async function qi(t){Xi(t).Bt()}async function Hi(t){const e=Xi(t);for(const n of t.Zt)e.jt(n.mutations)}async function Ki(t,e,n){const i=t.Zt.shift(),r=wn.from(i,e,n);await Fi(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await Li(t)}async function Qi(t,e){e&&Xi(t).Ut&&await async function(t,e){if(function(t){return Cn(t)&&t!==y.ABORTED}(e.code)){const n=t.Zt.shift();Xi(t).Yo(),await Fi(t,()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e)),await Li(t)}}(t,e),Gi(t)&&zi(t)}async function Ji(t,e){const n=w(t);n.asyncQueue.verifyOperationInProgress(),d("RemoteStore","RemoteStore received new credentials");const i=Ui(n);n.ee.add(3),await Pi(n),i&&n.re.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.ee.delete(3),await $i(n)}async function Wi(t,e){const n=w(t);e?(n.ee.delete(2),await $i(n)):e||(n.ee.add(2),await Pi(n),n.re.set("Unknown"))}function Xi(t){return t.ae||(t.ae=function(t,e,n){const i=w(t);return i.zt(),new _i(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{ho:qi.bind(null,t),Io:Qi.bind(null,t),Lt:Hi.bind(null,t),Ft:Ki.bind(null,t)}),t.ne.push(async e=>{e?(t.ae.Yo(),await Li(t)):(await t.ae.stop(),t.Zt.length>0&&(d("RemoteStore",`Stopping write stream with ${t.Zt.length} pending writes`),t.Zt=[]))})),t.ae}class Yi{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new x,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(t=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,r){const o=Date.now()+n,s=new Yi(t,e,o,i,r);return s.start(n),s}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new k(y.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Zi(t,e){if(m("AsyncQueue",`${e}: ${t}`),X(t))return new k(y.UNAVAILABLE,`${e}: ${t}`);throw t}class tr{constructor(){this.queries=new Ee(t=>ke(t),ye),this.onlineState="Unknown",this.fe=new Set}}function er(t){t.fe.forEach(t=>{t.next()})}class nr{constructor(t,e,n,i,r,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Ee(t=>ke(t),ye),this.fa=new Map,this.ga=new Set,this.pa=new ct(V.comparator),this.ya=new Map,this.wa=new ti,this.Sa={},this.ba=new Map,this.Da=Qn.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function ir(t,e,n){const i=w(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ma.forEach((n,i)=>{const r=i.view.de(e);r.snapshot&&t.push(r.snapshot)}),function(t,e){const n=w(t);n.onlineState=e;let i=!1;n.queries.forEach((t,n)=>{for(const t of n.listeners)t.de(e)&&(i=!0)}),i&&er(n)}(i.eventManager,e),t.length&&i.Va.me(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function rr(t,e){const n=w(t),i=e.batch.batchId;try{const t=await function(t,e){const n=w(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",t=>{const i=e.batch.keys(),r=n.ss.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,o=r.keys();let s=W.resolve();return o.forEach(t=>{s=s.next(()=>i.getEntry(e,t)).next(e=>{const o=n.docVersions.get(t);v(null!==o),e.version.compareTo(o)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))})}),s.next(()=>t.mutationQueue.removeMutationBatch(e,r))}(n,t,e,r).next(()=>r.apply(t)).next(()=>n.mutationQueue.performConsistencyCheck(t)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=Ue();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e))).next(()=>n.localDocuments.getDocuments(t,i))})}(n.localStore,e);ar(n,i,null),sr(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await cr(n,t)}catch(t){await J(t)}}async function or(t,e,n){const i=w(t);try{const t=await function(t,e){const n=w(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next(e=>(v(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e))).next(()=>n.mutationQueue.performConsistencyCheck(t)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i)).next(()=>n.localDocuments.getDocuments(t,i))})}(i.localStore,e);ar(i,e,n),sr(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await cr(i,t)}catch(n){await J(n)}}function sr(t,e){(t.ba.get(e)||[]).forEach(t=>{t.resolve()}),t.ba.delete(e)}function ar(t,e,n){const i=w(t);let r=i.Sa[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.Sa[i.currentUser.toKey()]=r}}async function cr(t,e,n){const i=w(t),r=[],o=[],s=[];i.ma.isEmpty()||(i.ma.forEach((t,a)=>{s.push(i.va(a,e,n).then(t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=ui.Qi(a.targetId,t);o.push(e)}}))}),await Promise.all(s),i.Va.me(r),await async function(t,e){const n=w(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",t=>W.forEach(e,e=>W.forEach(e.ki,i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i)).next(()=>W.forEach(e.qi,i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))}catch(t){if(!X(t))throw t;d("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ts.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.ts=n.ts.insert(e,r)}}}(i.localStore,o))}async function ur(t,e){const n=w(t);if(!n.currentUser.isEqual(e)){d("SyncEngine","User change. New user:",e.toKey());const t=await mi(n.localStore,e);n.currentUser=e,function(t,e){t.ba.forEach(t=>{t.forEach(t=>{t.reject(new k(y.CANCELLED,e))})}),t.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await cr(n,t._s)}}function lr(t){const e=w(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rr.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=or.bind(null,e),e}class hr{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Ni(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return di(this.persistence,new hi,t.initialUser,this.serializer)}createPersistence(t){return new si(ci.jr,this.serializer)}createSharedClientState(t){return new vi}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class fr{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>ir(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=ur.bind(null,this.syncEngine),await Wi(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new tr}createDatastore(t){const e=Ni(t.databaseInfo.databaseId),n=function(t){return new Ei(t)}(t.databaseInfo);return function(t,e,n,i){return new Ii(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,r){return new Oi(t,e,n,i,r)}(this.localStore,this.datastore,t.asyncQueue,t=>ir(this.syncEngine,t,0),yi.D()?new yi:new wi)}createSyncEngine(t,e){return function(t,e,n,i,r,o,s){const a=new nr(t,e,n,i,r,o);return s&&(a.Ca=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=w(t);d("RemoteStore","RemoteStore shutting down."),e.ee.add(5),await Pi(e),e.ie.shutdown(),e.re.set("Unknown")}(this.remoteStore)}}class dr{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=u.UNAUTHENTICATED,this.clientId=I.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async t=>{d("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t}),this.appCheckCredentials.start(n,t=>(d("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new x;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Zi(e,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function mr(t,e){t.asyncQueue.verifyOperationInProgress(),d("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener(async t=>{i.isEqual(t)||(await mi(e.localStore,t),i=t)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function pr(t,e){t.asyncQueue.verifyOperationInProgress();const n=await br(t);d("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener(t=>Ji(e.remoteStore,t)),t.setAppCheckTokenChangeListener((t,n)=>Ji(e.remoteStore,n)),t._onlineComponents=e}function gr(t){return"FirebaseError"===t.name?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}async function br(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){d("FirestoreClient","Using user provided OfflineComponentProvider");try{await mr(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!gr(n))throw n;p("Error using user provided cache. Falling back to memory cache: "+n),await mr(t,new hr)}}else d("FirestoreClient","Using default OfflineComponentProvider"),await mr(t,new hr);return t._offlineComponents}async function vr(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(d("FirestoreClient","Using user provided OnlineComponentProvider"),await pr(t,t._uninitializedComponentsProvider._online)):(d("FirestoreClient","Using default OnlineComponentProvider"),await pr(t,new fr))),t._onlineComponents}function wr(t){return vr(t).then(t=>t.syncEngine)}function yr(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const kr=new Map;function xr(t,e,n){if(!n)throw new k(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Cr(t){if(!V.isDocumentKey(t))throw new k(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ar(t){if(V.isDocumentKey(t))throw new k(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Rr(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":b()}function Er(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new k(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Rr(t);throw new k(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Mr{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new k(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new k(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new k(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yr(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new k(y.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new k(y.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new k(y.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Nr{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mr({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new k(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new k(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mr(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new A;switch(t.type){case"firstParty":return new N(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new k(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=kr.get(t);e&&(d("ComponentProvider","Removing Datastore"),kr.delete(t),e.terminate())}(this),Promise.resolve()}}class Sr{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Sr(this.firestore,t,this._query)}}class Tr{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _r(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Tr(this.firestore,t,this._key)}}class _r extends Sr{constructor(t,e,n){super(t,e,de(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Tr(this.firestore,null,new V(t))}withConverter(t){return new _r(this.firestore,t,this._path)}}function Ir(t,e,...n){if(t=Object(s.i)(t),xr("collection","path",e),t instanceof Nr){const i=j.fromString(e,...n);return Ar(i),new _r(t,null,i)}{if(!(t instanceof Tr||t instanceof _r))throw new k(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(j.fromString(e,...n));return Ar(i),new _r(t.firestore,null,i)}}class Dr{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Si(this,"async_queue_retry"),this.iu=()=>{const t=Mi();t&&d("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const t=Mi();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.su(),this.ou(t)}enterRestrictedMode(t){if(!this.Za){this.Za=!0,this.nu=t||!1;const e=Mi();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.iu)}}enqueue(t){if(this.su(),this.Za)return new Promise(()=>{});const e=new x;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ya.push(t),this._u()))}async _u(){if(0!==this.Ya.length){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(t){if(!X(t))throw t;d("AsyncQueue","Operation failed with retryable error: "+t)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(t){const e=this.Ja.then(()=>(this.tu=!0,t().catch(t=>{this.eu=t,this.tu=!1;throw m("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.tu=!1,t))));return this.Ja=e,e}enqueueAfterDelay(t,e,n){this.su(),this.ru.indexOf(t)>-1&&(e=0);const i=Yi.createAndSchedule(this,t,e,n,t=>this.au(t));return this.Xa.push(i),i}su(){this.eu&&b()}verifyOperationInProgress(){}async uu(){let t;do{t=this.Ja,await t}while(t!==this.Ja)}cu(t){for(const e of this.Xa)if(e.timerId===t)return!0;return!1}lu(t){return this.uu().then(()=>{this.Xa.sort((t,e)=>t.targetTimeMs-e.targetTimeMs);for(const e of this.Xa)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.uu()})}hu(t){this.ru.push(t)}au(t){const e=this.Xa.indexOf(t);this.Xa.splice(e,1)}}class Or extends Nr{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Dr,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Ur(this),this._firestoreClient.terminate()}}function $r(t,e){const n="object"==typeof t?t:Object(i.e)(),r="string"==typeof t?t:e||"(default)",o=Object(i.b)(n,"firestore").getImmediate({identifier:r});if(!o._initialized){const t=Object(s.h)("firestore");t&&function(t,e,n,i={}){var r;const o=(t=Er(t,Nr))._getSettings(),a=`${e}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==a&&p("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=u.MOCK_USER;else{e=Object(s.e)(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new k(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new u(o)}t._authCredentials=new R(new C(e,n))}}(o,...t)}return o}function Pr(t){return t._firestoreClient||Ur(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Ur(t){var e,n,i;const r=t._freezeSettings(),o=function(t,e,n,i){return new Ct(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,yr(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new dr(t._authCredentials,t._appCheckCredentials,t._queue,o),(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}class jr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new jr(pt.fromBase64String(t))}catch(t){throw new k(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new jr(pt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Fr{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new k(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new L(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Lr{constructor(t){this._methodName=t}}class Vr{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new k(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new k(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return D(this._lat,t._lat)||D(this._long,t._long)}}const Br=/^__.*__$/;class Gr{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new fn(t,this.data,this.fieldMask,e,this.fieldTransforms):new hn(t,this.data,e,this.fieldTransforms)}}function zr(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw b()}}class qr{constructor(t,e,n,i,r,o){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Pu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(t){return new qr(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Tu({path:n,du:!1});return i.Au(t),i}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Tu({path:n,du:!1});return i.Pu(),i}Vu(t){return this.Tu({path:void 0,du:!0})}mu(t){return no(t,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}Pu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Au(this.path.get(t))}Au(t){if(0===t.length)throw this.mu("Document fields must not be empty");if(zr(this.Iu)&&Br.test(t))throw this.mu('Document fields cannot begin and end with "__"')}}class Hr{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ni(t)}pu(t,e,n,i=!1){return new qr({Iu:t,methodName:e,gu:n,path:L.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Kr(t){const e=t._freezeSettings(),n=Ni(t._databaseId);return new Hr(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Qr(t,e,n,i,r,o={}){const s=t.pu(o.merge||o.mergeFields?2:0,e,n,r);Yr("Data must be an object, but it was:",s,i);const a=Wr(i,s);let c,u;if(o.merge)c=new dt(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){const t=[];for(const i of o.mergeFields){const r=Zr(e,i,n);if(!s.contains(r))throw new k(y.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);io(t,r)||t.push(r)}c=new dt(t),u=s.fieldTransforms.filter(t=>c.covers(t.field))}else c=null,u=s.fieldTransforms;return new Gr(new Ut(a),c,u)}function Jr(t,e){if(Xr(t=Object(s.i)(t)))return Yr("Unsupported field value:",e,t),Wr(t,e);if(t instanceof Lr)return function(t,e){if(!zr(e.Iu))throw e.mu(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.mu(t._methodName+"() is not currently supported inside arrays");const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=Jr(r,e.Vu(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(s.i)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Be(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=$.fromDate(t);return{timestampValue:En(e.serializer,n)}}if(t instanceof $){const n=new $(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:En(e.serializer,n)}}if(t instanceof Vr)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof jr)return{bytesValue:Mn(e.serializer,t._byteString)};if(t instanceof Tr){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.mu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Tn(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.mu("Unsupported field value: "+Rr(t))}(t,e)}function Wr(t,e){const n={};return at(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):st(t,(t,i)=>{const r=Jr(i,e.Eu(t));null!=r&&(n[t]=r)}),{mapValue:{fields:n}}}function Xr(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $||t instanceof Vr||t instanceof jr||t instanceof Tr||t instanceof Lr)}function Yr(t,e,n){if(!Xr(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Rr(n);throw"an object"===i?e.mu(t+" a custom object"):e.mu(t+" "+i)}}function Zr(t,e,n){if((e=Object(s.i)(e))instanceof Fr)return e._internalPath;if("string"==typeof e)return eo(t,e);throw no("Field path arguments must be of type string or ",t,!1,void 0,n)}const to=new RegExp("[~\\*/\\[\\]]");function eo(t,e,n){if(e.search(to)>=0)throw no(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Fr(...e.split("."))._internalPath}catch(i){throw no(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function no(t,e,n,i,r){const o=i&&!i.isEmpty(),s=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=" in field "+i),s&&(c+=" in document "+r),c+=")"),new k(y.INVALID_ARGUMENT,a+t+c)}function io(t,e){return t.some(t=>t.isEqual(e))}function ro(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}function oo(t,e){const n=Er(t.firestore,Or),i=function(t,e,...n){if(t=Object(s.i)(t),1===arguments.length&&(e=I.newId()),xr("doc","path",e),t instanceof Nr){const i=j.fromString(e,...n);return Cr(i),new Tr(t,null,new V(i))}{if(!(t instanceof Tr||t instanceof _r))throw new k(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(j.fromString(e,...n));return Cr(i),new Tr(t.firestore,t instanceof _r?t.converter:null,new V(i))}}(t),r=ro(t.converter,e);return so(n,[Qr(Kr(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,nn.exists(!1))]).then(()=>i)}function so(t,e){return function(t,e){const n=new x;return t.asyncQueue.enqueueAndForget(async()=>async function(t,e,n){const i=lr(t);try{const t=await function(t,e){const n=w(t),i=$.now(),r=e.reduce((t,e)=>t.add(e.key),Ue());let o,s;return n.persistence.runTransaction("Locally write mutations","readwrite",t=>{let a=Ne(),c=Ue();return n.ss.getEntries(t,r).next(t=>{a=t,a.forEach((t,e)=>{e.isValidDocument()||(c=c.add(t))})}).next(()=>n.localDocuments.getOverlayedDocuments(t,a)).next(r=>{o=r;const s=[];for(const t of e){const e=un(t,o.get(t.key).overlayedDocument);null!=e&&s.push(new fn(t.key,e,jt(e.value.mapValue),nn.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,s,e)}).next(e=>{s=e;const i=e.applyToLocalDocumentSet(o,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)})}).then(()=>({batchId:s.batchId,changes:_e(o)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Sa[t.currentUser.toKey()];i||(i=new ct(D)),i=i.insert(e,n),t.Sa[t.currentUser.toKey()]=i}(i,t.batchId,n),await cr(i,t.changes),await Li(i.remoteStore)}catch(t){const e=Zi(t,"Failed to persist write");n.reject(e)}}(await wr(t),e,n)),n.promise}(Pr(t),e)}new WeakMap;!function(t,e=!0){!function(t){l=t}(i.a),Object(i.c)(new r.a("firestore",(t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),o=new Or(new E(t.getProvider("auth-internal")),new T(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new k(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new At(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Object(i.g)(c,"4.3.2",t),Object(i.g)(c,"4.3.2","esm2017")}()}).call(this,n(14))},function(t,e,n){var i,r,o,s,a;i=n(46),r=n(12).utf8,o=n(47),s=n(12).bin,(a=function(t,e){t.constructor==String?t=e&&"binary"===e.encoding?s.stringToBytes(t):r.stringToBytes(t):o(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||t.constructor===Uint8Array||(t=t.toString());for(var n=i.bytesToWords(t),c=8*t.length,u=1732584193,l=-271733879,h=-1732584194,f=271733878,d=0;d<n.length;d++)n[d]=16711935&(n[d]<<8|n[d]>>>24)|4278255360&(n[d]<<24|n[d]>>>8);n[c>>>5]|=128<<c%32,n[14+(c+64>>>9<<4)]=c;var m=a._ff,p=a._gg,g=a._hh,b=a._ii;for(d=0;d<n.length;d+=16){var v=u,w=l,y=h,k=f;u=m(u,l,h,f,n[d+0],7,-680876936),f=m(f,u,l,h,n[d+1],12,-389564586),h=m(h,f,u,l,n[d+2],17,606105819),l=m(l,h,f,u,n[d+3],22,-1044525330),u=m(u,l,h,f,n[d+4],7,-176418897),f=m(f,u,l,h,n[d+5],12,1200080426),h=m(h,f,u,l,n[d+6],17,-1473231341),l=m(l,h,f,u,n[d+7],22,-45705983),u=m(u,l,h,f,n[d+8],7,1770035416),f=m(f,u,l,h,n[d+9],12,-1958414417),h=m(h,f,u,l,n[d+10],17,-42063),l=m(l,h,f,u,n[d+11],22,-1990404162),u=m(u,l,h,f,n[d+12],7,1804603682),f=m(f,u,l,h,n[d+13],12,-40341101),h=m(h,f,u,l,n[d+14],17,-1502002290),u=p(u,l=m(l,h,f,u,n[d+15],22,1236535329),h,f,n[d+1],5,-165796510),f=p(f,u,l,h,n[d+6],9,-1069501632),h=p(h,f,u,l,n[d+11],14,643717713),l=p(l,h,f,u,n[d+0],20,-373897302),u=p(u,l,h,f,n[d+5],5,-701558691),f=p(f,u,l,h,n[d+10],9,38016083),h=p(h,f,u,l,n[d+15],14,-660478335),l=p(l,h,f,u,n[d+4],20,-405537848),u=p(u,l,h,f,n[d+9],5,568446438),f=p(f,u,l,h,n[d+14],9,-1019803690),h=p(h,f,u,l,n[d+3],14,-187363961),l=p(l,h,f,u,n[d+8],20,1163531501),u=p(u,l,h,f,n[d+13],5,-1444681467),f=p(f,u,l,h,n[d+2],9,-51403784),h=p(h,f,u,l,n[d+7],14,1735328473),u=g(u,l=p(l,h,f,u,n[d+12],20,-1926607734),h,f,n[d+5],4,-378558),f=g(f,u,l,h,n[d+8],11,-2022574463),h=g(h,f,u,l,n[d+11],16,1839030562),l=g(l,h,f,u,n[d+14],23,-35309556),u=g(u,l,h,f,n[d+1],4,-1530992060),f=g(f,u,l,h,n[d+4],11,1272893353),h=g(h,f,u,l,n[d+7],16,-155497632),l=g(l,h,f,u,n[d+10],23,-1094730640),u=g(u,l,h,f,n[d+13],4,681279174),f=g(f,u,l,h,n[d+0],11,-358537222),h=g(h,f,u,l,n[d+3],16,-722521979),l=g(l,h,f,u,n[d+6],23,76029189),u=g(u,l,h,f,n[d+9],4,-640364487),f=g(f,u,l,h,n[d+12],11,-421815835),h=g(h,f,u,l,n[d+15],16,530742520),u=b(u,l=g(l,h,f,u,n[d+2],23,-995338651),h,f,n[d+0],6,-198630844),f=b(f,u,l,h,n[d+7],10,1126891415),h=b(h,f,u,l,n[d+14],15,-1416354905),l=b(l,h,f,u,n[d+5],21,-57434055),u=b(u,l,h,f,n[d+12],6,1700485571),f=b(f,u,l,h,n[d+3],10,-1894986606),h=b(h,f,u,l,n[d+10],15,-1051523),l=b(l,h,f,u,n[d+1],21,-2054922799),u=b(u,l,h,f,n[d+8],6,1873313359),f=b(f,u,l,h,n[d+15],10,-30611744),h=b(h,f,u,l,n[d+6],15,-1560198380),l=b(l,h,f,u,n[d+13],21,1309151649),u=b(u,l,h,f,n[d+4],6,-145523070),f=b(f,u,l,h,n[d+11],10,-1120210379),h=b(h,f,u,l,n[d+2],15,718787259),l=b(l,h,f,u,n[d+9],21,-343485551),u=u+v>>>0,l=l+w>>>0,h=h+y>>>0,f=f+k>>>0}return i.endian([u,l,h,f])})._ff=function(t,e,n,i,r,o,s){var a=t+(e&n|~e&i)+(r>>>0)+s;return(a<<o|a>>>32-o)+e},a._gg=function(t,e,n,i,r,o,s){var a=t+(e&i|n&~i)+(r>>>0)+s;return(a<<o|a>>>32-o)+e},a._hh=function(t,e,n,i,r,o,s){var a=t+(e^n^i)+(r>>>0)+s;return(a<<o|a>>>32-o)+e},a._ii=function(t,e,n,i,r,o,s){var a=t+(n^(e|~i))+(r>>>0)+s;return(a<<o|a>>>32-o)+e},a._blocksize=16,a._digestsize=16,t.exports=function(t,e){if(null==t)throw new Error("Illegal argument "+t);var n=i.wordsToBytes(a(t,e));return e&&e.asBytes?n:e&&e.asString?s.bytesToString(n):i.bytesToHex(n)}},function(t,e,n){var i=n(48);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(49);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(50);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(51);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(52);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(53);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(54);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(55);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){"use strict";var i,r=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},o=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),s=[];function a(t){for(var e=-1,n=0;n<s.length;n++)if(s[n].identifier===t){e=n;break}return e}function c(t,e){for(var n={},i=[],r=0;r<t.length;r++){var o=t[r],c=e.base?o[0]+e.base:o[0],u=n[c]||0,l="".concat(c," ").concat(u);n[c]=u+1;var h=a(l),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(s[h].references++,s[h].updater(f)):s.push({identifier:l,updater:g(f,e),references:1}),i.push(l)}return i}function u(t){var e=document.createElement("style"),i=t.attributes||{};if(void 0===i.nonce){var r=n.nc;r&&(i.nonce=r)}if(Object.keys(i).forEach((function(t){e.setAttribute(t,i[t])})),"function"==typeof t.insert)t.insert(e);else{var s=o(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var l,h=(l=[],function(t,e){return l[t]=e,l.filter(Boolean).join("\n")});function f(t,e,n,i){var r=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(t.styleSheet)t.styleSheet.cssText=h(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function d(t,e,n){var i=n.css,r=n.media,o=n.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var m=null,p=0;function g(t,e){var n,i,r;if(e.singleton){var o=p++;n=m||(m=u(e)),i=f.bind(null,n,o,!1),r=f.bind(null,n,o,!0)}else n=u(e),i=d.bind(null,n,e),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=r());var n=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var i=0;i<n.length;i++){var r=a(n[i]);s[r].references--}for(var o=c(t,e),u=0;u<n.length;u++){var l=a(n[u]);0===s[l].references&&(s[l].updater(),s.splice(l,1))}n=o}}}},function(t,e,n){var i=n(56);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(58);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(59);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(60);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(61);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(62);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(63);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(64);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(65);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(66);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(67);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(68);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(69);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(70);t.exports="string"==typeof i?i:i.toString()},function(t,e,n){var i=n(71);t.exports="string"==typeof i?i:i.toString()},,,,,,function(t,e){var n,i;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&i.rotl(t,8)|4278255360&i.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=i.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],n=0,i=0;n<t.length;n++,i+=8)e[i>>>5]|=t[n]<<24-i%32;return e},wordsToBytes:function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(t){for(var e=[],n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},bytesToBase64:function(t){for(var e=[],i=0;i<t.length;i+=3)for(var r=t[i]<<16|t[i+1]<<8|t[i+2],o=0;o<4;o++)8*i+6*o<=8*t.length?e.push(n.charAt(r>>>6*(3-o)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],i=0,r=0;i<t.length;r=++i%4)0!=r&&e.push((n.indexOf(t.charAt(i-1))&Math.pow(2,-2*r+8)-1)<<2*r|n.indexOf(t.charAt(i))>>>6-2*r);return e}},t.exports=i},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(n(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,n){var i=n(2)(!1);i.push([t.i,"html.adBlocker .emerald-jumbotron-message{display:none}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,".top-message{position:absolute;top:2px;font-size:1.5em;font-weight:bold;padding:6px;margin:auto;border:solid 4px #800;border-radius:8px;background-color:#f88;color:#300;cursor:pointer}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,"html.imgBlur div.ritsu-would-blur>img{filter:blur(7px);transition:filter 1s ease}html.imgBlur div:hover.ritsu-would-blur>img{filter:blur(0px)}.room-component-message-text.room-component-message-text,.notification-unit-body.notification-unit-body{overflow:visible}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,"html.showGender .room-component-message-avatar,html.showGender .navigation-notification-unit-image{border-color:#fff;border:2px inset;width:36px;height:36px;margin:-2px 10px -2px -2px}html.showGender .room-component-message-avatar[data-gender=m],html.showGender .navigation-notification-unit-image[data-gender=m]{border-color:#0070ff}html.showGender .room-component-message-avatar[data-gender=f],html.showGender .navigation-notification-unit-image[data-gender=f]{border-color:#ff80ea}html.showGender .room-component-message-avatar[data-gender=pizza],html.showGender .navigation-notification-unit-image[data-gender=pizza]{border-color:#00f0dc}html.showGender .room-component-message-avatar[data-gender=vortex],html.showGender .navigation-notification-unit-image[data-gender=vortex]{border-color:#bf0390}html.showGender .room-component-message-avatar[data-gender=sunflower],html.showGender .navigation-notification-unit-image[data-gender=sunflower]{border-color:#ffc107}html.showGender .room-component-message-avatar[data-gender=rose],html.showGender .navigation-notification-unit-image[data-gender=rose]{border-color:maroon}html.showGender .room-component-message-avatar[data-gender=watermelon],html.showGender .navigation-notification-unit-image[data-gender=watermelon]{border-color:#18e281}html.showGender .room-component-message-avatar{width:42px;height:42px}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,".notification-count-overlay,.name-count-overlay{background:#00dced;color:#00222a;font-size:11px;font-weight:700;border:solid;border-color:#36393e;border-width:2px;margin-left:-25px;margin-right:9px;padding:3px}.container,.room-component-container{height:100% !important}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,".karma-tracker,.karma-delta{display:none}html.trackKarma .karma-tracker{display:inline-block;line-height:14px;height:32px;vertical-align:middle;font-size:1.3em;padding-left:.5em;color:var(--menu-fg-color)}html.trackKarma .karma-delta{display:block;position:absolute;top:50%;left:50%;opacity:1;transform:translateX(-50%) translateY(-50%) scale(0.1);transition:all 2s ease-out;pointer-events:none}html.trackKarma .karma-delta.positive{color:green}html.trackKarma .karma-delta.negative{color:red}html.trackKarma .karma-delta.zoom{opacity:0;transform:translateX(-50%) translateY(-50%) scale(20)}html.trackKarma .notification-unit-body.down{background:#ff808080}html.trackKarma .notification-unit-body.up{background:#80ff8080}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,".room-component-message-right{flex-direction:row;justify-content:flex-start;align-items:baseline}.user-badge-container{align-self:center}.user-badge-tick{display:flex;position:static}.room-component-flair{max-width:100%}.jumbo-message:not(.ritsu-message-hidden>*){font-size:5em}.user-extra{padding:0 .5em}html.imgBlur .ritsu-would-blur{filter:blur(4px);transition:filter .3s}html.imgBlur .ritsu-would-blur-heavy{filter:blur(8px);transition:filter .3s}html.imgBlur .ritsu-would-blur:hover,html.imgBlur .ritsu-would-blur-heavy:hover{filter:blur(0px)}.text-only{max-height:8em;overflow:auto !important}div.ritsu-avatar-hidden{color:var(--app-fg-color);font-size:32px;padding:3px}.blocked-image{border:1px solid red;border-radius:5px;padding:2px}.warning-text{padding:2px;margin:2px;font-size:14px;line-height:1.5;font-weight:bold;color:#7c2626;text-align:justify}.message-image{width:auto;height:auto;max-height:240px;max-width:80%;border-radius:4px;margin:4px;cursor:pointer}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,".embed{width:auto !important;height:auto !important;object-fit:contain;margin-top:2px}.img-fluid{width:100%;height:100%;max-width:300px;max-height:300px;object-fit:contain}.spotify{width:100%;max-width:300px;border-radius:6px;frameborder:0}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,'.main-logo.main-logo{height:38px}.user-profile-pictures-picture-preview{background:url(https://i.imgur.com/2DVJSYQ.gif)}.room-component-message-picture-container{position:relative}.picture-control{display:none;position:absolute;top:0;font-size:2em;font-weight:900}.room-component-message-picture:hover+.picture-control,.picture-control:hover{display:block;cursor:pointer}.picture-button{padding:.5em;border:1px solid var(--app-fg-color);border-radius:2px;background:var(--app-bg-color);color:var(--app-fg-color)}.picture-button.block:hover{color:red}.picture-button.save:hover{color:green}.image-grid div{display:inline-block;width:6em;height:6em;margin:5px;background-size:contain;background-repeat:no-repeat;background-position:center;cursor:pointer}.image-grid div>div{width:unset;height:unset;zoom:.6}.disable-after::after{content:"";display:none}.picker-flair-select{height:3em !important;vertical-align:bottom}.navigation-dropdown-ritsu{color:#f965fec4}.main-logo-text{display:inline-block;line-height:14px;height:32px;vertical-align:middle;font-size:1.3em;padding-left:.5em}@media screen and (max-width: 640px){.main-logo-text{display:none}}body.themeChange *{transition:background-color .3s,color .3s,border-color .3s}@media screen and (min-width: 640px){body{overflow:hidden}}body.tmp-message span.room-component-print:last-of-type{margin:-1em 0}.user-profile-micro.user-profile-micro{width:auto;max-width:400px}.navigation-notification-badge{position:absolute}.channel-expand-icon{padding:8px}.ritsu-icon-network-unavail{color:red !important}html:not(.network-unavail) .ritsu-icon-network-unavail{display:none}.navigation-notification-unit-message{margin-left:8px}',""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,":root{--ritsu-hair-color: #f965fec4;--ritsu-hair-dark-color: #b821bd}html>body{background:var(--app-bg-color)}body>div>nav{background:var(--header-bg-color)}.room-component-left.room-component-left{background:var(--roomlist-bg-color)}.room-component-center.room-component-center{background:var(--chat-bg-color)}.room-component-right.room-component-right{background:var(--userlist-bg-color)}.room-component-messages{background:var(--chat-bg-color)}.room-notification.room-notification{background:var(--chat-bg-color)}.room-component-print.room-component-print{color:var(--message-fg-color)}.room-component-input{background:var(--input-bg-color)}.room-component-input-textarea.room-component-input-textarea{color:var(--input-fg-color)}.ui-button-match{background:var(--input-bg-color)}#container{background:var(--app-bg-color)}.room-component-container.room-component-container{color:var(--app-fg-color)}.dashboard-button.animated.zoomIn,.dashboard-button{background:var(--dashboard-button-bg-color)}.navigation-notification-icons.navigation-notification-icons{background:transparent}.ui-search-box{background:var(--search-bg-color);color:var(--search-fg-color)}.side-panel.side-panel{background:var(--panel-bg-color)}.actionicon-mega.actionicon-mega{color:var(--panel-fg-color)}.actionicon-mega.actionicon-mega:hover{background:var(--item-hover-bg-color)}.ui-bg.ui-bg{background:var(--dialog-overlay-bg-color)}.ui-menu.ui-menu,.notification-unit.notification-unit{background:var(--dialog-bg-color);color:var(--dialog-fg-color)}.ui-interests-bg.ui-interests-bg{background:var(--interests-bg-color) !important}.navigation-notification-unit.navigation-notification-unit:hover{background:var(--header-hover-bg-color);color:var(--header-hover-fg-color)}.navigation-notification-unit{color:var(--header-fg-color)}:last-child>.navigation-notification-unit{color:var(--header-hover-fg-color)}.navigation-dropdown-content.navigation-dropdown-content{background:var(--menu-bg-color);color:var(--menu-fg-color)}.dashboard-icon.dashboard-icon{color:var(--dashboard-icon-fg-color)}.dashboard-button.dashboard-button:hover{color:var(--dashboard-hover-fg-color);background:var(--dashboard-hover-bg-color)}.actionicon-icon.actionicon-icon{color:var(--dashboard-icon-fg-color)}.main-hamburger.main-hamburger{color:var(--header-fg-color)}.main-hamburger.main-hamburger:hover,.main-logo.main-logo:hover{background:var(--header-hover-bg-color) !important;color:var(--header-hover-fg-color)}.user-profile-menu.user-profile-menu{background:var(--dialog-bg-color)}.user-micropost-input-background.user-micropost-input-background{background:var(--dialog-input-bg-color)}.user-micropost-input.user-micropost-input{color:var(--dialog-input-fg-color)}.ui-button-micro.ui-button-micro{background:var(--dialog-button-bg-color);color:var(--dialog-button-fg-color)}.user-profile-tab.user-profile-tab,.ui-tab.ui-tab{color:var(--tab-fg-color)}.user-profile-tab-active.user-profile-tab-active,.ui-tab-active.ui-tab-active{color:var(--tab-active-fg-color)}.ui-button-mega.ui-button-mega:hover{background:var(--dialog-button-hover-bg-color);color:var(--dialog-button-hover-fg-color)}.ui-button-mega.ui-button-mega{background:var(--dialog-button-bg-color);color:var(--dialog-button-fg-color)}.ui-input.ui-input{background:var(--dialog-input-bg-color) !important;color:var(--input-fg-color)}.dashboard-card-image.dashboard-card-image{border-color:var(--dashboard-icon-fg-color)}.user-comment-input-background.user-comment-input-background{background:var(--dialog-input-bg-color)}.user-comment-input.user-comment-input{color:var(--dialog-input-fg-color)}.room-component-left .room-user-label{color:var(--roomlist-title-fg-color)}.room-component-right .room-user-label{color:var(--userlist-title-fg-color)}.picture-upload-button.picture-upload-button+label{background:var(--upload-button-bg-color);color:var(--upload-button-fg-color)}.main-logo-text{color:var(--menu-fg-color)}.navigation-dropdown-ritsu{color:var(--ritsu-menu-fg-color)}.navigation-dropdown-ritsu:hover{color:var(--ritsu-menu-hover-fg-color)}.notification-menu-container-text{color:var(--dialog-fg-color)}.notification-menu-container-text span{text-shadow:#000 0 0 3px}.user-flair.user-flair,.user-extra-gender{text-shadow:-0.05em -0.05em #fff5}.user-profile-picture-wrapper .btn{margin-top:.2rem;margin-bottom:.5rem;color:var(--upload-button-fg-color);border:solid;border-color:#26292f;border-width:2px;background-color:var(--dashboard-icon-bg-color)}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,":root{--header-bg-color: #100f10;--header-alt-bg-color: #232529;--header-hover-bg-color: #3d4046;--app-bg-color: black;--dialog-bg-color: #111;--dialog-overlay-bg-color: rgba(0, 0, 0, 0.93);--dialog-button-bg-color: #17191b;--dialog-button-hover-bg-color: #151515;--dialog-input-bg-color: #17191b;--dashboard-button-bg-color: #100f10;--dashboard-hover-bg-color: #33323270;--roomlist-bg-color: black;--chat-bg-color: black;--userlist-bg-color: black;--input-bg-color: #211f21;--search-bg-color: #0b0b0b;--panel-bg-color: #0c0c0c;--item-hover-bg-color: #35383e;--interests-bg-color: #2c2f35;--menu-bg-color: #0a0a0a;--upload-button-bg-color: #41444a;--header-fg-color: white;--header-hover-fg-color: var(--ritsu-hair-color);--app-fg-color: #bebfc5;--dialog-fg-color: #f1f1f2;--dialog-button-fg-color: #d5dcec;--dialog-button-hover-fg-color: var(--ritsu-hair-color);--dialog-input-fg-color: #d7dfec;--dashboard-icon-fg-color: var(--ritsu-hair-color);--dashboard-hover-fg-color: var(--ritsu-hair-color);--roomlist-title-fg-color: #99a3b4;--userlist-title-fg-color: #99a3b4;--tab-fg-color: #c2c8d6;--tab-active-fg-color: var(--ritsu-hair-color);--message-fg-color: #afbacd;--input-fg-color: #caccd0;--search-fg-color: #f0f0f1;--panel-fg-color: white;--menu-fg-color: white;--upload-button-fg-color: #b4bccc;--ritsu-menu-fg-color: var(--ritsu-hair-color);--ritsu-menu-hover-fg-color: var(--ritsu-hair-color)}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,":root{--header-bg-color: #bbb;--header-alt-bg-color: #ccc;--header-hover-bg-color: #aaa;--app-bg-color: #ddd;--dialog-bg-color: #ddd;--dialog-overlay-bg-color: rgba(0, 0, 0, 0.5);--dialog-button-bg-color: #cfdeec;--dialog-button-hover-bg-color: #f0f0f0;--dialog-input-bg-color: #cfdeec;--dashboard-button-bg-color: #f0e4f0;--dashboard-hover-bg-color: #cfcdcd70;--roomlist-bg-color: #ccc;--chat-bg-color: #ddd;--userlist-bg-color: #ccc;--input-bg-color: #fff;--search-bg-color: #f7f7f7;--panel-bg-color: #ccc;--item-hover-bg-color: #a3adc0;--interests-bg-color: #aab6ce;--menu-bg-color: #aaa;--upload-button-bg-color: #ccc;--header-fg-color: #333;--header-hover-fg-color: var(--ritsu-hair-dark-color);--app-fg-color: #333;--dialog-fg-color: #333;--dialog-button-fg-color: #000;--dialog-button-hover-fg-color: var(--ritsu-hair-dark-color);--dialog-input-fg-color: #000;--dashboard-icon-fg-color: var(--ritsu-hair-dark-color);--dashboard-hover-fg-color: var(--ritsu-hair-dark-color);--roomlist-title-fg-color: #555;--userlist-title-fg-color: #555;--tab-fg-color: #444;--tab-active-fg-color: var(--ritsu-hair-dark-color);--message-fg-color: #666;--input-fg-color: #222;--search-fg-color: #222;--panel-fg-color: #333;--menu-fg-color: #333;--upload-button-fg-color: #444;--ritsu-menu-fg-color: var(--ritsu-hair-dark-color);--ritsu-menu-hover-fg-color: var(--ritsu-hair-color)}.user-flair.user-flair,.user-extra-gender{text-shadow:1px 1px 1px #000}.actionicon-mega.actionicon-mega:hover{background:#aaa}.ui-button-text.ui-button-text:hover{color:#666}.user-profile-menu.user-profile-menu{background:#ddd;color:#333}.user-micropost-unit.user-micropost-unit{color:#333}.ritsu-menu-container li{color:#666}.ritsu-menu-container li.selected{color:#222}.ritsu-menu-container li:hover{background:#fff}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,".notification-unit.notification-unit{background:var(--dialog-bg-color);color:var(--white-label)}.user-profile-interest{background:var(--last-child);color:#fff}:last-child>.navigation-notification-unit{color:var(--green-label)}.user-profile-menu.user-profile-menu{background:var(--dialog-bg-color);color:var(--yellow-label)}.user-micropost-input-background.user-micropost-input-background{background:var(--dialog-input-bg-color)}.user-micropost-input.user-micropost-input{color:var(--dialog-input-fg-color)}.ui-button-micro.ui-button-micro{background:var(--dialog-button-bg-color);color:var(--white-label)}.ui-button-mega.ui-button-mega{background:var(--dialog-button-bg-color);color:var(--golden-label)}.notification-menu-container-text{color:var(--pink-label)}.notification-menu-container-text span{text-shadow:#000 0 0 3px}.ui-button-mega-icon{color:var(--last-child)}.m1{color:var(--cyan-label)}.m2{color:var(--cyan-label)}.m4{color:var(--cyan-label)}label{color:var(--violet-blue-label)}.user-profile-sub{color:var(--white-label)}.notification-menu-container-text2{color:var(--violet-blue-label)}.ui-button{background:var(--last-child);color:var(--white-label)}.ui-button:hover{background:var(--last-child-light);color:var(--white-label)}.ui-button-text{color:var(--white-label)}.ui-menu-text{color:var(--violet-blue-label)}.ui-button-match-mega{background:var(--last-child);color:var(--white-label)}.ui-button-match-mega:hover{background:var(--last-child-light);color:var(--white-label)}.user-profile-micro-top{background:var(--darkie-label)}.user-profile-micro-button{background:var(--darkie-label)}.label{color:var(--golden-label)}[type=radio]:checked+label:after{background-color:var(--green-aqua-label)}[type=checkbox]:checked+label:before{border-right:2px solid #0eeca0;border-bottom:2px solid #0eeca0}.room-component-message-avatar,html.showGender,.navigation-notification-unit-image,.main-logo,.dashboard-card-image,.user-profile-micro-avatar,.user-profile-avatar,.user-micropost-picture,.user-comment-picture,.user-profile-picture-hover{border-radius:10px}.user-online-icon-profile{margin-left:-27px}:root{--app-bg-color: black;--dialog-bg-color: #111;--dialog-overlay-bg-color: rgba(0, 0, 0, 0.93);--dialog-button-bg-color: #17191b;--dialog-button-hover-bg-color: #151515;--dialog-input-bg-color: #17191b;--dashboard-button-bg-color: #100f10;--dashboard-hover-bg-color: #33323270;--header-bg-color: #100f10;--userlist-bg-color: black;--header-bg-color: #100f10;--header-alt-bg-color: #3d4046;--header-hover-bg-color: #3d4046;--input-bg-color: #211f21;--roomlist-bg-color: black;--interests-bg-color: #2c2f35;--chat-bg-color: black;--userlist-bg-color: black;--search-bg-color: #0b0b0b;--panel-bg-color: #0c0c0c;--item-hover-bg-color: #35383e;--upload-button-bg-color: #41444a;--menu-bg-color: #0a0a0a;--header-fg-color: #e6fc6d;--header-alt-fg-color: #232529;--panel-fg-color: white;--last-child: #b821bd;--last-child-light: #ee71f2;--emerald-label: #18e281;--violet-blue-label: #8e95f9;--green-label: #b9fc6d;--golden-label: #ffc107;--scarlet-label: #9ddb60;--green-aqua-label: #0eeca0;--golden-light-label: #ffe8a3;--pink-label: #ffb3d1;--dark-violet: #9c3edd;--cyan-label: #3fffe5;--yellow-label: #fefb1f;--darkie-label: #0932a7;--white-label: #e0e0e0;--input-fg-color: var(--white-label);--search-fg-color: var(--white-label);--roomlist-title-fg-color: var(--emerald-label);--userlist-title-fg-color: var(--emerald-label);--message-fg-color: var(--green-label);--user-profile-tab-active: var(--green-label);--dialog-button-hover-fg-color: var(--golden-light-label);--upload-button-fg-color: var(--golden-label);--dashboard-icon-fg-color: var(--ritsu-hair-dark-color);--main-logo-text: var(--green-label);--app-fg-color: var(--white-label);--dialog-fg-color: var(--scarlet-label);--dashboard-hover-fg-color: var(--golden-label);--ritsu-hair-color: var(--green-label);--ritsu-hair-dark-color: var(--green-label);--ritsu-menu-fg-color: var(--ritsu-hair-color);--ritsu-menu-hover-fg-color: var(--ritsu-hair-color)}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,".notification-unit.notification-unit{background:var(--dialog-bg-color);color:var(--white-label)}.user-profile-interest{background:var(--last-child);color:#fff}:last-child>.navigation-notification-unit{color:var(--green-label)}.user-profile-menu.user-profile-menu{background:var(--dialog-bg-color);color:var(--yellow-label);border:3px inset;border-color:var(--border-label)}.user-micropost-input-background.user-micropost-input-background{background:var(--dialog-input-bg-color);border:2px inset;border-color:var(--border-label)}.user-micropost-input.user-micropost-input{color:var(--dialog-input-fg-color)}.ui-button-micro.ui-button-micro{background:var(--dialog-button-bg-color);color:var(--white-label)}.ui-button-mega.ui-button-mega{background:var(--dialog-button-bg-color);color:var(--golden-label)}.notification-menu-container-text{color:var(--pink-label)}.notification-menu-container-text span{text-shadow:#000 0 0 3px}.ui-button-mega-icon{color:var(--last-child)}.m1{color:var(--cyan-label)}.m2{color:var(--cyan-label)}.m4{color:var(--cyan-label)}label{color:var(--violet-blue-label)}.user-profile-sub{color:var(--white-label)}.notification-menu-container-text2{color:var(--violet-blue-label)}.ui-button{background:var(--last-child);color:var(--white-label)}.ui-button:hover{background:var(--last-child-light);color:var(--white-label)}.ui-button-text{color:var(--white-label)}.ui-menu-text{color:var(--violet-blue-label)}.ui-button-match-mega{background:var(--last-child);color:var(--white-label)}.ui-button-match-mega:hover{background:var(--last-child-light);color:var(--white-label)}.user-profile-micro-top{background:var(--darkie-label)}.user-profile-micro-button{background:var(--darkie-label)}.label{color:var(--golden-label)}[type=radio]:checked+label:after{background-color:var(--green-aqua-label)}[type=checkbox]:checked+label:before{border-right:2px solid #0eeca0;border-bottom:2px solid #0eeca0}.room-component-message-avatar,html.showGender,.navigation-notification-unit-image,.main-logo,.dashboard-card-image,.user-profile-micro-avatar,.user-profile-avatar,.user-micropost-picture,.user-comment-picture,.user-profile-picture-hover{border-radius:10px}.user-online-icon-profile{margin-left:-27px}#container,.room-component-center,.room-component-messages{background:rgba(37,16,39,.2) !important}body>div>nav{background:rgba(117,0,128,.51) !important}.dashboard-button.animated.zoomIn,.dashboard-button{background:rgba(104,40,100,.44) !important;border:3px inset;border-color:var(--border-label)}.dashboard-button.dashboard-button:hover,.actionicon-mega.actionicon-mega:hover,.navigation-dropdown-content li:hover{background:rgba(8,33,166,.4) !important;border:2px inset}.ui-menu{border:3px inset;border-color:var(--border-label)}.user-profile-info{background:#14001a;border:2px inset;border-color:var(--border-label);height:calc(100% - 120px)}.user-profile-avatar{border:4px inset;border-color:var(--border-label)}.room-component-typing-container{color:#ffc107}.line-scale-pulse-out-rapid>div{background:#ffc107}.line-scale-pulse-out-rapid2>div{background:red}.channel-unit{color:#fff}.channel-unit-active{background:#0932a7;border:2px inset}.channel-unit:hover,.channel-unit-active:hover{color:#0eeca0;border:2px inset}.room-component-input-textarea{background:#14001a !important}.ui-button-match{background:#14001a !important;color:var(--emerald-label);border-radius:50px;margin-left:6px;border-top-right-radius:1 !important;border-bottom-right-radius:1 !important;border:2px inset;border-color:var(--border-label)}.room-component-module,.room-component-left .room-user-label{background:rgba(37,16,39,.6) !important}.room-component-right,.room-component-right-container{background:rgba(37,16,39,.6) !important}.room-component-input{background:#9e1dc1 !important;border:1px inset;border-color:var(--border-label)}.room-component-message-container{border-color:#3fffe5}.side-panel.side-panel,.navigation-dropdown-content li{background:#251027 !important}.ui-button-micro{border-color:var(--golden-label) !important}.ui-button-mega{border-color:var(--golden-label) !important}.ui-interests-bg{border-color:var(--golden-label) !important}.ui-interests-bg.ui-interests-bg{background:var(--input-color-label) !important}.ui-select select,.room-notification.room-notification{background:var(--input-color-label) !important;border-color:var(--golden-label) !important;color:var(--pink-label) !important}.user-micropost-unit{background:var(--input-color-label);border:2px inset;border-color:var(--border-label)}.user-micropost-button,.user-comment-button{color:var(--golden-label)}.user-comment-input.user-comment-input{background:rgba(146,17,157,.44)}.user-micropost-picture{margin:2px 10px -2px 6px}.ui-search-box{border:2px inset;border-color:var(--border-label)}.ui-input{border:2px inset !important;border-color:var(--border-label) !important}.ui-profile-menu{border:2px inset;border-color:var(--border-label)}.notification-button{border:2px inset;border-color:var(--border-label);color:var(--white-label)}.picture-upload-button.picture-upload-button+label{border:2px inset;border-color:var(--golden-label)}.user-profile-pictures-picture-preview{border:2px inset}.user-micropost-date,.room-component-input-icon,.notification-date{color:var(--emerald-label)}.user-profile-pictures-upload-button{background:var(--input-color-label) !important;color:var(--emerald-label) !important}.user-profile-pictures-upload-button:hover{background:var(--blueberry-hover)}.room-component-picture-icon{margin-left:10px}@media screen and (max-width: 640px){.user-profile-info{width:96%}.user-micropost-unit{width:97%}}:root{--app-bg-color: black;--dialog-bg-color: #111;--dialog-overlay-bg-color: rgba(0, 0, 0, 0.93);--dialog-button-bg-color: #17191b;--dialog-button-hover-bg-color: #151515;--dialog-input-bg-color: #17191b;--dashboard-button-bg-color: #100f10;--dashboard-hover-bg-color: #33323270;--header-bg-color: #100f10;--userlist-bg-color: black;--header-bg-color: #100f10;--header-alt-bg-color: #3d4046;--header-hover-bg-color: #3d4046;--input-bg-color: #211f21;--roomlist-bg-color: black;--interests-bg-color: #2c2f35;--chat-bg-color: black;--userlist-bg-color: black;--search-bg-color: #0b0b0b;--upload-button-bg-color: rgb(65, 68, 74);--panel-bg-color: #0c0c0c;--item-hover-bg-color: #35383e;--upload-button-bg-color: #41444a;--menu-bg-color: #0a0a0a;--header-fg-color: #e6fc6d;--header-alt-fg-color: #232529;--panel-fg-color: white;--last-child: #b821bd;--last-child-light: #ee71f2;--emerald-label: #18e281;--violet-blue-label: #8e95f9;--green-label: #b9fc6d;--golden-label: #ffc107;--scarlet-label: #9ddb60;--green-aqua-label: #0eeca0;--golden-light-label: #ffe8a3;--pink-label: #ffb3d1;--dark-violet: #9c3edd;--cyan-label: #3fffe5;--yellow-label: #fefb1f;--darkie-label: #0932a7;--white-label: #e0e0e0;--border-label: #ced9ee;--blueberry-label: rgb(51, 0, 48);--input-color-label: rgb(20, 0, 26);--blueberry-hover: #62034f;--dialog-bg-color: var(--blueberry-label);--input-fg-color: var(--white-label);--dialog-input-bg-color: var(--input-color-label);--dialog-button-bg-color: var(--input-color-label);--dialog-button-hover-bg-color: var(--blueberry-hover);--search-bg-color: var(--input-color-label);--search-fg-color: var(--white-label);--roomlist-title-fg-color: var(--emerald-label);--userlist-title-fg-color: var(--emerald-label);--message-fg-color: var(--green-label);--user-profile-tab-active: var(--green-label);--dialog-button-hover-fg-color: var(--golden-light-label);--upload-button-fg-color: var(--golden-label);--dashboard-icon-fg-color: var(--ritsu-hair-dark-color);--main-logo-text: var(--green-label);--app-fg-color: var(--white-label);--dialog-fg-color: var(--scarlet-label);--dashboard-hover-fg-color: var(--golden-label);--upload-button-bg-color: var(--input-color-label);--ritsu-hair-color: var(--green-label);--ritsu-hair-dark-color: var(--green-label);--ritsu-menu-fg-color: var(--ritsu-hair-color);--ritsu-menu-hover-fg-color: var(--ritsu-hair-color)}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,"body{font:14px Verdana}.user-profile-micro{font-family:Verdana !important}.notification-menu-container-text,.user-micropost-unit{font-family:Verdana}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,"body{font:14px Comic Sans MS}.user-profile-micro{font-family:Comic Sans MS !important}.notification-menu-container-text,.user-micropost-unit{font-family:Comic Sans MS}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,"body{font:14px Helvetica}.user-profile-micro{font-family:Helvetica !important}.notification-menu-container-text,.user-micropost-unit{font-family:Helvetica}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,"body{font:14px Trebuchet MS}.user-profile-micro{font-family:Trebuchet MS !important}.notification-menu-container-text,.user-micropost-unit{font-family:Trebuchet MS}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,"",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,'.lookup-button{border:0;padding:0;background:none;margin-right:.5em;margin-top:-4px}.sort-button{width:20px;height:20px;font-weight:normal;text-transform:none}.sort-button>span{padding:0;margin-top:-4px}.sort-button>div.navigation-dropdown-content{text-align:left;width:180px;top:92px}.sort-button>div.navigation-dropdown-content>div{padding:7px;font-weight:500}.sort-button>div.navigation-dropdown-content>li{display:list-item;list-style:""}.sort-button>div.navigation-dropdown-content>li.selected{list-style:""}',""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,'.picture-upload-info{font-size:14px;font-weight:400;color:"#adb6c7"}.picture-upload-info div{margin-bottom:1em}.picture-upload-error{color:red;font-weight:bold}.picture-upload-error-reason{font-weight:initial}.upload-thing{vertical-align:middle;margin-right:5px}',""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,".user-profile-bottom{width:100%;height:100%;overflow:clip;max-height:480px}.user-profile-menu{max-height:600px;height:600px;position:relative}.user-comment-input-background{height:75px}.user-comment-input{resize:none;height:75px;line-height:normal}.user-micropost-input{max-height:133px;min-height:35px}.room-component-input-textarea{bottom:0;max-height:133px}.room-component-input{bottom:0;height:auto;max-height:133px;min-height:35px;padding-top:4px;padding-bottom:4px}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,"a.ritsu-message-anchor{text-decoration:underline}.material-icons-inline{font-size:inherit}.material-icons{user-select:none}html.largerText .room-component-message-text{font-size:1.3rem}.bio-image{padding:.3em;margin:.5em;background-color:var(--ritsu-hair-color);color:#000;display:inline-block;user-select:none;border-radius:.3em;font-size:.8em}.bio-expand{color:#00abf3;font-weight:bold;cursor:pointer}",""]),t.exports=i},function(t,e,n){var i=n(2)(!1);i.push([t.i,".mod-approval-pic{max-height:200px;max-width:240px}button{background-color:#3b6a3d;border:none;color:#fff;padding:13px 15px;text-align:center;text-decoration:none;display:inline-block;font-size:16px;margin:4px 2px;cursor:pointer;border-radius:10px;box-shadow:0px 0px 10px rgba(0,0,0,.2)}button:hover{background-color:#3e8e41}button:focus,button:active{outline:none;background-color:#3b6a3d}.checkmark-button-container{position:relative;display:inline-block}.checkmark-button{position:absolute;top:10px;left:10px;width:24px;height:24px;border-radius:50%;background-color:transparent;border:2px solid #fff;opacity:.5;transition:all .3s ease;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:1;padding:0%}.checkmark-button.selected{background-color:#007aff;opacity:1}.checkmark-button:hover{opacity:1}.checkmark-button .checkmark{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);width:16px;height:16px;stroke:#fff;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;fill:none;opacity:0;transition:all .3s ease}.checkmark-button.selected .checkmark{opacity:1}.reason{height:auto !important}",""]),t.exports=i},function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"setPrefix",(function(){return f})),n.d(i,"setLogger",(function(){return d})),n.d(i,"log",(function(){return m})),n.d(i,"info",(function(){return p})),n.d(i,"warning",(function(){return g})),n.d(i,"error",(function(){return b}));var r={};n.r(r),n.d(r,"subscriptable",(function(){return v})),n.d(r,"loggingResponseHandler",(function(){return w})),n.d(r,"noopResponseHandler",(function(){return y}));var o="ritsu-emerald",s="Ritsu x Emerald",a="RxE",c="0.13.2.8",u="https://i.imgur.com/KLtVhho.png";let l="",h=console;function f(t){l=t}function d(t){h=t}function m(t){h.log(l,t)}function p(t){h.info(l,t)}function g(t){h.warn(l,t)}function b(t){h.error(l,t)}function v(t){const e=new Set;return{subscribe:t=>{e.add(t)},unsubscribe:t=>{e.delete(t)},handler:(n,i)=>("set"===n.action&&e.forEach(t=>t(n.preference)),t(n,i))}}function w(t,e){const n=t.response;switch(n.status){case 0:return n;case 1:return"get"===t.action&&(g(`The saved value for preference '${t.preference.key}' (${JSON.stringify(n.saved)}) was invalid. Replacing it with ${JSON.stringify(n.value)}.`),e.set(t.preference,n.value)),"set"===t.action&&g(`Could not set value ${JSON.stringify(n.value)} for preference '${t.preference.key}' because it was invalid.`),n;case 2:return"get"===t.action&&(g(`The saved value for preference '${t.preference.key}' had the wrong type. Replacing it with ${JSON.stringify(n.value)}.`),e.set(t.preference,n.value)),n;case 3:return"get"===t.action&&(g(`The saved value for preference '${t.preference.key}' could not be parsed. Replacing it with ${JSON.stringify(n.value)}.`),e.set(t.preference,n.value)),n;case 4:switch(t.action){case"get":b(`Could not read preference '${t.preference.key}' because localStorage could not be accessed. Using value ${JSON.stringify(t.preference.default)}.`);break;case"set":b(`Could not save value ${JSON.stringify(t.response.value)} for preference '${t.preference.key}' because localStorage could not be accessed.`);break;default:k(t.action)}return n;default:return k(n.status)}}function y(t,e){return t.response}function k(t){throw new Error("assertUnreachable: "+t)}var x="undefined"!=typeof unsafeWindow?unsafeWindow:window;function C(t,e){return void 0===e?t:e}function A(t,e){switch(!0){case Number.isNaN(e):return"NaN";case e===1/0:return"Infinity";case e===-1/0:return"-Infinity";default:return e}}function R(t){return JSON.stringify(t,A)}const E=[function(t){return"boolean"==typeof t},function(t){return"number"==typeof t},M,function(t){return"symbol"==typeof t},N,function(t){return void 0===t}];function M(t){return"string"==typeof t}function N(t){return null===t}function S(t){return E.some(e=>e(t))}function T(t,e,n){return i=`${t.name}(${e.name})`,r=n,Object.defineProperty(r,"name",{value:i,writable:!1});var i,r}function _(t){return S(t)?t=>!1:T(_,t,e=>e instanceof t)}function I(t,e){e.constraints=t.concat(C([],e.constraints))}class D{constructor(t){if(""===t.key)throw new TypeError(`Empty preference key in this ${this.getClassName()}:\n${R(t)}`);this.key=t.key,this.default=t.default,this.label=t.label,this.description=C("",t.description),this.constraints=C([],t.constraints),this.dependencies=C([],t.dependencies),this.extras=C({},t.extras);const e=this.validate(t.default);M(e)&&this.invalidValue(t.default,e)}validate(t){const e=this.constraints;for(let n=0,i=e.length;n<i;n++){const i=e[n];if(!i.requirement(t))return i.message(t)}return{value:t}}toValid(t){return M(this.validate(t))?this.default:t}toString(){return`${this.getClassName()} '${this.key}'`}invalidValue(t,e){throw new Error(`${R(t)} is not a valid value for ${this}. Reason: ${e}`)}}class O extends D{constructor(t){const e=C(0,t.minLength),n=C(1/0,t.maxLength),i=[];if(t.multiline||i.push({requirement:t=>!t.includes("\n"),message:t=>"Line breaks are not allowed."}),e>0&&i.push({requirement:t=>t.length>=e,message:t=>`Minimum length is ${e} characters.`}),n<1/0&&i.push({requirement:t=>t.length<=n,message:t=>`Maximum length ${n} exceeded.`}),I(i,t),super(t),e<0)throw new Error(`Parameter 'minLength' cannot be negative, but it was ${e} in ${this}.`);this.multiline=t.multiline,this.maxLength=n,this.minLength=e}getClassName(){return"StringPreference"}toValid(t){const e=t.substring(0,this.maxLength);return super.toValid(this.multiline?e:e.replace(O.REGEX_LINE_BREAKS," "))}fromString(t){return this.validate(t)}}O.REGEX_LINE_BREAKS=/\n+/g;class P extends D{getClassName(){return"BooleanPreference"}}class U extends D{getClassName(){return"ListPreference"}}class j extends D{constructor(t){const e=t.options;if(I([{requirement:t=>e.some(e=>e.value===t),message:t=>R(t)+" is not among the available options."}],t),super(t),e.length<2)throw new Error(`Parameter 'options' has less than two elements in ${this}.`);const n=[];e.forEach(t=>{const e=this.validate(t.value);if(M(e))throw new Error(`Option value ${R(t.value)} in ${this} is invalid. Reason: ${e}`);if(n.indexOf(t.value)>-1)throw new Error(`Multiple options with value ${R(t.value)} in ${this}.`);n.push(t.value)}),this.options=e}getClassName(){return"MultichoicePreference"}toValid(t){return this.default}}class F extends D{static postParse(t,e){return M(e)?e:t.validate(e.value)}constructor(t){I([{requirement:Number.isFinite,message:t=>t+" is not a finite number."}],t),super(t)}}class L extends F{constructor(t){I([L.CONSTRAINT_INTEGER],t),super(t)}getClassName(){return"IntegerPreference"}static parse(t){const e=parseInt(t,10);return Number.isNaN(e)?`"${t}" is not an integer.`:{value:e}}toValid(t){return super.toValid(Math.round(t))}fromString(t){return F.postParse(this,L.parse(t))}}var V;L.CONSTRAINT_INTEGER={requirement:Number.isInteger,message:t=>t+" is not an integer."},function(t){t.OK="OK",t.ABSENT="ABSENT",t.TYPE_ERROR="TYPE_ERROR",t.JSON_ERROR="JSON_ERROR",t.STORAGE_ERROR="STORAGE_ERROR",t.NUMBER_ERROR="NUMBER_ERROR"}(V||(V={}));const B=()=>localStorage;function G(t,e,n){try{const i=function(t,e,n){if(null===t)throw new DOMException;const i=t.getItem(e);if(N(i))return null;const r=JSON.parse(i);if(function t(e){for(const t of E)if(t(e))return e=>t(e);if(_(Array)(e)){const n=e;return e=>_(Array)(e)&&(!(n.length>0)||e.every(t(n[0])))}if(e.constructor===Object)return n=>![void 0,null].includes(n)&&Object.keys(e).every(i=>t(e[i])(n[i]));if(e.constructor instanceof Function)return _(e.constructor);throw new TypeError(t.name+" cannot use this object as reference because it has no constructor: "+JSON.stringify(e))}(n)(r))return r;throw new TypeError("Saved value had wrong type.")}(t(),e,n);return N(i)?{status:"ABSENT",value:n}:{status:"OK",value:i}}catch(t){return{status:_(SyntaxError)(t)?"JSON_ERROR":_(TypeError)(t)?"TYPE_ERROR":"STORAGE_ERROR",value:n}}}function z(t,e,n){try{return function(t,e,n){const i=JSON.stringify(n,(t,e)=>{if("number"==typeof e&&!Number.isFinite(e))throw new RangeError(e.toString());return e});if(null===t)throw new DOMException;t.setItem(e,i)}(t(),e,n),{status:"OK",value:n}}catch(t){return{status:_(RangeError)(t)?"NUMBER_ERROR":_(SyntaxError)(t)||_(TypeError)(t)?"JSON_ERROR":"STORAGE_ERROR",value:n}}}function q(t,e){try{return t().removeItem(e),{status:"OK",value:!0}}catch(t){return{status:"STORAGE_ERROR",value:!1}}}var H;!function(t){t[t.OK=0]="OK",t[t.INVALID_VALUE=1]="INVALID_VALUE",t[t.TYPE_ERROR=2]="TYPE_ERROR",t[t.JSON_ERROR=3]="JSON_ERROR",t[t.STORAGE_ERROR=4]="STORAGE_ERROR"}(H||(H={}));const K=(t,e)=>t.response;function Q(t){return`Unknown preference:\n\n${R(t)}.`}function J(t){switch(t){case"OK":case"ABSENT":return 0;case"NUMBER_ERROR":return 1;case"TYPE_ERROR":return 2;case"JSON_ERROR":return 3;case"STORAGE_ERROR":return 4}}var W=Object.assign(Object.assign(Object.assign(Object.assign({title:`${s} ${c}`,themeTitle:"Choose your theme",fontTitle:"Choose your font"},!1),{generalTitle:"General Settings",imagesTitle:"Image Settings",messageTitle:"Message Settings",mutelistTitle:"Permanent Mutes",advancedTitle:"Advanced Settings",preferences:Object.assign(Object.assign({theme:{label:"Theme",description:"Reskin the chat"},font:{label:"Font",description:"Change the font"}},!1),{adBlocker:{label:"Remove ads and nags"},fancyColors:{label:"Choose your own flair color"},imgControl:{label:"Block and favorite images"},legacyImages:{label:"Use legacy image sending (for emerald gold users)"},imgProtect:{label:"Hide images from low karma accounts"},imgBlur:{label:"Blur user images"},hidePfp:{label:"Hide profile pictures in chat"},showInfo:{label:"Show extra user info"},antiSpam:{label:"Mute spammers automatically"},showGender:{label:"Show gender on profile pictures"},trackKarma:{label:"Show live karma & flash changes"},mutelist:{label:"Perma mute list"},userSort:{label:"Sort users by..","name.asc":"Name Asc.","name.desc":"Name Desc.","age.asc":"Account age Asc.","age.desc":"Account age Desc."},blockReqs:{label:"Block friend requests from new accounts"},highlightMentions:{label:"Highlight your name when you're mentioned"},altpfpBackground:{label:"Choose the background colour for transparent pictures"},bigEmoji:{label:"Jumbo-sized emoji"},hideImageFallback:{label:"Hide your images from non-RxE users"},ignoreURLBlacklist:{label:"Ignore URL blacklist"},imgurAPIKey:{placeholder:"Imgur API Key",label:"Leave blank for default"},muteRegexes:{label:"Mute users matching"},toggleEmbeds:{label:"Show embeds"},largerText:{label:"Increase text size"},showAnimatedImages:{label:"Show GIFs"},notifyUpdates:{label:"Notify when updates are available"},hideFromGc:{label:"Hide yourself from side-list in group chat (mods only)"},hideTyping:{label:"Hide your typing status in chat"}}),hiddenChannels:"hidden channels",WFAF:"WFAF ",privateRooms:"Private Rooms ",privateRoomsPrompt:"Enter a private room key:\nOnly people with the key can enter this room.",privateRoomsWarning:"Chat history and user list is not available in unlisted rooms."}),!1),{introduction:{title:"Welcome to RxE.",content:"How do you want to use Emerald?",presetsTitle:"Choose your preset",presets:{safe:{title:"Safe",content:"Block requests from new accounts. Images from low karma accounts are hidden, all others blurred. GIFs and embeds are not shown."},normal:{title:"Normal",content:"Anyone can add you. Images from low karma accounts are hidden. GIFs and embeds are shown."},unsafe:{title:"Wild West",content:"Anyone can add you. No restrictions on images or profile pictures."}}}});const X=null;var Y;!function(t){t[t.None=0]="None",t[t.Hide=1]="Hide",t[t.Reject=2]="Reject"}(Y||(Y={}));const Z={theme:new O({key:"theme",label:W.preferences.theme.label,description:W.preferences.theme.description,default:"ritsu",multiline:!1}),font:new O({key:"font",label:W.preferences.font.label,description:W.preferences.font.description,default:"default",multiline:!1}),adBlocker:new P({key:"adBlocker",label:W.preferences.adBlocker.label,default:!0}),fancyColors:new P({key:"fancyColors",label:W.preferences.fancyColors.label,default:!0}),imgControl:new P({key:"imgControl",label:W.preferences.imgControl.label,default:!0}),imgProtect:new P({key:"imgProtect",label:W.preferences.imgProtect.label,default:!0}),legacyImages:new P({key:"legacyImages",label:W.preferences.legacyImages.label,default:!0}),imgBlur:new P({key:"imgBlur",label:W.preferences.imgBlur.label,default:!1}),hidePfp:new P({key:"hidePfP",label:W.preferences.hidePfp.label,default:!1}),showInfo:new P({key:"showInfo",label:W.preferences.showInfo.label,default:!0}),antiSpam:new P({key:"antiSpam",label:W.preferences.antiSpam.label,default:!0}),permaMuteList:new U({key:"permaMuteList",label:W.preferences.mutelist.label,default:[]}),showGender:new P({key:"showGender",label:W.preferences.showGender.label,default:!0}),trackKarma:new P({key:"trackKarma",label:W.preferences.trackKarma.label,default:!0}),notifyUpdates:new P({key:"notifyUpdates",label:W.preferences.notifyUpdates.label,default:!0}),hideTyping:new P({key:"hideTyping",label:W.preferences.hideTyping.label,default:!1}),hideFromGc:new P({key:"hideFromGc",label:W.preferences.hideFromGc.label,default:!1}),blockedHashes:new U({key:"blockedHashes",label:"blockedHashes",default:[]}),savedPictures:new U({key:"savedPictures",label:"savedPictures",default:[]}),userSort:new O({key:"userSort",label:W.preferences.userSort.label,default:"name.asc",multiline:!1}),blockReqs:new j({key:"blockReqs",label:W.preferences.blockReqs.label,default:0,options:[{value:Y.None,label:"Off"},{value:Y.Hide,label:"Hide"},{value:Y.Reject,label:"Reject"}]}),highlightMentions:new P({key:"highlightMentions",label:W.preferences.highlightMentions.label,default:!0}),altpfpBackground:new O({key:"altpfpBackground",label:W.preferences.altpfpBackground.label,default:"#fff",multiline:!1}),bigEmoji:new P({key:"bigEmoji",label:W.preferences.bigEmoji.label,default:!0}),toggleEmbeds:new P({key:"toggleEmbeds",label:W.preferences.toggleEmbeds.label,default:!0}),largerText:new P({key:"largerText",label:W.preferences.largerText.label,default:!1}),imgurLastUploadTimes:new U({key:"imgurLastUploadTimes",label:"imgurLastUploadTimes",default:[]}),imgurPfpAlbum:new U({key:"imgurPfpAlbum",label:"imgurPfpAlbum",default:[]}),hideImageFallback:new P({key:"hideImageFallback",label:W.preferences.hideImageFallback.label,default:!1}),imgurDeleteHashes:new U({key:"imgurDeleteHashes",label:"imgurDeleteHashes",default:[]}),picModHashes:new U({key:"picModHashes",label:"picModHashes",default:[]}),nameModRecords:new U({key:"nameModRecords",label:"nameModRecords",default:[]}),ignoreURLBlacklist:new P({key:"ignoreURLBlacklist",label:W.preferences.ignoreURLBlacklist.label,default:!1}),imgurAPIKey:new O({key:"imgurAPIKey",label:W.preferences.imgurAPIKey.label,default:"",multiline:!1}),muteRegexes:new U({key:"muteRegexes",label:W.preferences.muteRegexes.label,default:[]}),showAnimatedImages:new P({key:"showAnimatedImages",label:W.preferences.showAnimatedImages.label,default:!0}),introductionCompletedVersion:new L({key:"introductionCompletedVersion",label:"introductionCompletedVersion",default:0})},tt=Object.assign(Object.assign({},Z),X),et=new class{constructor(t,e,n=K){this.localStoragePrefix=e,this.responseHandler=n,this.cache=new Map;const i=[],r=function t(e){return Object.values(e).reduce((e,n)=>e.concat(_(D)(n)?n:t(n.vt)),[])}(t);r.forEach(t=>{const e=t.key;if(i.includes(e))throw new Error(`Duplicate preference key ${R(e)}.`);this.cache.set(t,t.default),i.push(e)}),r.forEach(t=>{t.dependencies.forEach(e=>{if(void 0===this.cache.get(e.preference))throw new Error(`Dependency error in ${t}: ${Q(e.preference)}`)})})}get(t){return this.getWith(this.responseHandler,t)}set(t,e){this.setWith(this.responseHandler,t,e)}getWith(t,e){return t({action:"get",preference:e,response:this.getRaw(e)},this).value}setWith(t,e,n){t({action:"set",preference:e,response:this.setRaw(e,n)},this)}reset(t){var e;this.getFromCacheOrThrowIfUnknown(t),e=this.localStoragePrefix+t.key,q(B,e)}resetAll(){for(const t of this.cache.keys())this.reset(t)}shouldBeAvailable(t){return t.dependencies.every(t=>t.condition(this.getRaw(t.preference).value))}getRaw(t){const e=this.getFromCacheOrThrowIfUnknown(t),n=(i=this.localStoragePrefix+t.key,r=t.default,G(B,i,r));var i,r;if("OK"===n.status){const e=n.value;return M(t.validate(e))?{status:1,value:t.toValid(e),saved:e}:{status:0,value:e}}return{status:J(n.status),value:e}}setRaw(t,e){if(this.getFromCacheOrThrowIfUnknown(t),M(t.validate(e)))return{status:1,value:e};this.cache.set(t,e);const n=function(t,e){return z(B,t,e)}(this.localStoragePrefix+t.key,e);return{status:J(n.status),value:n.value}}getFromCacheOrThrowIfUnknown(t){const e=this.cache.get(t);if(void 0===e)throw new Error(Q(t));return e}}(tt,o+"-preference-",r.loggingResponseHandler);var nt=n(16),it=n.n(nt),rt=n(0),ot=n.n(rt);const{max:st,min:at}=Math,ct=(t,e={})=>Object.assign(document.createElement(t),e),ut=[];function lt(t){ut.push(t),Promise.resolve().then(()=>{if(!ut.length)return;const t=ut.join("\n");ut.length=0,document.head.append(ct("style",{type:"text/css",textContent:t}))})}function ht(t,e,n,i=!1){const r=t[e];t[e]=function(...t){const e=i&&n.apply(this,t);let o=null;return i&&!1===e||(o=r.apply(this,t)),i||n.apply(this,t),o}}let ft;function dt(t){clearTimeout(ft),Promise.resolve().then(()=>null===RoomClient||void 0===RoomClient?void 0:RoomClient.print_append(ot.a.createElement("div",null,t)))}function mt(t){dt(t),document.body.classList.add("tmp-message"),ft=+setTimeout(()=>{null===RoomClient||void 0===RoomClient||RoomClient.print_append(),document.body.classList.remove("tmp-message")},5e3)}const pt=(t=0)=>new Promise(e=>setTimeout(e,t));var gt;function bt(t){return(e,n)=>t(n,e)}!function(t){t.string=(t,e)=>t.localeCompare(e),t.numeric=(t,e)=>t-e}(gt||(gt={}));function vt(t,e,n,i,r=!1){return function(t,e,n,i=!1){const r=i?t:Array.from(t),o="asc"===n?e:bt(e);return r.sort(o),r}(t,(o=e,s=n,(t,e)=>s(t[o],e[o])),i,r);var o,s}const wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",yt=Array.from({length:65},(t,e)=>String.fromCodePoint(e+917536)).join("");function kt(t){const e=btoa(t);let n="";for(let t=0;t<e.length;t+=1){const i=wt.indexOf(e[t]);if(-1===i)return null;n+=yt[2*i]+yt[2*i+1]}return n}function xt(t){return null==t?[]:t.filter(t=>null!=t)}function Ct(t){return+new Date-+new Date(t)}function At(t,e,n){let i=!1;return t.flatMap(t=>{i=!i;const r=i?e(t):n(t);return null===r?[]:r instanceof Array?r:[r]})}function Rt(t,e,n){if(0===e.length)return[t];const i=e.flatMap(t=>{if("number"==typeof t){if(void 0===n)throw new Error("Length must not be undefined if matches is of type number[]");return[t,t+n]}const[e,i]=t;return[e,e+i]});i.push(void 0);return i.map((e,n,{[n-1]:i})=>t.slice(null!=i?i:0,e))}function Et(t,e,n,i){const r=Array.from(t.matchAll(e)).map(t=>{if(void 0===t.index)throw new Error("So TypeScript really was right about match.index");return[t.index,t[0].length]});return At(Rt(t,r),i,n)}function Mt(t,e,n,i,r=!1){const o=function(t,e,n=!1){let i=n?t:t.toLowerCase();const r=n?e:e.toLowerCase(),o=[];let s=0;for(;i.length>0;){if(s=i.indexOf(r),-1===s)return o;o.push(s+t.length-i.length),i=i.slice(s+Math.max(r.length,1))}return o}(t,e,r);return At(Rt(t,o,Math.max(e.length,1)),i,n)}function Nt(t){const e=Math.abs(t)>=1e3?(t/1e3).toPrecision(3)+"K":""+t;return t>=0?"+"+e:""+e}const St=t=>t?t.replace(/[\u061C\u200E-\u200F\u202A-\u202E\u2066-\u2069]/g,""):t;function Tt(t,e=""){const n=t.split(e).sort(),i=n.length;return n.filter((t,e,n)=>t!==n[e-1]).map(t=>n.reduce((e,n)=>n===t?e+1:e,0)).map(t=>t/i).reduce((t,e)=>t+-e*Math.log2(e),0)}function _t(t){const e=(t+t).indexOf(t,1);return e>-1&&e!==t.length?t.length/e:0}const It={allowSpace:!1,otherKeysPreventDefault:!1,otherKeysStopPropagation:!1};function Dt(t,{allowSpace:e,otherKeysStopPropagation:n,otherKeysPreventDefault:i}=It){return{onClick:t,onKeyUp:r=>{"Enter"===r.key||e&&""===r.key?t(r):(n&&r.stopPropagation(),i&&r.preventDefault())}}}function Ot(...t){if(0===t.length)throw new Error("Must supply at least one RegExp");const e=t[t.length-1],n="string"==typeof e,i=t.slice(0,n?-1:0),r="string"==typeof e?e:e.flags;return new RegExp(i.map(t=>"string"==typeof t?t:t.source).join(""),r)}Error;function $t(t){if("number"!=typeof t)return t}function Pt(t){return null===t?NaN:"number"==typeof t?t:t.id}function Ut(t){return Array.isArray(t)?t:[t]}var jt=n(17),Ft=n.n(jt);const Lt=["captcha","youtube","about:blank","open.spotify.com","i.redd.it","ibb.co","challenges.cloudflare.com"];function Vt(){if(!et.get(Z.adBlocker))return;Array.from(document.querySelectorAll("iframe")).forEach(t=>{const{src:e}=t;e&&!Lt.some(t=>e.includes(t))&&t.remove()})}n(18);function Bt(t){const e=t instanceof Array?t.join(""):t;return{message:e,uppercase:e.split("").filter(t=>t.toLowerCase()!==t),entropySplit:Tt(e,/\s+/),entropy:Tt(e),repeating:_t(e),noLowerCase:e.toUpperCase()===e}}function Gt(t){var e,n,i;const r=null===(e=$t(t))||void 0===e?void 0:e.created_at;return{accountCreated:r?new Date(r):new Date,id:Pt(t),displayName:null!==(i=null===(n=$t(t))||void 0===n?void 0:n.display_name)&&void 0!==i?i:""}}var zt,qt;(qt=zt||(zt={})).legacy=function(t,{messages:e}){const n=Date.now(),{message:i,uppercase:r}=Bt(e);t.scoreLegacy+=(1e3/(Ct(t.lastMessageTime)||n))**.2,t.scoreLegacy/=Math.max(1/Math.E,Math.E-Math.log(10+i.length+r.length)/4)},qt.strikeBased=function(t,e){const{max:n,log10:i}=Math,r=Date.now(),{accountCreated:o}=Gt(e.user),{message:s,entropySplit:a,noLowerCase:c,repeating:u}=Bt(e.messages),l=r-t.lastMessageTime||1500;if(l<=1e3?t.scoreStrikes+=1:l>2e3&&(t.scoreStrikes=n(0,t.scoreStrikes-i(l))),Ct(o)<6e5){const e=s.length>200;(a<2||u>3)&&e&&(t.scoreStrikes+=1),t.scoreStrikes*=c?3:2}},qt.experimental=function(t,e){const{max:n,abs:i}=Math,{accountCreated:r}=Gt(e.user),o=Bt(e.messages),{entropy:s,uppercase:a}=o,c=o.message.trim(),{length:u}=c,l=u?u**-.2:1,h=u?u/n(a.length+u-3,u):1,f=.75*(Ct(r||new Date)/864e5)**.1,d=s*h*l*f,m=(d+function(t){const{message:e}=Bt(t),n=e.toLowerCase(),r=Tt(n)-Tt(n+c);return i(r)}(t.lastMessage)*d)/2,p=n(Ct(t.lastMessageTime||r||new Date),500);t.scoreExperimental/=p/2e3,t.scoreExperimental+=1-m,t.scoreExperimental=n(0,t.scoreExperimental)};const Ht=[19364487,19422865,11427049,16008266,21550262,21541886,14267520],Kt={},Qt={};function Jt(t){var e;const{messages:n,user:i}=t;if(void 0===n)return;const r=Pt(i),o=Date.now();Kt[r]=null!==(e=Kt[r])&&void 0!==e?e:{scoreLegacy:1,scoreStrikes:0,scoreExperimental:1,lastMessageTime:0,lastMessage:""};const s=Kt[r];zt.legacy(s,t),zt.strikeBased(s,t),zt.experimental(s,t),s.lastMessageTime=o,s.lastMessage=n.join(""),function(t,e){const{id:n,displayName:i}=Gt(e),{room:r}=App,o=t.scoreStrikes,s=Ht.includes(n),a=r.muted.includes(n),c=!s&&o>=3&&!a&&et.get(Z.antiSpam),u=o<1&&a&&Qt[n];if(c){if(n===App.user.id)return mt("AutoMute: You would have gotten muted"),void console.log("User would be muted here");Qt[n]=!0,r.mute(n,i,"spam"),mt(`AutoMute: Muted user ${i}.`)}u&&(delete Qt[n],r.unmute(n),mt(`AutoMute: Unmuted user ${i}.`))}(s,i)}function Wt(t){const e=Pt(t);delete Kt[e]}function Xt(t){if(null==(null===RoomClient||void 0===RoomClient?void 0:RoomClient.state.id)||"private"===(null===RoomClient||void 0===RoomClient?void 0:RoomClient.state.mode))return;const{user:e}=t;"number"!=typeof e&&(e.display_name=St(e.display_name)),function({user:t,user_disconnected:e}){if(!("state"in RoomChannelMembersClient)||"number"==typeof t)return;if(e)return void mt(`User ${t.display_name} left the chat.`);const n=Pt(t),{members:i}=RoomChannelMembersClient.state;i.map(Pt).includes(n)||mt(`User ${t.display_name} joined the chat.`),RoomChannelMembersClient.add_member(t)}(t),Jt(t)}var Yt=n(19),Zt=n.n(Yt);function te(){["room-component-message-picture","message-image","navigation-notification-unit-image"].forEach(t=>{document.querySelectorAll("."+t).forEach(t=>{t.src.includes("robohash")||t.classList.contains("ritsu-would-blur")||t.classList.add("ritsu-would-blur")})})}const ee=t=>`\n\t  ${JSON.stringify(t)} (U+${t.charCodeAt(0).toString(16).padStart(4,"0").toUpperCase()})`;function ne(t){return t.replace(/(\S)\.([a-z][a-z])/gi,"$1%2E$2").replace(/https?:\/\//gi,"")}const ie=t=>t.replace(/%2E/gi,".").replace(/\s?\(\s?(\.|dot)\s?\)\s?/g,".").replace(/\.\u200b/g,"."),re=Ot("(?:",["%2E","dot",/\./.source,/ ?\( ?(?:\.|dot) ?\) ?/.source].join("|"),")","").source,oe=/(https?:\/\/)?/.source,se=/[-a-z0-9@:%_+[\]~#?&=]/.source,ae=()=>Ot(...[/\bi\.ibb\.co\/[a-z0-9]+\/[^\s.]+\.[a-z0-9]+\b/gi,/\bi\.redd\.it\/[a-z0-9]+\.[a-z0-9]+\b/gi,/\bi\.imgur\.com\/[a-z0-9]+\.[a-z0-9]+\b/gi].map(t=>`(${t.source})`).join("|"),"gi"),ce={},ue="https://emeraldchat.com/avicons_strict/1.png";var le;function he(t){t.onerror||(t.onerror=async()=>{switch(function(t){return(t=>t.classList.contains("message-image"))(t)?le.NoFallbackAvailable:t.src.startsWith("data:image")?le.AviconFallback:t.src.includes("/avicons_strict/")||(t=>t.includes("emeraldchat.com/"))(t.src)?le.NoFallbackAvailable:le.RobohashFallback}(t)){case le.RobohashFallback:t.src=`https://robohash.org/yay${t.src}.png?set=set4`;break;case le.AviconFallback:t.src=ue}})}function fe(t,e){return!0===ce[t.src]?(e&&(t.src=e),!1):!1===ce[t.src]&&(t.src=ue,!0)}function de(t){if(t.classList.contains("zoomIn"))return;if(!ae().test(t.src))return;const{src:e}=t;fe(t)||async function(t){const e=await fetch(t),n=await e.arrayBuffer(),i=new Uint8Array(n.slice(0,4)),r=Array.from(i).map(t=>t.toString(16)).join("");if(r.startsWith("424d"))return"image/bmp";switch(r){case"89504e47":return"image/png";case"47494638":return"image/gif";case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":return"image/jpeg";case"25504446":return"application/pdf";default:return}}(e).then(n=>{ce[e]="image/gif"!==n,fe(t,e)})}function me(){Array.from(document.images).forEach(t=>{var e;he(t),t.complete&&0===t.naturalHeight&&(null===(e=t.onerror)||void 0===e||e.call(t,"")),et.get(Z.showAnimatedImages)||de(t)})}function pe(){var t,e;if(!et.get(Z.fancyColors))return;const n=document.querySelector('label.ui-select[for="flair-select"]');if(!n||"flair-select"!==(null===(t=n.firstElementChild)||void 0===t?void 0:t.id))return;n.htmlFor="flair-select-old";const i=new Event("change",{bubbles:!0}),r=n.cloneNode();r.classList.add("disable-after"),n.firstElementChild.id="flair-select-old",n.style.display="none";const o=ct("input",{id:"flair-select",className:"alt-flair-select",value:App.user.flair.color}),s=ct("input",{id:"flair-select",type:"color",className:"picker-flair-select",value:App.user.flair.color,oninput:()=>{var t;o.value=s.value,null===(t=n.firstChild)||void 0===t||t.dispatchEvent(i)}});r.append(o,s),null===(e=n.parentElement)||void 0===e||e.insertBefore(r,n.nextSibling),o.oninput=()=>{var t;s.value=o.value,null===(t=n.firstChild)||void 0===t||t.dispatchEvent(i)}}!function(t){t[t.RobohashFallback=0]="RobohashFallback",t[t.AviconFallback=1]="AviconFallback",t[t.NoFallbackAvailable=2]="NoFallbackAvailable"}(le||(le={}));var ge=n(20),be=n.n(ge);function ve(t){var e;let n,i=t.apply(this);if(!this.props.data)return i;if((null===(e=this.props.data.data)||void 0===e?void 0:e.sender)&&(n=this.props.data.data.sender.gender),this.props.data.gender&&(n=this.props.data.gender),i.props.children){const{children:t}=i.props;t[0].props["data-gender"]=n;const e=i.props;e.children=t,i=ot.a.cloneElement(i,e)}return i=ot.a.cloneElement(i,{"data-gender":n}),i}var we=n(21),ye=n.n(we);function ke(t){const{isSelected:e,onClick:n}=t,i=ot.a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",style:{fill:"#fff"}},ot.a.createElement("path",{d:"M6 11.776l-3.88-3.888-1.12 1.152 5 5 10-10-1.12-1.152-8.88 8.888z"}));return ot.a.createElement("button",{className:`checkmark-button${e?" selected":""} `,onClick:n,type:"button"},e&&i)}function xe(t,e){return t>=2&&e>=2?"conflicted":t>=2?"approve":e>=2?"reject":"standby"}async function Ce(t){const e=await fetch("/profile_json?id="+t);return await e.json()}function Ae(t){const e=document.querySelector(".notification-count-overlay");e&&(e.textContent=String(t)),e.style.display=t>0?"inline":"none"}function Re(t,e){const n=et.get(Z.picModHashes),i=n.find(e=>e.hash===t);if(i)"approve"===e?i.approvals+=1:"reject"===e&&(i.rejections+=1),et.set(Z.picModHashes,n);else{const i={hash:t,approvals:"approve"===e?1:0,rejections:"reject"===e?1:0},r=[...n,i];et.set(Z.picModHashes,r)}}async function Ee(t,e,n){const i=et.get(Z.picModHashes);(await Promise.allSettled(t.map(async({id:t,image_url:e})=>{try{const i=await async function(t){return(await fetch(t)).blob()}(e),r=await new Promise((t,e)=>{const n=new FileReader;n.readAsDataURL(i),n.onload=()=>t(n.result),n.onerror=t=>e(t)});return{id:t,imageHash:await(n=i,new Promise((t,e)=>{const i=new FileReader;i.readAsDataURL(n),i.onload=()=>{const e=i.result,n=it()(e);t(n)},i.onerror=t=>{e(t)}})),base64Image:r}}catch(e){return console.error(`Error hashing image ${t}: ${e}`),{id:t,error:e}}var n})).then(t=>t.filter(({status:t})=>"fulfilled"===t).map(({value:t})=>t))).forEach(({id:e,imageHash:n,base64Image:i})=>{const r=t.find(({id:t})=>t===e);r&&(r.imageHash=n,r.base64Image=i)});const r=t.filter(({imageHash:t})=>i.some(({hash:e})=>e===t)).map(({id:t,imageHash:e})=>{const{approvals:n=0,rejections:r=0}=i.find(({hash:t})=>t===e)||{};return{id:t,action:xe(n,r),hash:e}}),o=[],s=[],a=[];r.forEach(({id:t,action:e,hash:n})=>{n&&("conflicted"===e?o.push(n):"approve"===e?(s.push(t),Re(n,"approve")):"reject"===e&&(a.push(t),Re(n,"reject")))}),s.forEach(t=>e(t)),a.forEach(t=>n(t)),function(t){const e=et.get(Z.picModHashes).filter(e=>!t.includes(e.hash));et.set(Z.picModHashes,e)}(o);return t.filter(t=>!s.includes(t.id)&&!a.includes(t.id)&&!o.includes(t.imageHash?t.imageHash:""))}function Me(){et.set(Z.picModHashes,[]),alert("Image cache for picture moderation has been cleared")}function Ne(t){const e=document.querySelector(".name-count-overlay");e&&(e.textContent=String(t)),e.style.display=t>0?"inline":"none"}function Se(t,e){const n=et.get(Z.nameModRecords),i=n.find(e=>e.name===t);if(i)"approve"===e?i.approvals+=1:"reject"===e&&(i.rejections+=1),et.set(Z.nameModRecords,n);else{const i={name:t,approvals:"approve"===e?1:0,rejections:"reject"===e?1:0},r=[...n,i];et.set(Z.nameModRecords,r)}}async function Te(t,e,n){const i=et.get(Z.nameModRecords),r=t.filter(({new_display_name:t})=>i.some(({name:e})=>e===t)).map(({id:t,new_display_name:e})=>{const{approvals:n=0,rejections:r=0}=i.find(({name:t})=>t===e)||{};return{id:t,action:xe(n,r),name:e}}),o=[],s=[],a=[];r.forEach(({id:t,action:e,name:n})=>{n&&("conflicted"===e?o.push(n):"approve"===e?(s.push(t),Se(n,"approve")):"reject"===e&&(a.push(t),Se(n,"reject")))}),s.forEach(t=>e(t)),a.forEach(t=>n(t)),function(t){const e=et.get(Z.nameModRecords).filter(e=>!t.includes(e.name));et.set(Z.nameModRecords,e)}(o);return t.filter(t=>!s.includes(t.id)&&!a.includes(t.id)&&!o.includes(t.new_display_name))}function _e(){et.set(Z.nameModRecords,[]),alert("Cache for display name moderation has been cleared")}function Ie(t){$.ajax({type:"POST",url:`/picture_moderations/${t}/approve`,dataType:"json"})}function De(t){$.ajax({type:"DELETE",url:"/picture_moderations/"+t,dataType:"json"})}function Oe(t){$.ajax({type:"POST",url:`/display_name_moderations/${t}/approve`,dataType:"json"})}function $e(t){$.ajax({type:"DELETE",url:"/display_name_moderations/"+t,dataType:"json"})}function Pe(){const t=document.querySelector(".navigation-notification-icons"),e=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);if(null==t?void 0:t.children){if(document.fullscreenEnabled&&!t.querySelector(".ritsu-button-fullscreen")&&!e){const e=ct("span",{className:"material-icons navigation-notification-unit ritsu-button-fullscreen",textContent:"open_in_full",tabIndex:-1,role:"button",onmousedown:async()=>{document.fullscreenElement?(document.exitFullscreen(),e.textContent="open_in_full"):(await document.body.requestFullscreen(),e.textContent="close_fullscreen")}}),n=ct("span");n.append(e),t.prepend(n)}if(!t.querySelector(".ritsu-icon-network-unavail")){const e="Emerald is not responding - switching chats is not recommended.",n=ct("span",{className:"material-icons navigation-notification-unit ritsu-icon-network-unavail",textContent:"signal_cellular_alt",tabIndex:-1,role:"button",title:e,onmousedown:()=>alert(e)}),i=ct("span");i.append(n),t.prepend(i)}if(!t.querySelector(".ritsu-icon-pic-mod")&&App.user.mod){const e=ct("span",{className:"notification-count-overlay",textContent:0,style:"display: none;"}),n=ct("span",{className:"material-icons navigation-notification-unit ritsu-icon-pic-mod",textContent:"account_box",tabIndex:-1,role:"button",title:"Picture Moderation",onmousedown:()=>ActionTray.prototype.pictureModeration()}),i=ct("span");i.append(n),i.append(e),t.prepend(i)}if(!t.querySelector(".ritsu-icon-name-mod")&&App.user.mod){const e=ct("span",{className:"name-count-overlay",textContent:0,style:"display: none;"}),n=ct("span",{className:"material-icons navigation-notification-unit ritsu-icon-name-mod",textContent:"badge",tabIndex:-1,role:"button",title:"Display Name Moderation",onmousedown:()=>ActionTray.prototype.display_nameModeration()}),i=ct("span");i.append(n),i.append(e),t.prepend(i)}document.body.classList.contains("watchers_started")||(n(),i(),document.body.classList.add("watchers_started"),setInterval(n,15e3),setInterval(i,15e3))}async function n(){if(document.body.classList.contains("picModMounted"))return;Ae(await async function(){if(!App.user.mod)return 0;const t=await fetch("/picture_moderations");if(403===t.status)return 0;const e=await t.json(),n=await Ee(e,Ie,De);return n.length?n.length:0}())}async function i(){if(document.body.classList.contains("picModMounted"))return;Ne(await async function(){if(!App.user.mod)return 0;const t=await fetch("/display_name_moderations");if(403===t.status)return 0;const e=await t.json(),n=await Te(e,Oe,$e);return n.length?n.length:0}())}}function Ue(){const t=document.querySelector(".main-logo");t&&(Pe(),function(t){const e=App.user.display_picture;t instanceof HTMLImageElement&&t.src!==e&&(t.src=e)}(t),function(){if(document.head.querySelector(`link[rel="icon"][href="${u}"]`))return;document.head.querySelectorAll('link[rel="icon"]').forEach(t=>t.remove());const t=ct("link",{rel:"icon",href:u});document.head.prepend(t)}(),function(t){var e;if(document.querySelector(".karma-tracker"))return;const n=ct("div",{className:"karma-tracker"});null===(e=null==t?void 0:t.parentElement)||void 0===e||e.insertBefore(n,null==t?void 0:t.nextSibling)}(t),function(t){const e=`${App.user.display_name||"(...)"} - ${a} ${c}`;document.title!==e&&(document.title=e);const n=document.querySelector(".main-logo-text");if(!n){const n=ct("div",{className:"main-logo-text",textContent:e});t.parentElement&&t.parentElement.insertBefore(n,t.nextSibling)}n&&n.textContent!==e&&(n.textContent=e)}(t))}var je=n(22),Fe=n.n(je);let Le=null;function Ve(t){500===t.status&&(App.room&&App.room.leave(App.room.id),x.location.href="/")}function Be(t){const e=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);if(t===Le)return;null!==Le&&function(t){const e=ct("div",{className:"karma-delta "+(t>0?"positive":"negative"),textContent:Nt(t)});document.body.append(e),setTimeout(()=>e.classList.add("zoom"),250),setTimeout(()=>e.remove(),5e3)}(t-Le),Le=t;const n=document.querySelector(".karma-tracker");n&&(e||(n.textContent=t?"Karma: "+t:""))}function Ge(){const{id:t}=App.user;t?$.ajax({type:"GET",url:"/profile_json?id="+t,dataType:"json",success:t=>Be(t.user.karma),error:t=>Ve(t)}):setTimeout(Ge,500)}function ze(){const t=RoomChannelMembers.prototype.setState;RoomChannelMembers.prototype.setState=function(e){e&&"members"in e&&function(t,e){const n=xt(t);xt(e).forEach(t=>{!function(t,e){e.delta=t?e.karma-t.karma:0}(n.find(({id:e})=>e===t.id),t)})}(this.state.members,e.members),t.call(this,e)};const e=UserUnit.prototype.body;UserUnit.prototype.body=function(){const t=e.call(this),n=this.props.data;return n.delta<0&&(t.props.className+=" down"),n.delta>0&&(t.props.className+=" up"),t}}function qe(t){var e,n,i;if(!(null===(i=null===(n=null===(e=App.room)||void 0===e?void 0:e.id)||void 0===n?void 0:n.startsWith)||void 0===i?void 0:i.call(n,"channel")))return!1;if(!(RoomChannelMembersClient instanceof ot.a.Component))return!1;const r=+App.room.id.slice(7),o=t.find(({channel:t})=>t.id===r);if(!o)return!1;const s=xt(RoomChannelMembersClient.state.members);xt(o.members).forEach(t=>{const e=s.findIndex(({id:e})=>e===t.id);e>-1?s[e]=t:s.push(t)});const a=function(t){const e=RoomChannelMembersClient.state.members_persistent||[],n=t.filter(t=>!e.find(e=>(null==e?void 0:e.id)===t.id)),i=[...e,...n];return i.length>100&&i.splice(0,i.length-100),i}(s);RoomChannelMembersClient.setState({members:s,members_persistent:a});const c=o.members.find(t=>(null==t?void 0:t.id)===App.user.id);return!!c&&(Be(c.karma),!0)}function He(t){const e=(n=t.text_channels,RoomChannelSelectClient.state.text_channels.map(t=>{const e=n.find(({channel:e})=>e.id===t.channel.id);if(!e)return t;const{members:i}=e;return Object.assign(Object.assign({},t),{members:i})}));var n;RoomChannelSelectClient.setState({text_channels:e});qe(e)||Ge()}function Ke(){const{id:t}=App.user;t?(setTimeout(Ke,6e4),RoomChannelMembersClient instanceof ot.a.Component&&$.ajax({type:"GET",url:"channels_default",dataType:"json",success:He,error:Ve})):setTimeout(Ke,500)}const Qe=/^(?:spotify:|https:\/\/[a-z]+\.spotify\.com\/(track\/|user\/(.*)\/|playlist\/))([a-zA-Z0-9]+)(.*)$/,Je=/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube(-nocookie)?\.com|youtu.be))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/,We=t=>Je.test(t),Xe=t=>Qe.test(t),Ye=t=>{const e=Je.exec(t);return e?e[6]:null},Ze=t=>{const e=Qe.exec(t);return e?e[1]+e[3]:null};function tn(t){return We(t)&&Ye(t)?(t=>`<div class="ritsu-youtube-embed embed"> <iframe class="embed-responsive-item" \n  loading="lazy"\n  src="https://www.youtube.com/embed/${Ye(t)}"\n  frameborder="0" allowfullscreen></iframe></div>`)(t):Xe(t)&&Ze(t)?((t,e)=>`<div class="ritsu-spotify-embed spotify embed"><iframe \n  src="https://open.spotify.com/embed/${Ze(t)}?utm_source=generator"\n  loading="lazy"\n  height="${e} !important" frameBorder="0" allowfullscreen="" \n  allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture">\n  </iframe></div>`)(t,(t=>t.includes("playlist")?380:80)(t)):null}var en,nn=n(23),rn=n.n(nn),on=n(24),sn=n.n(on);function an(t){return We(t)||Xe(t)}function cn(t){const e=et.get(Z.toggleEmbeds),n=document.querySelectorAll("."+t);e&&n&&n.forEach(t=>{const e=Array.from(t.children);e&&e.forEach(t=>{if(t.querySelectorAll(".embed").length)return;const e=ie(t.innerText);if(!We(e)&&!Xe(e))return;const n=document.createElement("div");n.classList.add("embed"),n.innerHTML="<br>"+tn(e),t.appendChild(n)})})}function un(){cn("user-comment-right"),cn("user-micropost-right"),cn("room-component-message-text")}!function(t){t[t.Created=0]="Created",t[t.Alive=1]="Alive",t[t.Destroyed=2]="Destroyed"}(en||(en={}));const ln=new Map;class hn{constructor(t,e=!1){this.state=en.Created,this.preference=t,e&&this.load()}assertAlive(){if(this.state===en.Destroyed)throw new Error("Attempted to use destroyed ListPreferenceCache object");if(this.state===en.Created)throw new Error("Attempted to use uninitialized ListPreferenceCache object")}get store(){return this.assertAlive(),this.realStore}set store(t){this.assertAlive(),this.realStore=t}destroy(){this.assertAlive(),this.state=en.Destroyed,this.preference&&ln.delete(this.preference.key)}load(){const{preference:t}=this;if(ln.has(t.key)&&ln.get(t.key)!==this)throw new Error(hn.ERR_PREF_IN_USE);ln.set(t.key,this),this.state=en.Alive,this.loadFrom(et.get(this.preference))}save(){et.set(this.preference,this.asSaved())}}hn.ERR_PREF_IN_USE="Cannot create multiple ListPreferenceCache instances     linked to the same preference. Hint: .destroy() the previous instance";class fn extends hn{setItem(t,e){this._setItem(t,e),this.save()}addItem(t,e){this.setItem(t,e)}removeItem(t){const e=this._removeItem(t);return this.save(),e}}class dn extends hn{add(t){this._add(t),this.save()}remove(t){const e=this._remove(t);return this.save(),e}}class mn extends dn{hasItem(t){return this.store.has(t)}hasKey(t){return!1}values(){return[...this.store.values()]}entries(){return this.values()}_add(t){this.store.add(t)}_remove(t){return this.store.delete(t)}asSaved(){return this.values()}loadFrom(t){this.store=new Set(t)}}class pn extends fn{hasKey(t){return this.store.has(t)}hasItem(t){return this.values().some(e=>e===t)}getItem(t){return this.store.get(t)}_removeItem(t){return this.store.delete(t)}_setItem(t,e){return this.store.set(t,e)}values(){return[...this.store.values()]}entries(){return[...this.store.entries()]}asSaved(){return[...this.store.entries()]}loadFrom(t){this.store=new Map(t)}static just(t,e){const n=new pn(e,!0);t(n),n.destroy()}static addItem({key:t,item:e},n){return pn.just(n=>n.addItem(t,e),n)}static removeItem({key:t},e){return pn.just(e=>e.removeItem(t),e)}}const gn=()=>et.get(Z.imgurLastUploadTimes),bn=()=>gn().filter(t=>Ct(new Date(t))<=108e5),vn=()=>bn().length<50;function wn(){var t;t=[...gn(),+new Date].slice(-50),et.set(Z.imgurLastUploadTimes,t)}const yn=`You can upload 50 new images per ${$.timeago(+new Date-108e5)}.`,kn=()=>et.get(Z.hideImageFallback),xn="https://api.imgur.com/3/image/",Cn=kt("rxe-imgur:"),An=()=>new RegExp(`imgur${re}com/([a-z0-9]+)`,"i"),Rn=t=>`https://i.imgur.com/${t}.png`,En=()=>({Authorization:"Client-ID "+(et.get(Z.imgurAPIKey)||"b8f69bdcc4d1373")});function Mn({id:t,payload:e}){return{url:Rn(t),payload:e,version:"0.11.0"}}function Nn(t){return kn()?`${Cn}${kt(t)}`:ne(Rn(t))}async function Sn(t){return Mn(await async function(t){const e=new FormData;e.append("image",t);const n=await fetch(xn,{method:"POST",headers:En(),body:e});if(!n.ok)throw new Error(n.statusText);const{data:i}=await n.json(),{id:r,deletehash:o}=i;return pn.addItem({key:r,item:o},Z.imgurDeleteHashes),wn(),{id:r,payload:Nn(r)}}(t))}function Tn(t,e=!0){const n=t.match(An());return n&&Mn({payload:e?Nn(n[1]):ne(n[0]),id:n[1]})}function _n(t){var e;const n=Tn(t,!1);if(n)return n;const i=null===(e=t.match(new RegExp(Cn+"(\\S*)")))||void 0===e?void 0:e[1];if(void 0===i)return null;return Mn({id:function(t){let e="";for(let n=1;n<t.length;n+=2){const i=yt.indexOf(t[n]);if(-1===i)throw new Error("bad image path");e+=wt[(i-1)/2]}return atob(e)}(i),payload:i})}const In=["You are uploading your image to ",ot.a.createElement("a",{href:"https://imgurinc.com/privacy"},"Imgur"),". Anyone with the link can save or share it."],Dn="https://github.com/Ritsu-Projects/Public-Releases/",On="https://rentry.co/97eydt",$n=ne(Dn),Pn=(t,e)=>`${e}  ${kn()?"Can't see it":"See just a link"}? Get RxE ${t}+: ${$n}`;function Un(t){const e=/\w/.test(t.payload)?"Image: "+t.payload:`[Image${t.payload}]`;return Math.random()<.5?Pn(t.version,e):e}function jn({url:t}){return ot.a.createElement(MessagePicture,{picture:{url:t}})}function Fn({url:t},e=App.user){return{user:e,messages:[],picture:t}}function Ln(t){return _n(t)}async function Vn(t){return Sn(t)}const Bn={ratelimit:yn,destination:In,lowKarma:"Warning: Due to low karma, images sent by you may be hidden from other users."};function Gn(t){const e="channel"===this.state.mode?50:5e3,{messages:n}=this.state;t.forEach(t=>{0===t.messages.length&&t.messages.push(""),n.length>e&&n.shift();const i=n[n.length-1];if(i&&Pt(i.user)===Pt(t.user)&&!i.picture&&!t.picture&&i.messages.length<16){const e=i.messages,o=e[e.length-1];if(t.messages[0]===o)return;(We(r=o)||Xe(r))&&n.push(t),n[n.length-1].messages.push(t.messages[0])}else n.push(t);var r}),this.setState({messages:n})}const zn=t=>ot.a.createElement("b",{style:{color:"#f00"}}," ",t," ");function qn(t){const{user:e,karma:n,colour:i,textShadow:r,timeago:o}=t;return ot.a.createElement("span",{className:"user-extra"},ot.a.createElement("b",null,"(",n,")")," / ",ot.a.createElement("span",{style:{color:i,textShadow:r,whiteSpace:"nowrap"}},o),function(t){if(!t.proxy)return t.master?zn("MASTER"):t.mod?zn("MOD"):void 0}(e))}function Hn(t){const e=ie(t).replace("Image: ","");let n="text-only";return(an(e)||an("https://"+e)||_n(e))&&(n="embed"),ot.a.createElement("div",{className:n,key:JSON.stringify(t)},this.process(t))}function Kn(){lt(rn.a),Message.prototype.content=function(){var t,e,n;const{data:i}=this.props,{picture:r,messages:o,user:s}=this.props.data,a=i.isMine||Pt(s)===Pt(App.user),c=et.get(Z.imgProtect),u=function(t){return t?/^(data:image\/([a-zA-Z]*);base64,)|(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|gif|png)$/.test(t):t}(r),l=(null===(t=$t(s))||void 0===t?void 0:t.temp)||(null!==(n=null===(e=$t(s))||void 0===e?void 0:e.karma)&&void 0!==n?n:0)<10,h=!a&&l&&c;if(r){if(!u)return ot.a.createElement("div",{className:"blocked-image"},ot.a.createElement("div",{className:"warning-text"},"This image was blocked as it was deemed malicious"));const t=jn({url:r});return h?ot.a.createElement("div",{className:"image-wrap"},ot.a.createElement("a",{className:"image-warning",onClick:this.showImage.bind(this)},"click here to show image"),ot.a.createElement("div",{className:"hidden"},t)):t}return o.map(t=>Hn.call(this,t))},Message.prototype.render=function(){var t,e,n,i,r,o,s,a,c,u,l;this.props.data.user||console.warn("this.props.data.user may be falsy despite declaration");const h=null!==(t=function(t){if(!("state"in RoomChannelMembersClient))return;const{members:e,members_persistent:n}=RoomChannelMembersClient.state;return(e||n).find(e=>(null==e?void 0:e.id)===t)}(Pt(this.props.data.user))||$t(this.props.data.user))&&void 0!==t?t:null,f=Pt(this.props.data.user)===Pt(App.user);let d=!1;App.room.muted.includes(Pt(h))&&(d=!0);try{const t=et.get(Z.muteRegexes)[0];if(t&&(null==h?void 0:h.display_name)){const{source:e,flags:n}=t,i=new RegExp(e,n),r=["","(?:)"].includes(e);i.test(h.display_name)&&!r&&(d=!0)}}catch(t){}const m={string:(null===(e=null==h?void 0:h.display_name)||void 0===e?void 0:e.trim())||"(no name)",flair:null!==(n=null==h?void 0:h.flair)&&void 0!==n?n:{color:""}},p=Nt(null!==(r=null!==(i=null==h?void 0:h._karma)&&void 0!==i?i:null==h?void 0:h.karma)&&void 0!==r?r:0),g=et.get(Z.imgProtect),b=(null===(o=$t(h))||void 0===o?void 0:o.temp)||(null!==(a=null===(s=$t(h))||void 0===s?void 0:s.karma)&&void 0!==a?a:0)<10,v=h?function(t){const e=Math.log(+new Date-+new Date(t.created_at)+1);return Math.min(e/Math.log(5e11),1)}(h):0,w=(null==h?void 0:h.created_at)&&new Date(null==h?void 0:h.created_at),y=w&&!Number.isNaN(w.getTime())?$.timeago(w):null,k=`hsl(${256*v}, 50%, 50%)`,x=["room-component-message-text"],{picture:C}=this.props.data;C&&x.push("ritsu-would-blur-heavy"),d&&x.push("ritsu-message-hidden");const A=(null===(c=null==h?void 0:h.display_picture)||void 0===c?void 0:c.startsWith("https://robohash.org/"))||(null===(u=null==h?void 0:h.display_picture)||void 0===u?void 0:u.startsWith("https://emeraldchat.com/avicons_strict/"))||f,R=["room-component-message-avatar"];A||R.push("ritsu-would-blur");const E=!A&&(d||b&&g),M=h?ot.a.createElement(qn,{user:h,karma:p,timeago:y,color:k,textShadow:"0.005em 0.005em #FFF5"}):null,N=t=>h&&UserViewGenerator.generate({event:t,user:h}),S=ot.a.createElement("div",{className:"material-icons room-component-message-avatar ritsu-avatar-hidden",title:"User avatar hidden due to image settings",onMouseDown:N,role:"button",tabIndex:-1},"visibility_off"),T=ot.a.createElement("img",{className:R.join(" "),alt:"",src:null==h?void 0:h.display_picture,onMouseDown:N}),_=ot.a.createElement("div",{className:"room-component-flair",onMouseDown:N,role:"button",tabIndex:-1},ot.a.createElement(Flair,{data:m})),I=ot.a.createElement("div",{className:"room-component-report",onMouseDown:this.report_type.bind(this),role:"button",tabIndex:-1},ot.a.createElement("i",{className:"fa fa-warning fa-2x social"}));return ot.a.createElement("div",{className:"room-component-message-container","data-id":null==h?void 0:h.id},ot.a.createElement("div",{className:"room-component-message-left"},E?S:T),ot.a.createElement("div",{className:"room-component-message-right"},_,ot.a.createElement(Badge,{badge:null!==(l=null==h?void 0:h.badge)&&void 0!==l?l:null}),et.get(Z.showInfo)&&M,ot.a.createElement("div",{className:x.join(" ")},d?ot.a.createElement("i",null,"Blocked message"):this.content())),I)},Room.prototype.received=function(t){var e,n,i,r;Pt(t.user)!==App.user.id&&t.messages&&(App.room.play_sound("/sfx/simple_alert.wav"),this.append(t),PushNotifications.idle()&&PushNotifications.send(null!==(n=null===(e=$t(t.user))||void 0===e?void 0:e.display_name)&&void 0!==n?n:"",{icon:null!==(r=null===(i=$t(t.user))||void 0===i?void 0:i.display_picture)&&void 0!==r?r:"",body:t.messages[0]}))}}function Qn(){var t,e;const n=document.querySelectorAll(".room-component-message-container"),i=null===(t=null===RoomClient||void 0===RoomClient?void 0:RoomClient.state)||void 0===t?void 0:t.messages;if(null==i?void 0:i.length)for(let t=0;t<i.length;t+=1){const r=null===(e=n[t])||void 0===e?void 0:e.querySelector(".room-component-message-text");if(!r||r.classList.contains("ritsu-message-hidden"))continue;const{messages:o}=i[t],s=r.childNodes;if(s){for(;s&&s.length>o.length;)s[0].remove();if(!s||s[0]||!s[0].classList)return;et.get(Z.bigEmoji)&&1===o.length&&/^\p{Extended_Pictographic}{1,5}$/u.test(o[0])?s[0].classList.add("jumbo-message"):s[0].classList.remove("jumbo-message")}}}const Jn=(()=>{let t=0;return()=>"key-"+ ++t})();function Wn(){Room.prototype.room_messages=function(t="room-component-messages"){let e=null,n="",i=0;return this.state.messages.forEach(t=>{i+=t.messages.length}),this.state.messages_count>i&&this.state.messages.length>0&&(e=ot.a.createElement("div",{role:"button",tabIndex:0,onMouseDown:()=>this.load_messages(i),className:"room-component-load-button"},"Load More (",i," of ",this.state.messages_count,")")),"private"===this.state.mode&&this.state.messages.length<1&&(n=ot.a.createElement("div",{className:"room-notification"},"No messages here yet. Start a conversation!")),RoomChannelSelectClient.state&&"channel"===this.state.mode&&this.state.messages.length<1&&(n=ot.a.createElement("div",{className:"room-notification"},"No messages here yet!")),ot.a.createElement("div",{id:"messages",className:t},ot.a.createElement(MuteButton,null),this.state.print,n,e,this.state.messages.map(t=>(t.user=function(t){var e;const n=null===(e=null===RoomChannelMembersClient||void 0===RoomChannelMembersClient?void 0:RoomChannelMembersClient.state)||void 0===e?void 0:e.members_persistent;return n?(n.forEach(e=>{(null==e?void 0:e.id)===t.user.id&&(t.user=e)}),t.user):t.user}(t),t.key||(t.key=Jn()),ot.a.createElement(Message,{data:t,key:t.key}))),this.state.print_append)},Room.prototype.append=function(t){Gn.call(this,[t])}}function Xn(t,e){const n=Object.assign({success:async t=>t,error:async(t,e,n)=>{throw new Error(n)}},e);t.success=function(t,{success:e}){const n=xt(Ut(t.success)),i=xt(Ut(t.error));return(t,...r)=>{(async()=>{try{const i=await e(t,...r);n.forEach(t=>t(i,...r))}catch(t){const e=r[1],n=t instanceof Error?t.message:"";i.forEach(t=>t(e,"error",n))}})()}}(t,n),t.error=function(t,{error:e}){const n=xt(Ut(t.success)),i=xt(Ut(t.error));return(t,...r)=>{(async()=>{try{const i=await e(t,...r);n.forEach(e=>e(i,"success",t))}catch(e){e instanceof Error&&(r[1]=e.message),i.forEach(e=>e(t,...r))}})()}}(t,n)}const Yn=new EventTarget;let Zn=[];function ti(t){const e=new CustomEvent(t?"connected":"disconnected");Yn.dispatchEvent(e)}function ei(){(function(t,e,n="Timed out"){return Promise.race([t,pt(e).then(()=>Promise.reject(new Error(n)))])})(new Promise(t=>Zn.push(t)),5e3).catch(()=>{ti(!1)})}function ni(){Zn.forEach(t=>t()),Zn=[],ti(!0)}var ii;function ri(t,e){const{SendRequest:n,AbortRequest:i}=ii;return n}function oi(){const t=$.ajax;$.ajax=function(e,n){const i="string"==typeof e?Object.assign(Object.assign({},n),{url:e}):e;return void 0===(null==i?void 0:i.url)?t(i):ri(i.url)===ii.SendRequest?(function(t){ei(),Xn(t,{success:async t=>(ni(),t),async error(t,e,n){throw ni(),new Error(n)}})}(i),t(Object.assign({},i))):void 0},Yn.addEventListener("connected",()=>{document.documentElement.classList.remove("network-unavail")}),Yn.addEventListener("disconnected",()=>{document.documentElement.classList.add("network-unavail")})}!function(t){t[t.AbortRequest=0]="AbortRequest",t[t.SendRequest=1]="SendRequest"}(ii||(ii={}));var si=n(4),ai=n.n(si);var ci=n(25),ui=n.n(ci),li=n(11),hi={insert:"head",singleton:!1},fi=(ui()(li.a,hi),li.a.locals||{});function di(){return ot.a.createElement("div",{className:fi.ldsDualRing})}function mi(){this.setState({right_panel:!0,left_panel:!0,print:""})}function pi(t){App.room.join(this.props.data.id),Gn.call(this,t.messages),this.setState({messages_count:t.messages_count,id:this.props.data.id}),this.scroll()}function gi(){mi.call(this),$.ajax({type:"GET",url:"/default_private_messages?id="+this.props.data.id,dataType:"json",success:pi.bind(this)})}function bi(t){this.setState({print:ot.a.createElement(MatchMenu,{data:{queue:t}})})}function vi(){const t={match:"text",match_video:"video",match_voice:"voice",channel:"",private:""};function e(t){const{channel:e}=t;this.setState({current_channel:e}),"voice"===e.channel_type&&this.voice_connect(t),null===RoomClient||void 0===RoomClient||RoomClient.clear_messages(),$.ajax({type:"GET",url:"channel_json?id="+e.id,dataType:"json",success(t){const{messages:e}=t;RoomChannelMembersClient.setState({members:t.members}),RoomClient&&Gn.call(RoomClient,e),null===RoomClient||void 0===RoomClient||RoomClient.scroll()}}),App.room.join("channel"+e.id),RoomClient.state.last_message=null,null===RoomClient||void 0===RoomClient||RoomClient.scroll()}Room.prototype.componentDidMount=function(){this.clear_print();const{mode:e}=this.state,n=t[e];n?bi.call(this,n):"channel"===e?mi.call(this):"private"===e&&gi.call(this)},Room.prototype.trim_messages=function(){const t="channel"===this.state.mode?100:5e3,{messages:e}=this.state;e.length>t&&e.shift(),this.setState({messages:e})},Room.prototype.start_typing=function(t){var e;if(t.id===App.user.id)return;let n;n=null===(e=RoomChannelMembersClient.state.members.find(e=>(null==e?void 0:e.id)===t.id))||void 0===e?void 0:e.display_name,n||(n=t.display_name),this.setState({typing:n}),x.typing_timer=setTimeout(()=>{this.stop_typing()},1e4)},RoomChannelSelect.prototype.join=function(t){App.webrtc.client&&this.voice_disconnect(),this.expand(!1),this.setState({messages:[]}),this.updated=e.bind(this),this.updated(t),this.updated=function(){}},Room.prototype.start_typing=function(t){t.id!==App.user.id&&(this.setState({typing:St(t.display_name)}),x.typing_timer=setTimeout(()=>{this.stop_typing()},1e4))}}function wi(){x.MenuReactMicroStatic||(x.MenuReactMicroStatic={close:()=>null===MenuReactMicro||void 0===MenuReactMicro?void 0:MenuReactMicro.close()}),x.DashboardClient||(x.DashboardClient={setState:()=>{}}),$(x).off("resize").on("resize",()=>{const t=document.getElementById("messages");t&&(t.scrollTop=t.scrollHeight)}),Dashboard.prototype.ads=function(){return ot.a.createElement("div",{})},function(){function t(t){if(!t.updater.isMounted(t))return;const e=ai.a.findDOMNode(t);e&&ai.a.unmountComponentAtNode(e.parentNode)}function e(e){$(e[0]).removeClass("animated fadeIn"),$(e[0]).removeClass("animated fadeOut"),$(e[1]).addClass("animated zoomOut"),setTimeout(t.bind(null,this),70)}function n(){e.call(this,["#menu-micro-bg","#menu-micro"])}function i(e){t(this),e.nativeEvent.stopImmediatePropagation()}Menu.prototype.close=function(){e.call(this,[".ui-bg",".ui-menu"])},UserProfile.prototype.close=function(){e.call(this,[".ui-bg",".user-profile-menu"]),setTimeout(()=>{UserProfileReact=null})},FriendsMenu.prototype.componentDidMount=function(){$.ajax({type:"GET",url:"/friends_json",dataType:"json",success:function(t){const{friends:e}=t;t.friends=e.filter(t=>null!==t);const n=this.state.skippedMissing||0,i=e.filter(t=>null===t);this.setState({friends:t.friends,count:t.count,skippedMissing:n+i.length})}.bind(this)})},FriendsMenu.prototype.load_friends=function(){const t=this.state.skippedMissing||0,e=this.state.friends.length+t;$.ajax({type:"GET",url:"/load_friends_json?offset="+e,dataType:"json",success:function(e){if(0===e.length)return;const n=e.filter(t=>null===t),i=e.filter(t=>!n.includes(t)),r={skippedMissing:t+n.length,search:[],friends:[...this.state.friends,...i],count:this.state.count};this.setState(r)}.bind(this)})},MenuMicro.prototype.close=n,MenuMicroStatic.prototype.close=n,UserView.prototype.close=function(){document.removeEventListener("mousedown",this.exit_click,!1),t(this)},UserView.prototype.view_profile=function(){const{id:e}=this.state.user;UserProfileReact?UserProfileReact.switch(e):ai.a.render(ot.a.createElement(UserProfile,{key:e,id:e}),document.getElementById("ui-hatch")),t(this)},Popup.prototype.close=i,Picture.prototype.close=i,UserView.prototype.exit_click=function(t){t.target instanceof HTMLElement&&(t.target.matches(".user-profile-micro, .user-profile-micro *")||this.close())},UserProfile.prototype.componentDidMount=function(){$.ajax({type:"GET",url:"/profile_json?id="+this.props.id,dataType:"json",success:t=>this.setState({data:t}),error:()=>this.close()})},NotificationUnit.prototype.action=function(t){var e,n,i,r,o,s,a,c,u,l,h,f;const{target:d}=t;if(!(d instanceof Node))return;const m=d instanceof Element?d:d.parentElement;if(!m)return;if(m.matches(".notification-button, .notification-button *"))return;const p=this.props.data,g=null!==(e=p.data.sender)&&void 0!==e?e:p.data.user;if(!("unit"in p.data)||"friend_request"===p.tier)return void(g?UserViewGenerator.generate({event:t,user:g}):console.error("Could not get notification user for UserView."));"unit"in p.data&&(App.params=p.data.unit);const b=null!==(f=null!==(u=null!==(a=null!==(o=null!==(i=null===(n=p.data.unit)||void 0===n?void 0:n.post.user_id)&&void 0!==i?i:null===(r=p.data.unit)||void 0===r?void 0:r.author.id)&&void 0!==o?o:null===(s=p.data.unit)||void 0===s?void 0:s.post.author_id)&&void 0!==a?a:null===(c=p.data.unit)||void 0===c?void 0:c.comment.author_id)&&void 0!==u?u:null===(h=null===(l=p.data)||void 0===l?void 0:l.sender)||void 0===h?void 0:h.id)&&void 0!==f?f:p.sender_id;UserProfileReact&&UserProfileReact.load(b);const v=ot.a.createElement(UserProfile,{id:b});ai.a.render(v,document.getElementById("ui-hatch"))},NotificationUnit.prototype.image=function(){var t,e,n;return ot.a.createElement("img",{className:"navigation-notification-unit-image",src:null===(n=null===(e=null===(t=this.props.data)||void 0===t?void 0:t.data)||void 0===e?void 0:e.sender)||void 0===n?void 0:n.display_picture})},NotificationUnit.prototype.content=function(){var t,e;const{content:n,sender:i}=this.props.data.data,r={string:null!==(t=null==i?void 0:i.display_name)&&void 0!==t?t:"(no name)",flair:null!==(e=null==i?void 0:i.flair)&&void 0!==e?e:{color:""}},o=ot.a.createElement(Flair,{data:r}),s=n.length>64?n.substring(0,64)+"...":n,a=ot.a.createElement("span",{className:"navigation-notification-unit-message"},s);return ot.a.createElement("span",null,o,a)}}(),App.karma.data[0].range[1]=-1/0,App.temp.check=()=>{},SetGenderRenderer.render=function(){},UserViewGenerator.generate=function(t){t.event.preventDefault(),t.user.display_name=St(t.user.display_name);const e=t.event.clientX,n=t.event.clientY,i=ot.a.createElement(UserView,{data:{x:e,y:n,user:t.user}});ai.a.render(i,document.getElementById("ui-hatch-3")),UserViewReact&&UserViewReact.switch(t.user)},Flair.prototype.render=function(){const{data:{flair:t,string:e},onClick:n}=this.props;return ot.a.createElement("span",{className:"user-flair",style:null!=t?t:{color:""},onClick:n},e)},UserProfile.prototype.render=function(){const t=this.state.data?[this.top(),this.bottom()]:[ot.a.createElement(di)];return ot.a.createElement("div",{className:"ui-menu-container"},ot.a.createElement("div",{onMouseDown:this.close.bind(this),className:"animated fadeIn ui-bg"}),ot.a.createElement("div",{className:"animated zoomIn user-profile-menu"},...t))},CommentSettings.prototype.authorized=function(){var t;const e=this.props.parent,{micropost_data:n,comment_data:i}=e.state,{wall:r,current_user:o}=n;return o.mod||o.master||null!=r&&(null===(t=null==i?void 0:i.user)||void 0===t?void 0:t.id)===o.id},vi()}const yi=new mn(Z.blockedHashes),ki=new mn(Z.savedPictures);const xi=function(t){const e={};return async n=>{const i="number"==typeof n?n.toString():n;return Object.prototype.hasOwnProperty.call(e,i)||(e[i]=await t(i)),e[i]}}(async t=>{const e=(new TextEncoder).encode(t),n=await crypto.subtle.digest("SHA-1",e);return Array.from(new Uint8Array(n)).map(t=>t.toString(16).padStart(2,"0")).join("")});async function Ci(){var t;document.querySelectorAll(".room-component-message-picture-container, .image-wrap").forEach(async t=>{if(et.get(Z.imgControl)&&!t.querySelector(".picture-control")){const e=ct("div",{className:"picture-control"});e.append(ct("div",{className:"picture-button block material-icons",textContent:"delete_forever",title:"Block this image",onmousedown:t=>{var e,n;if(!(t.target instanceof HTMLElement))return;const i=null===(n=null===(e=t.target.parentElement)||void 0===e?void 0:e.parentElement)||void 0===n?void 0:n.firstChild;!async function(t){if(!t)return;const e=await xi(t);yi.add(e),Ci()}(null==i?void 0:i.src)}})),e.append(ct("div",{className:"picture-button save material-icons",textContent:"bookmark_border",title:"Bookmark this image",onmousedown:t=>{var e,n;if(!(t.target instanceof HTMLElement))return;const i=null===(n=null===(e=t.target.parentElement)||void 0===e?void 0:e.parentElement)||void 0===n?void 0:n.firstChild;!function(t){t&&ki.add(t)}(null==i?void 0:i.src)}})),t.append(e)}if(!(t.firstChild instanceof HTMLImageElement))return;const{src:e}=t.firstChild,n=await xi(e);yi.hasItem(n)&&(t.firstChild.src="")});const e=document.querySelector("form#picture_upload");if(!e)return;const n=e.parentElement,i=n.querySelector(".ui-menu-text");"B"!==(null===(t=null==i?void 0:i.firstElementChild)||void 0===t?void 0:t.tagName)||UserProfileReact?i&&(i.style.display=""):i.style.display="none";if(n.querySelector(".image-grid"))return;const r=n.querySelector(".ui-menu-buttons"),o=ct("div",{className:"image-grid"});ki.values().forEach(t=>{const e=ct("div",{style:`background-image: url(${encodeURI(t)}), url(${encodeURI("https://emeraldchat.com/avicons_strict/1.png")})`,onmousedown:()=>{!function(t){const e=(new Date).toISOString(),n={author_id:App.user.id,created_at:e,description:null,id:955e4+~~(1e6*Math.random()),image:{thumb:{url:t},url:t},image_processing:!1,image_tmp:null,micropost_id:null,picture_album_id:null,temporary:!1,title:null,updated_at:e,url:t};PictureUploader.onUploaded(n)}(t),MenuReactMicro.close()}});e.append(ct("div",{className:"picture-button material-icons",textContent:"bookmark_remove",title:"Unbookmark this image",onmousedown:n=>{n.stopPropagation(),confirm("Are you sure you want to unbookmark this image?")&&(ki.remove(t),e.remove())}})),o.append(e)}),n.insertBefore(o,r)}function Ai(){return`${s} ${c}`}const Ri={};function Ei(t,e){Ri[t]||(Ri[t]=[]),Ri[t].push(e)}function Mi(t,e){Ri[t]||(Ri[t]=[]);const n=Ri[t].indexOf(e);n>-1&&Ri[t].splice(n,1)}function Ni(t,e){Ri[t]||(Ri[t]=[]);let n=!1;const i=Object.assign(Object.assign({},e),{type:t,preventDefault(){n=!0}});return Ri[t].forEach(t=>t(i)),n}function Si(){const t={version:Ai,addEventListener:Ei,removeEventListener:Mi,dispatchEvent:Ni};ht(App.room,"join",t=>{Ni("room.join",{room:t}),ht(App.room.client,"received",t=>{var e;Ni("room.received",t),t.user&&t.user_disconnected&&Ni("user.left",t),t.user&&t.user_connected&&Ni("user.joined",t),t.messages&&t.messages.length&&Ni("user.message",t),(e=t).typing?null===RoomClient||void 0===RoomClient||RoomClient.start_typing(e.user):null===RoomClient||void 0===RoomClient||RoomClient.stop_typing()})}),ht(App.room,"leave",t=>{Ni("room.leave",{room:t})}),x.RxE=t}function Ti(){var t,e;const n=document.evaluate("//li[text()='Emerald Gold']",document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,i=document.evaluate("//li[text()='Premium Badge']",document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;et.get(Z.adBlocker)?(n instanceof HTMLElement&&n.remove(),i instanceof HTMLElement&&i.remove()):(n&&(null===(t=n.parentElement)||void 0===t?void 0:t.firstChild)===n&&n.parentElement.append(n),i&&(null===(e=i.parentElement)||void 0===e?void 0:e.firstChild)===i&&i.parentElement.append(i))}function _i(t){const{id:e,value:n,onChange:i,children:r}=t;return ot.a.createElement("div",null,ot.a.createElement("input",{type:"checkbox",id:e,checked:n,onChange:i}),ot.a.createElement("label",{htmlFor:e},e in tt?tt[e].label:null!=r?r:null))}function Ii(t){const{id:e,value:n,onChange:i,inline:r}=t,o=tt[e];if(!(o instanceof j))throw new Error("RadioSetting can only be used with MultichoicePreference");return ot.a.createElement("div",{className:"ritsu-radio-setting-root"},ot.a.createElement("label",{htmlFor:e,className:"m1 "+fi.settingsSection},o.label),ot.a.createElement("div",{id:e,style:{display:"flex",flexDirection:r?"row":"column"}},o.options.map(({value:t,label:r})=>ot.a.createElement("div",{className:"ritsu-radio-setting-option"},ot.a.createElement("input",{type:"radio",id:`${e}-option-${t}`,name:e,value:t,checked:n===t,onChange:()=>i(t)}),ot.a.createElement("label",{htmlFor:`${e}-option-${t}`},r)))))}function Di(t){const{id:e,value:n,onChange:i,placeholder:r,children:o}=t;return ot.a.createElement("div",null,ot.a.createElement("input",{id:e,value:n,placeholder:r,onChange:i}),ot.a.createElement("label",{htmlFor:e},e in tt?tt[e].label:null!=o?o:null))}function Oi(t){const e=new Set(t.map(t=>t[0])),n=new Set(et.get(Z.permaMuteList).map(t=>t[0])),{added:i,removed:r}=function(t,e){const n=new Set,i=new Set;return Array.from(t.values()).forEach(t=>{e.has(t)||n.add(t)}),Array.from(e.values()).forEach(e=>{t.has(e)||i.add(e)}),{added:n,removed:i}}(n,e);i.forEach(t=>App.room.mute(t)),r.forEach(t=>App.room.unmute(t))}class $i extends ot.a.Component{constructor(t){super(t),this.state={items:Array.from(t.value)}}handleItemRemoval(t){const{onChange:e,removeItem:n}=this.props,i=n(t,this.items());this.setState({items:i}),e(i)}items(){const{items:t}=this.state;return Array.from(t)}itemJSX(t){const{renderItem:e}=this.props;return ot.a.createElement("div",null,ot.a.createElement("span",Object.assign({className:"ui-button-text",style:{margin:"0 0.5em 0 0",padding:"0 0.5em",borderRadius:"0.25em",backgroundColor:"#e00000"}},Dt(()=>this.handleItemRemoval(t),{allowSpace:!0}),{role:"button",tabIndex:0}),""),ot.a.createElement("span",{style:{display:"inline-flex",alignItems:"center"}},e(t)))}render(){const{id:t,children:e}=this.props,{items:n}=this.state;if(!(tt[t]instanceof U))throw new Error("ListSetting can only be used with ListPreference");return ot.a.createElement("div",null,ot.a.createElement("div",{id:t,style:{display:"block"}},0===n.length?e:n.map(this.itemJSX.bind(this))))}}function Pi(t,e){const{[t]:n}=e,i="applySettings"in e?e.applySettings:e.applyHacks;return ot.a.createElement(_i,{id:t,value:n,onChange:()=>i({[t]:!n})})}function Ui(t,e){return ot.a.createElement("div",{className:"m1 "+t},e)}function ji(t){const e=ot.a.createElement(UserProfile,{id:t});ai.a.render(e,document.getElementById("ui-hatch"))}const Fi={g:"Global",i:"Case insensitive",m:"Multiline",u:"Unicode"};function Li(t){var e,n;const{id:i,value:r,onChange:o,flagsAllowed:s,children:a}=t;let c=null!==(e=null==r?void 0:r.source)&&void 0!==e?e:"",u=null!==(n=null==r?void 0:r.flags)&&void 0!==n?n:"";const l=(t,e)=>{if(null!=t&&(c=t),null!=e&&(u=e.join("")),""!==c)try{o(new RegExp(c,u))}catch(t){o({source:c,flags:u})}else o({source:c,flags:u})};return ot.a.createElement("div",null,ot.a.createElement(Di,{id:i+"-text",value:c,placeholder:"Regular expression",onChange:({currentTarget:t})=>l(t.value)},i in tt?tt[i].label:a),s.split("").map(t=>Object.prototype.hasOwnProperty.call(Fi,t)?ot.a.createElement(_i,{id:`${i}-flag-${t}`,value:u.includes(t),onChange:({currentTarget:e})=>{const n=(i=t,u.split("").filter(t=>t!==i));var i;const r=[...n,t];l(null,e.checked?r:n)}},Fi[t]):null))}function Vi(t){var e;const{muteRegexes:n,applySettings:i}=t;return ot.a.createElement("div",{className:fi.settings},Ui(fi.settingsSection,W.generalTitle),Pi("adBlocker",t),Pi("trackKarma",t),Pi("fancyColors",t),Pi("notifyUpdates",t),Pi("hideTyping",t),App.user.mod&&Pi("hideFromGc",t),function(t,e){const{applySettings:n,[t]:i}=e;return ot.a.createElement(Ii,{id:t,value:i,onChange:e=>n({[t]:e}),inline:!1})}("blockReqs",t),Ui(fi.settingsSection,W.imagesTitle),Pi("imgBlur",t),Pi("imgProtect",t),Pi("legacyImages",t),Pi("hidePfp",t),Pi("showAnimatedImages",t),Pi("imgControl",t),Pi("hideImageFallback",t),Ui(fi.settingsSection,W.messageTitle),Pi("antiSpam",t),Pi("showGender",t),Pi("showInfo",t),Pi("highlightMentions",t),Pi("bigEmoji",t),Pi("toggleEmbeds",t),Pi("largerText",t),Ui(fi.settingsSection,W.advancedTitle),Pi("ignoreURLBlacklist",t),function(t,e,n){const{applySettings:i,[t]:r}=e;return ot.a.createElement(Di,{id:t,value:r,onChange:e=>i({[t]:e.target.value}),placeholder:n})}("imgurAPIKey",t,W.preferences.imgurAPIKey.placeholder),ot.a.createElement(Li,{id:"muteRegexes",value:null!==(e=n[0])&&void 0!==e?e:{source:"",flags:""},onChange:({source:t,flags:e})=>i({muteRegexes:[{source:t,flags:e}]}),flagsAllowed:"i"}),function(t){const{applySettings:e,permaMuteList:n}=t;return ot.a.createElement($i,{id:"permaMuteList",value:n,removeItem:([t],e)=>e.filter(e=>e[0]!==t),renderItem:([t,e])=>[ot.a.createElement("span",{className:"ritsu-permamutelist-user-name"},e),ot.a.createElement("span",{className:"material-icons permamute-list",onClick:()=>ji(t),onKeyDown:()=>ji(t),role:"button",tabIndex:0},"account_circle")],onChange:t=>{Oi(t),e({permaMuteList:t}),null===NotificationsReact||void 0===NotificationsReact||NotificationsReact.update()}},"No mutes active")}(t))}var Bi=n(26),Gi=n.n(Bi),zi=n(8),qi=n.n(zi),Hi=n(27),Ki=n.n(Hi),Qi=n(28),Ji=n.n(Qi),Wi=n(29),Xi=n.n(Wi),Yi=n(30),Zi=n.n(Yi);const tr=["default","ritsu","light","teriblast","teriblast V2"];function er(){const t=et.get(Z.theme);let e=document.head.querySelector(".custom-theme");e||(document.head.append(ct("style",{className:"custom-theme",type:"text/css"})),e=document.head.querySelector(".custom-theme"));const n=[Gi.a];switch(t){case"default":default:break;case"ritsu":n.push(qi.a,Ki.a);break;case"light":n.push(qi.a,Ji.a);break;case"teriblast":n.push(qi.a,Xi.a);break;case"teriblast V2":n.push(qi.a,Zi.a)}e.textContent=n.join("\n")}function nr(t){const{theme:e,applyTheme:n}=t;return ot.a.createElement("div",null,ot.a.createElement("div",{className:"m1 "+fi.settingsSection},W.themeTitle),tr.map(t=>ot.a.createElement("div",null,ot.a.createElement("input",{type:"radio",id:t,name:"theme",value:t,checked:e===t,onChange:()=>n(t)}),ot.a.createElement("label",{htmlFor:t},t[0].toUpperCase()+t.slice(1)))))}var ir=n(31),rr=n.n(ir),or=n(32),sr=n.n(or),ar=n(33),cr=n.n(ar),ur=n(34),lr=n.n(ur);const hr={roboto:"Default Font",comic_sans:"Comic Sans MS",helvetica:"Helvetica",trebuchet:"Trebuchet MS",verdana:"Verdana"};function fr(){const t=et.get(Z.font);let e=document.head.querySelector(".custom-font");e||(document.head.append(ct("style",{className:"custom-font",type:"text/css"})),e=document.head.querySelector(".custom-font"));const n=[];switch(t){case"Default Font":default:break;case"Comic Sans MS":n.push(sr.a);break;case"Helvetica":n.push(cr.a);break;case"Trebuchet MS":n.push(lr.a);break;case"Verdana":n.push(rr.a)}e.textContent=n.join("\n")}var dr=n(35),mr=n.n(dr);class pr extends rt.Component{constructor(t){super(t),this.handleFontChange=t=>{const e=t.target.value;et.set(Z.font,e),this.setState({font:e});const{applyFont:n}=this.props;n(e)},this.state={font:t.currentFont}}render(){const{font:t}=this.state;return ot.a.createElement("div",null,ot.a.createElement("div",{className:"m1 "+mr.a.settingsSection},W.fontTitle),ot.a.createElement("label",{className:"ui-select",htmlFor:"font"},ot.a.createElement("select",{name:"font",id:"font",value:t,onChange:this.handleFontChange},Object.keys(hr).map(t=>ot.a.createElement("option",{key:t,value:hr[t]},hr[t])))))}}class gr extends ot.a.Component{constructor(){super({}),this.applySettings=t=>{const{settings:e}=this.state,n=Object.assign(Object.assign({},e),t);Object.keys(t).forEach(e=>et.set(Z[e],t[e])),yr(),this.setState({settings:n,needsReload:!0})},this.applyTheme=t=>{et.set(Z.theme,t),document.body.classList.add("themeChange"),er(),this.setState({theme:t}),setTimeout(()=>document.body.classList.remove("themeChange"),1e3)},this.applyFont=t=>{fr(),this.setState({font:t})},this.pe=t=>{},this.state=Object.assign(Object.assign({},wr()),{needsReload:!1})}render(){const{theme:t,font:e,settings:n,ge:i,needsReload:r}=this.state,o={fonts:{roboto:"Default Font",comic_sans:"Comic Sans MS",helvetica:"Helvetica",trebuchet:"Trebuchet MS",verdana:"Verdana"},currentFont:e,applyFont:this.applyFont};return ot.a.createElement("div",null,ot.a.createElement(nr,{theme:t,applyTheme:this.applyTheme}),ot.a.createElement(pr,Object.assign({},o)),ot.a.createElement(Vi,Object.assign({},n,{applySettings:this.applySettings})),!1,r&&ot.a.createElement("div",{className:fi.reloadWarning},"You may need to reload the app for your changes to take effect."))}}function br(){return ot.a.createElement(Menu,null,ot.a.createElement("div",{key:"custom_menu",className:fi.ritsuMenuContainer},"Ritsu Settings",ot.a.createElement("br",null),ot.a.createElement("br",null),ot.a.createElement(gr,null),ot.a.createElement("div",{className:"ui-menu-buttons"},ot.a.createElement("div",{role:"button",tabIndex:0,className:"ui-button-text",onMouseDown:()=>MenuReact.close()},"Close"))))}function vr(t){return function(t,e){const n=Object.getOwnPropertyNames(t).map(n=>[n,e(n,t[n])]);return Object.fromEntries(n)}(function(t,e){const n=Object.getOwnPropertyNames(t).filter(n=>t[n]instanceof e).map(e=>[e,t[e]]);return Object.fromEntries(n)}(t,P),(t,e)=>et.get(e))}function wr(){return Object.assign(Object.assign({theme:et.get(Z.theme),font:et.get(Z.font)},!1),{settings:Object.assign(Object.assign({},vr(Z)),{muteRegexes:et.get(Z.muteRegexes),imgurAPIKey:et.get(Z.imgurAPIKey),blockReqs:et.get(Z.blockReqs),permaMuteList:et.get(Z.permaMuteList)})})}function yr(){const t=wr().settings;Object.keys(t).forEach(e=>{"boolean"==typeof t[e]&&document.documentElement.classList.toggle(e,t[e])}),er(),fr()}function kr(){ai.a.render(ot.a.createElement(br,null),document.getElementById("ui-hatch"))}function xr(){const t=document.querySelector(".navigation-dropdown-ritsu"),e=document.querySelector(".navigation-dropdown-content");!t&&e&&e.prepend(ct("li",{className:"navigation-dropdown-ritsu",textContent:"Ritsu Menu",onmousedown:kr}))}var Cr=n(36),Ar=n.n(Cr);const Rr=ot.a.createElement("button",{className:"material-icons navigation-notification-unit lookup-button",onClick:function(){if("undefined"==typeof UserViewReact&&(UserViewGenerator.generate({event:{preventDefault:()=>{},clientX:100,clientY:100},user:{karma:100,id:2}}),UserViewReact.close(),"undefined"==typeof UserViewReact))return;const t=prompt("Enter a user id",""+UserViewReact.state.user.id);if(null===t)return;const e=parseInt(t,10);Number.isNaN(e)||(UserViewReact.state.user.id=e,UserViewReact.view_profile())},type:"button"},"face"),Er=ot.a.createElement("div",{className:"navigation-dropdown-content"},ot.a.createElement("div",null,W.preferences.userSort.label),["name.asc","name.desc","age.asc","age.desc"].map(t=>ot.a.createElement("li",{className:et.get(Z.userSort)===t?"selected":"",onClick:()=>function(t){et.set(Z.userSort,t),RoomChannelMembersClient instanceof RoomChannelMembers&&RoomChannelMembersClient.setState(RoomChannelMembersClient.state)}(t)},W.preferences.userSort[t]))),Mr=ot.a.createElement("div",{className:"navigation-dropdown sort-button"},ot.a.createElement("span",{className:"material-icons navigation-notification-unit"},"arrow_drop_down"),Er);let Nr;function Sr(t,e){var n;"setState"in RoomChannelMembersClient&&(null===RoomClient||void 0===RoomClient||RoomClient.setState({messages:[],current_channel:t}),RoomChannelMembersClient.setState({members:[]}),App.room.join(t),document.querySelectorAll(".channel-unit").forEach(t=>t.classList.remove("channel-unit-active")),null===(n=document.querySelector(e))||void 0===n||n.classList.add("channel-unit-active"),null===RoomClient||void 0===RoomClient||RoomClient.print(ot.a.createElement("div",null,W.privateRoomsWarning)),Nr=t)}function Tr(){document.querySelector(".wfaf.channel-unit-active")||Sr("",".wfaf")}function _r(){const t=prompt(W.privateRoomsPrompt);null!=t&&Sr(t,".private-rooms")}function Ir(t){const{type:e}=t||{},{action:n}=t||{},{text:i}=t||{};return ot.a.createElement("div",{className:"channel-unit "+e,onClick:()=>n(),onKeyPress:()=>n(),role:"button",tabIndex:0},i)}function Dr(){RoomChannelSelect.prototype.body=function(){const{text_channels:t}=this.state;return ot.a.createElement("div",{className:"room-component-module"},ot.a.createElement("div",{className:"room-user-label"},"text channels"),t.map(t=>this.channel_button(t)),ot.a.createElement("div",{className:"room-user-label"},W.hiddenChannels),ot.a.createElement(Ir,{type:"wfaf",action:Tr,text:W.WFAF}),ot.a.createElement(Ir,{type:"private-rooms",action:_r,text:W.privateRooms}))},function(){const t=ActionCable.Subscriptions.prototype.reject;ActionCable.Subscriptions.prototype.reject=function(e){e===App.room.client.identifier&&App.room.id===Nr&&dt("ERROR: You could not join room "+(Nr||"WFAF")),t.call(this,e)}}()}function Or(){function t(t){null===RoomClient||void 0===RoomClient||RoomClient.trim_messages();const e=null===RoomClient||void 0===RoomClient?void 0:RoomClient.state.messages;e&&(t.forEach(t=>{0===e.length&&e.unshift(t);const n=e[0],i=Pt(n.user)===Pt(t.user),r=n.picture||t.picture,o=n.messages.length>=16;if(!i||r||o)return void e.unshift(t);const s=t.messages[0];n.messages[0]===s||n.messages.unshift(t.messages[0])}),null===RoomClient||void 0===RoomClient||RoomClient.setState({messages:e}))}Room.prototype.load_messages=function(e){const n=(i=e)+20<=RoomClient.state.messages_count?-i-20:-RoomClient.state.messages_count;var i;$.ajax({type:"GET",url:`/room_load_more?loaded=${n}&id=${this.state.id}`,dataType:"json",success:e=>t.call(this,e.reverse())})},Room.prototype.switch=function(t){this.clear_print();const{id:e}=t;App.room.join(e),this.state.last_message=null,this.setState({id:e,messages:[],messages_count:0,typing:null,mode:t.mode||"default"}),"private"===t.mode&&$.ajax({type:"GET",url:"/default_private_messages?id="+e,dataType:"json",success:t=>{Gn.call(this,t.messages),this.setState({messages_count:t.messages_count}),this.scroll()}})}}var $r=n(37),Pr=n.n($r);function Ur(){lt(Pr.a),Room.prototype.room_input=function(){return ot.a.createElement("div",{className:"room-component-input"},ot.a.createElement("textarea",{id:"room-input",className:"room-component-input-textarea",onMouseDown:()=>this.scroll(),onKeyDown:t=>this.input(t),placeholder:"Say Something..."}),ot.a.createElement("span",{className:"room-component-input-icon material-icons",title:"Attach image",onMouseDown:()=>this.upload_picture(),role:"button",tabIndex:0},"photo_camera"))};const t=Room.prototype.upload_picture;Room.prototype.upload_picture=function(){if(App.user.gold&&!Z.legacyImages&&"channel"!==this.state.mode)return void t.call(this);MessagePictureUpload.prototype.handleSubmit=async function(t){var e;t.preventDefault();const n=document.getElementById("image");if(!n||!n.files)return;const i=n.files[0];MenuReactMicro.close();const r=Tn((await Vn(i)).url,!0);r&&(null===(e=null===RoomClient||void 0===RoomClient?void 0:RoomClient.sendRitsuPicture)||void 0===e||e.call(RoomClient,r))};const e=ot.a.createElement(MenuMicro,null,ot.a.createElement(MessagePictureUpload,null));ai.a.render(e,document.getElementById("ui-hatch-2"))},Room.prototype.sendRitsuPicture=function(t){const{mode:e}=this.state;this.append(Fn(t)),App.room.client.speak({message:Un(t),mode:e}),this.scroll()},MessagePictureUpload.prototype.body=function(){const t=vn();function e(t){const{text:e}=t;return ot.a.createElement("div",null,ot.a.createElement("b",null,"Note"),": ",e)}const n=ot.a.createElement("div",{className:"picture-upload-info"},ot.a.createElement(e,{text:Bn.destination}),ot.a.createElement(e,{text:Bn.ratelimit}),App.user._karma<10&&ot.a.createElement(e,{text:Bn.lowKarma})),i=t?" Choose a file":` Wait ${$.timeago(function(){const t=bn().slice(0,-49);if(0===t.length)return 0;const e=Math.max(...t);return+new Date+(108e5-Ct(new Date(e)))}())} before uploading again.`,r=ot.a.createElement("label",{htmlFor:"image"},ot.a.createElement("span",{className:"material-icons upload-thing",style:{cursor:t?"pointer":"not-allowed"}},t?"cloud_upload":"hourglass_top"),i),o=ot.a.createElement("input",{id:"image",className:"picture-upload-button",name:"image",type:"file",accept:"image/*",disabled:!t,onChange:()=>{var e;return t&&(null===(e=this.uploadImage)||void 0===e?void 0:e.call(this))}});return ot.a.createElement("form",{id:"picture_upload",name:"picture_upload","data-remote":"true",method:"post",action:xn},o,r,n)};const e=Room.prototype.received;Room.prototype.received=function(t){var n;const r=e.bind(this),o=null===(n=t.messages)||void 0===n?void 0:n[0];if(!o)return;const s=Ln(o);if(s)try{return void r(Fn(s,t.user))}catch(t){t instanceof Error&&i.error(t.message)}else r(t)}}var jr=n(38),Fr=n.n(jr);const Lr=t=>"Enter"===t.key&&!t.shiftKey;function Vr(t){if(!t.clipboardData)return;const{items:e}=t.clipboardData;Array.from(e).forEach(t=>{!async function(t){var e;if("file"!==t.kind)return;const n=t.getAsFile();if(n&&confirm("Are you sure you want to upload this image in chat?"))if(App.user.gold&&!Z.legacyImages&&"channel"!==(null===RoomClient||void 0===RoomClient?void 0:RoomClient.state.mode)){const t=String(await new Promise(t=>{const e=new FileReader;e.onload=()=>{t(e.result)},e.readAsDataURL(n)}));null===RoomClient||void 0===RoomClient||RoomClient.send_picture(t)}else{const t=Tn((await Vn(n)).url,!0);t&&(null===(e=null===RoomClient||void 0===RoomClient?void 0:RoomClient.sendRitsuPicture)||void 0===e||e.call(RoomClient,t))}}(t)})}function Br(t){const e=et.get(Z.blockReqs);t.friend_requests=t.friend_requests.filter(t=>{const n=new Date(t.data.sender.created_at),i=e!==Y.None&&Ct(n)<864e5,r=App?App.room.muted.includes(t.sender_id):t.seen;return!i&&!r||(e!==Y.Reject||$.ajax({type:"GET",url:`/friends_decline?friend_id=${t.sender_id}&notification_id=${t.id}`,dataType:"json"}),!1)})}function Gr(){return $.ajax({type:"GET",url:"/notifications_json",dataType:"json",success:function(t){Br(t),NotificationsReact.setState({data:t})}}),"updated"}const zr=t=>t?ot.a.createElement(Flair,{data:{string:t,flair:App.user.flair}}):null;function qr(){const t=Message.prototype.process;Message.prototype.process=function(e){const n=t.bind(this),i=null===(s=null===(o=null===(r=App.user)||void 0===r?void 0:r.display_name)||void 0===o?void 0:o.replace(/[^\w\s]/g,""))||void 0===s?void 0:s.trim();var r,o,s;if(!i||!et.get(Z.highlightMentions))return n(e);return Mt(e,i,zr,t=>Mt(t,App.user.display_name,zr,n))}}class Hr extends ot.a.Component{render(){const{href:t}=this.props,e=(t=>/^https?:\/\//.test(t)?t:"https://"+t)(t);try{const i=new URL(e),o=(r=i.host,Array.from(r.matchAll(/[^-._a-zA-Z0-9~]/g)).map(t=>t[0])),s=o.length>0,a=` Are you sure you want to open this link? \nNote that shady sites can guess your location and earmark your browser. Beware URLs on safe domains that look like redirects. The site you're about to visit is hosted by ${i.host}.`+((n=o).length>0?"\n Type this link yourself instead if you don't want to be fooled. \nThe following characters in the link look suspicious:\n"+n.map(ee):"");return i.protocol.toLowerCase().startsWith("javascript")?t:ot.a.createElement("a",{className:"ritsu-message-anchor",href:s?"#":i.href,target:"_blank",onClick:t=>{confirm(a)&&!s||t.nativeEvent.preventDefault()},rel:"noreferrer"},e)}catch(e){return e instanceof Error&&i.error(e.message),t}var n,r}}const Kr=t=>e=>t().some(t=>t.test(e)),Qr=Kr(()=>[/\//g,/[^.]+?\.[^.]+?\.[^.]+?/g,/\.com|\.org|\.net|\.co\.uk|\.eu|\.us|\.gov|\.io/]),Jr=Kr(()=>[/emeraldchat/gi,/grabify/gi,/ip-puller/gi,/hackingvision/gi,/iplogger/gi,/bit\.ly/gi,/blasze/gi,/ps3CFW/gi,/powercut/gi,/whatstheirip/gi,/\.gift/gi,/(^|https?:\/\/)\w{3}\.\w{2}(\/|$)/gi]),Wr=Kr(()=>[/(^|https?:\/\/)(i\.)?ibb\.co(\/|$)/gi]),Xr=t=>{const e=ie(t),n=t||null;if(!Qr(e))return n;if(e.match(/^[^\s@]+@[^\s@]+(\.|(%2E))\u200b?[^\s@]+$/gi))return e;const i=et.get(Z.ignoreURLBlacklist);return Wr(e)||!Jr(e)||i?ot.a.createElement(Hr,{href:e}):n};function Yr(t,e){return Et(t,Ot(oe,`(${re}|${se}){2,256}`,re+"[a-z]{2,}",`\\b(\\/(${re}|${se}|\\/)*)?`,"gi"),Xr,e)}const Zr=t=>t.split(""),to=t=>{return e=2,function(t,e){const n=[];for(let i=0;i<t.length;i+=e){const r=t.slice(i,i+e);n.push(r)}return n}(t.split(""),e).map(t=>t.join(""));var e},eo={none:Zr("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"),italic:to(""),bold:to(""),boldItalic:to(""),underline:to("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"),squared:to(""),squaredFull:to(""),circled:Zr(""),superscript:Zr(""),medieval:to(""),cursive:to(""),cursiveBold:to(""),monospace:Zr(""),smallcaps:Zr("QxQx"),hooked:Zr("x"),boldSerif:to("")};const no=t=>t;function io(t){const e=t.toLocaleLowerCase();return ot.a.createElement("span",Object.assign({},{className:"material-icons",title:e}),t.slice(2,-1))}function ro({length:t}){return t>1?[ot.a.createElement("br",null),ot.a.createElement("br",null)]:ot.a.createElement("br",null)}const oo={"[[":"squaredFull","((":"circled","{{":"medieval","*":"italic",vt:"italic","**":"bold",Ot:"underline","***":"boldItalic","`":"monospace","^^":"superscript",",,":"hooked","<":"cursive","<<":"cursiveBold","~":"smallcaps"},so=Object.getOwnPropertyNames(oo);function ao(t){const e=so.find(e=>t.startsWith(e)&&t.endsWith(function(t){return"[["===t?"]]":"(("===t?"))":"{{"===t?"}}":"*//"===t?"//*":"<<"===t?">>":"<"===t?">":t}(e)));if(void 0===e)return t;const n=t.slice(e.length,-e.length),i=e.slice(-1)[0];return n.split("").every(t=>t===i)?t:function(t,e){return e.split("").map(e=>{var n;const i=eo.none.indexOf(e);return null!==(n=eo[t][i])&&void 0!==n?n:e}).join("")}(oo[e],n)}function co(t,e=no){return function(t,e=no){return Et(t.replace(/^[\s\n]+|[\s\n]+$/g,""),/\n+/g,ro,e)}(t,t=>function(t,e=no){return Et(t,/m:[-_a-z]+:/gi,io,e)}(t,t=>Yr(t,e)))}so.sort((t,e)=>e.length-t.length);const uo={shrug:"\\_()_/",tableflip:"( ",tableflip2:"()",unflip:" ( -)"},lo={all:{rxelink:()=>RoomClient.send("Link to RxE extension for Emerald: "+Dn),rules:()=>RoomClient.send("For the updated ruleset please see: "+On)},on:t=>({run:e=>(lo.all[t]=e,lo)}),prefix:".",process(t){if(!t.startsWith(lo.prefix))return!1;const e=t.slice(lo.prefix.length).split(" "),n=lo.findCommand(e[0]);return null==n||n(...e.slice(1)),!!n},findCommand(t){const e=Object.getOwnPropertyNames(lo.all).find(e=>e===t);return e?lo.all[e]:void 0},checkMail:t=>/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}/gi.test(t),processMail:t=>t.replace(/\./gi,".")};function ho(){var t;t=uo,Object.entries(t).forEach(([t,e])=>lo.on(t).run(()=>RoomClient.send(e))),Room.prototype.send=function(t){const{mode:e}=this.state,n=this.process?this.process(t):function(t){if(!t)return null;const e=t.split(" ");let n="";return e.forEach(t=>{n+=" "+[t.slice(0,1),"",t.slice(1)].join("")}),n}(t);null!==n&&(this.append({messages:[n],user:App.user}),App.room.client.speak({message:n,mode:e}),this.scroll())},Room.prototype.process=function(t){return lo.process(t)?null:lo.checkMail(t)?lo.processMail(t):ne(function(t,e=no){return Et(t,/(?<=\s|^|\.,;!\?)(\*{1,3}|_{1,2}|~{1,2}|<{1,2}|`|\^\^|,,|\[{2}|\({2}|\{{2})\S(?:.*?\S)?(?:\1|\]{2}|\){2}|\}{2}|>{1,2})(?=\s|$|\.,;!\?)/g,ao,e).join("")}(t))}}function fo(t,e,n){const i=t.split(/ +/g);if(i.length>36&&e){const t=i.slice(0,36).join(" ");return ot.a.createElement("span",null,co(t)," ...",ot.a.createElement("span",Object.assign({className:"user-micropost-text-button"},Dt(n))," More"))}return co(t,Micropost.prototype.youtube_process)}var mo=n(39),po=n.n(mo);function go(){lt(po.a);const t=Message.prototype.process;Message.prototype.process=function(e){const n=t.bind(this);return e.includes("youtu.be")||e.includes("youtube.com")?n(e):function(t,e=no){if(ae().test(t))return Et(t,ae(),t=>jn({url:"https://"+t}),()=>"");const n=Ln(t);return null!==n?jn(n):e(t)}(ie(e),t=>co(t,n))},Micropost.prototype.content=function(){const{data:t,compact:e}=this.state;if(!t)return null;const{content:n}=t.micropost;return ot.a.createElement("div",{style:{width:"100%"}},fo(n,e,()=>this.more()))},Comment.prototype.content=function(){const{comment_data:t,compact:e}=this.state;if(!t)return null;const{content:n}=t.comment;return ot.a.createElement("div",{style:{width:"100%"}},fo(n,e,()=>this.more()))}}const bo=[[Room,"Room"],[UserProfile,"UserProfile"],[FriendUnit,"FriendUnit"],[Micropost,"Micropost"],[MessageNotificationUnit,"MessageNotificationUnit"],[Message,"Message"],[RoomUserUnit,"RoomUserUnit"],[UserUnit,"UserUnit"],[UserView,"UserView"],[Dashboard,"Dashboard"]];const vo=["safe","normal","unsafe"];function wo({preset:t,applyPreset:e}){return ot.a.createElement("div",null,ot.a.createElement("div",{className:"m1 "+fi.settingsSection},W.introduction.presetsTitle),vo.map(n=>ot.a.createElement("div",null,ot.a.createElement("input",{type:"radio",id:"ritsu-preset-"+n,name:"preset",value:n,checked:n===t,onChange:()=>e(n)}),ot.a.createElement("label",{htmlFor:"ritsu-preset-"+n},W.introduction.presets[n].title,ot.a.createElement("br",null)),ot.a.createElement("div",{className:"notification-menu-container-text"},W.introduction.presets[n].content),ot.a.createElement("br",null))))}class yo extends ot.a.Component{constructor(){super({}),this.applyTheme=t=>{et.set(Z.theme,t),document.body.classList.add("themeChange"),er(),this.setState({theme:t}),setTimeout(()=>document.body.classList.remove("themeChange"),1e3)},this.applyFont=t=>{fr(),this.setState({font:t})},this.applyPreset=t=>{"safe"===t?(et.set(Z.blockReqs,Y.Reject),et.set(Z.imgBlur,!0),et.set(Z.imgProtect,!0),et.set(Z.showAnimatedImages,!1),et.set(Z.toggleEmbeds,!1)):"normal"===t?(et.set(Z.blockReqs,Y.None),et.set(Z.imgBlur,!1),et.set(Z.imgProtect,!0),et.set(Z.showAnimatedImages,!0),et.set(Z.toggleEmbeds,!0)):"unsafe"===t&&(et.set(Z.blockReqs,Y.None),et.set(Z.imgBlur,!1),et.set(Z.imgProtect,!1),et.set(Z.showAnimatedImages,!0),et.set(Z.toggleEmbeds,!0)),this.setState({preset:t})};const{theme:t,font:e}=wr();this.state={theme:t,font:e,preset:"normal"}}render(){const{theme:t,font:e,preset:n}=this.state,i={fonts:{roboto:"Default Font",comic_sans:"Comic Sans MS",helvetica:"Helvetica",trebuchet:"Trebuchet MS",verdana:"Verdana"},currentFont:e,applyFont:this.applyFont};return ot.a.createElement(Menu,null,ot.a.createElement("div",{key:"custom_menu",className:fi.ritsuMenuContainer},W.introduction.title,ot.a.createElement("br",null),ot.a.createElement("br",null),W.introduction.content,ot.a.createElement(nr,{theme:t,applyTheme:this.applyTheme}),ot.a.createElement(pr,Object.assign({},i)),ot.a.createElement(wo,{preset:n,applyPreset:this.applyPreset}),ot.a.createElement("div",{className:"ui-menu-buttons"},ot.a.createElement("div",{role:"button",tabIndex:0,className:"ui-button",onMouseDown:()=>{et.set(Z.introductionCompletedVersion,1),MenuReact.close()}},"Save"))))}}function ko(){et.get(tt.introductionCompletedVersion)<1&&ai.a.render(ot.a.createElement(yo,null),document.getElementById("ui-hatch"))}function xo(t){const{version:e,changes:n}=t;return ot.a.createElement(Menu,null,ot.a.createElement("div",{key:"custom_menu",className:fi.ritsuMenuContainer},"Update available for RxE!",ot.a.createElement("br",null),ot.a.createElement("br",null),"Version ",e," of RxE is out!",ot.a.createElement("br",null),ot.a.createElement("br",null),"The changes are:-",ot.a.createElement("pre",{style:{fontFamily:"Arial, sans-serif",fontSize:"16px"}},n),ot.a.createElement("br",null),ot.a.createElement("br",null),"Visit the"," ",ot.a.createElement("a",{href:"https://github.com/Ritsu-Projects/Public-Releases/raw/main/ritsu-emerald.user.js"},"Github repositry")," ","or click"," ",ot.a.createElement("a",{href:"https://github.com/Ritsu-Projects/Public-Releases/raw/main/ritsu-emerald.user.js"},"here")," ","to update to the latest version!",ot.a.createElement("div",{className:"ui-menu-buttons"},ot.a.createElement("div",{role:"button",tabIndex:0,className:"ui-button",onMouseDown:()=>{MenuReact.close()}},"Close"))))}async function Co(){if(!et.get(Z.notifyUpdates))return;const t=await fetch("https://raw.githubusercontent.com/Ritsu-Projects/Public-Releases/main/meta/VERSION"),e=await t.text(),n=await fetch("https://raw.githubusercontent.com/Ritsu-Projects/Public-Releases/main/meta/CHANGE_LOG"),i=await n.text();(function(t,e){const n=t.split("."),i=e.split(".");for(let t=0;t<4;t+=1){const e=Number(n[t]),r=Number(i[t]);if(e>r)return 1;if(e<r)return-1}return 0})(c,e.trim())<0&&ai.a.render(ot.a.createElement(xo,{version:e,changes:i}),document.getElementById("ui-hatch"))}function Ao(t,e){Array.from(t).forEach(t=>{t.style.width=e})}function Ro(){const t=document.getElementsByClassName(".room-component-center");document.querySelector(".room-component-right")?Ao(t,"calc(100% - 400px)"):Ao(t,"100%")}var Eo=n(40),Mo=n.n(Eo);const No=ActionCable.createConsumer();function So(t){setTimeout(()=>{const e=No.subscriptions.create({channel:"RoomChannel",room_id:t},{connected(){console.log(`# client connected to room[${t}] #`),e.unsubscribe()},disconnected:()=>console.log(`# client disconnected from room[${t}] #`)})},230)}function To(){et.get(Z.hideFromGc)&&setTimeout(()=>{!async function(){if(!App.user.mod&&!App.user.master)return;const t=App.room.join;App.room.join=function(e){t(e),So(e),App.room.client.speak=function(t){this.perform("speak",{message:t.message,id:e,mode:t.mode,picture:t.picture}),So(e)},App.room.client.typing=function(){}};const e=Room.prototype.room_reconnected;Room.prototype.room_reconnected=function(){e.call(this);const{id:t}=App.room;So(t)}}()},1e3)}const _o=[["7","7 seconds (warning)"],["120","2 minutes"],["300","5 minutes"],["600","10 minutes"],["900","15 minutes"],["1800","30 minutes"],["3600","1 hour"],["10800","3 hours"],["21600","6 hours"],["43200","12 hours"],["86400","1 day"],["31556952","Permanently"]],Io=[{value:"spam",label:"Multiple spam attempts in chat"},{value:"harassment",label:"Harassment, threats and/or abuse towards a user or group of users"},{value:"sexual_harassment",label:"Sexually explicit remarks towards a user or group of users"},{value:"csa",label:"Distribution/Promotion of illegal content involving CP/CSA"},{value:"inappropriate_content",label:"Distribution/Promotion of illegal/explicit content"},{value:"underage",label:"Feel free to join our Group Chat, but you must be 18+ in order to use 1-on-1 Text Chat/Video Chat"},{value:"racism",label:"Spreading derogatory words/racism/bigotry in chat"},{value:"english",label:"Please keep group chat in English"},{value:"other",label:"Other"}];class Do extends rt.Component{constructor(t){super(t),this.handleDurationChange=t=>{this.setState({duration:t.target.value})},this.handleReasonChange=t=>{const e=t.target.value;this.setState({reason:e}),"Other"===e?this.setState({showCustomReason:!0,reason:""}):this.setState({showCustomReason:!1})},this.handleOtherReasonChange=t=>{this.setState({reason:t.target.value})},this.handleEditReasonToggle=()=>{this.setState(t=>({showCustomReason:!t.showCustomReason}))},this.state={duration:"120",reason:t.reasons[0].label,showCustomReason:!1}}renderDurationOption(t,e){return ot.a.createElement("option",{value:t},e)}renderReasonOption(t){return ot.a.createElement("option",{key:t.value,value:t.label},t.label)}render(){const{duration:t,reason:e,showCustomReason:n}=this.state,{reasons:i}=this.props;return ot.a.createElement("div",null,ot.a.createElement("div",null,"ISSUE BAN"),ot.a.createElement("br",null),ot.a.createElement("br",null),ot.a.createElement("div",{className:"m1"},"duration"),ot.a.createElement("label",{className:"ui-select",htmlFor:"duration"},ot.a.createElement("select",{name:"duration",id:"duration",value:t,onChange:this.handleDurationChange},_o.map(([t,e])=>this.renderDurationOption(t,e)))),ot.a.createElement("div",{className:"m1"},"reason"),n?ot.a.createElement("input",{type:"text",id:"reason",className:"ui-input",value:e,onChange:this.handleOtherReasonChange}):ot.a.createElement("label",{className:"ui-select",htmlFor:"reason"},ot.a.createElement("select",{name:"reason",id:"reason",value:e,onChange:this.handleReasonChange},i.map(t=>this.renderReasonOption(t)))),ot.a.createElement("div",{className:"m1"},ot.a.createElement("input",{type:"checkbox",id:"edit-reason-toggle",checked:n,onChange:this.handleEditReasonToggle}),ot.a.createElement("label",{htmlFor:"edit-reason-toggle"},"Edit Reason")))}}function Oo(){ReportLogModeration.prototype.fetch_spam=function(){$.ajax({type:"GET",url:"/spam_moderation",dataType:"json",success:function(t){const e={spam_moderations:t};this.setState(e)}.bind(this)})},ReportLogModeration.prototype.componentDidMount=function(){this.fetch_data(),this.fetch_spam()},ReportLogModeration.prototype.render=function(){const t=this.state.spam_moderations,e=this.state.reeport_logs,n=function(){this.setState({sort:"max_count"===this.state.sort?"most_recent":"max_count"}),this.fetch_data()}.bind(this);return ot.a.createElement("div",{className:"dashboard-background"},ot.a.createElement("div",{className:"dashboard-container"},ot.a.createElement("div",{className:"meet-cards-container video-moderation"},ot.a.createElement("div",{className:"video-moderation-controls-container"},ot.a.createElement("button",{className:"ui-button-match-mega primary-button",onClick:n},"Sorted By"," ","max_count"===this.state.sort?"Max Count":"Most Recent"))),ot.a.createElement("div",{className:"meet-cards-container report-logs-container"},function(t,e){let n=[];return t&&(n=t.map(t=>t.id)),e.map(t=>ot.a.createElement(ReportLogModerationUnit,{key:"spam_moderation_"+t.id,has_report:n.includes(t.id),data:t}))}(t,e))))},ReportLogModerationUnit.prototype.renderContent=function(t){return t.image?ot.a.createElement("img",{alt:"",src:t.image}):t.message&&"string"==typeof t.message?ot.a.createElement("p",{className:"messages"},"Messages:",ot.a.createElement("br",null)," ",t.message):null},ReportLogModerationUnit.prototype.render=function(){const{data:t}=this.props,e=t.report_logs[this.state.selected],n=this.props.has_report;return ot.a.createElement("div",{className:"dashboard-button animated",style:{paddingTop:"30px",border:n?"4px solid red":""}},ot.a.createElement("div",{className:"room-component-message-left"},ot.a.createElement("img",{onMouseDown:e=>UserViewGenerator.generate({event:e,user:t}),src:t.display_picture,alt:"",className:"room-component-message-avatar"})),ot.a.createElement("div",{className:"info"},ot.a.createElement("p",null,t.display_name,ot.a.createElement("span",{style:{color:"gold"}},t.gold?" (G)":""))),ot.a.createElement("div",{className:"report-log-container"},ot.a.createElement("div",{className:"grid-item arrow",style:{marginLeft:"-15px"},title:"Previous",onClick:this.previous},ot.a.createElement("span",{className:"material-icons"},"arrow_back")),ot.a.createElement("div",{className:"grid-item weight"},(()=>{const{reason:t}=e;return t?ot.a.createElement("div",{className:"reason"},"Reason: ",e.reason):null})(),ot.a.createElement("div",{className:"reason"},"Username: ",e.username),this.renderContent(e)),ot.a.createElement("div",{className:"grid-item arrow",style:{marginRight:"-20px"},title:"Next",onClick:this.next},ot.a.createElement("span",{className:"material-icons"},"arrow_forward"))),ot.a.createElement("div",null,this.state.selected+1," out of ",t.report_logs.length))}}var $o=n(6);Object($o.g)("firebase","10.6.0","app");var Po=n(15);const Uo=Object($o.f)({apiKey:"AIzaSyB4uXdUj6n98IGyRwu8qgKBwGYPau4VN8M",authDomain:"name-mod-api-2.firebaseapp.com",projectId:"name-mod-api-2",storageBucket:"name-mod-api-2.appspot.com",messagingSenderId:"66911516509",appId:"1:66911516509:web:ed281f81cfdd6b4b145ab4",measurementId:"G-LSKDYQLBQY"}),jo=Object(Po.c)(Uo);async function Fo(t){const{action:e,pictureBase64:n,nameModeration:i}=t,r={action:e};n&&(r.picture=n),i&&(r.nameModeration=i);try{const t=await Object(Po.a)(Object(Po.b)(jo,"EmeraldChat"),r);console.log("Document written with ID: ",t.id)}catch(t){console.error("Error adding document: ",t)}}class Lo extends ot.a.Component{constructor(t){super(t),this.update=()=>{const t=setInterval(()=>{document.body.classList.contains("picModMounted")&&this.fetch()},15e3);this.setState({interval:t})},this.handleFetch=async t=>{const e=await Ee(t,this.approve,this.delete);this.setState({picture_moderations:e}),Ae(e.length)},this.fetch=()=>{$.ajax({type:"GET",url:"/picture_moderations",dataType:"json",success:this.handleFetch.bind(this)})},this.stateUpdate=t=>{const{picture_moderations:e}=this.state,n=e.filter(e=>e.id!==t),i={picture_moderations:n};Ae(n.length),this.setState(i)},this.findPicture=t=>{const{state:e}=this;return e.picture_moderations.find(e=>e.id===t)},this.approve=t=>{const e=this.findPicture(t),n=null==e?void 0:e.imageHash;n&&Re(n,"approve"),$.ajax({type:"POST",url:`/picture_moderations/${t}/approve`,dataType:"json",success:this.stateUpdate.bind(this,t),error:e=>{404!==e.status&&403!==e.status||this.stateUpdate.bind(this,t)}});Fo({action:"approve",pictureBase64:null==e?void 0:e.base64Image})},this.delete=t=>{const e=this.findPicture(t),n=null==e?void 0:e.imageHash;n&&Re(n,"reject"),$.ajax({type:"DELETE",url:"/picture_moderations/"+t,dataType:"json",success:this.stateUpdate.bind(this,t),error:e=>{404!==e.status&&403!==e.status||this.stateUpdate.bind(this,t)}});Fo({action:"approve",pictureBase64:null==e?void 0:e.base64Image})},this.approveSelectedElements=()=>{const{state:t}=this;t.selectedElements.slice().forEach(e=>{const n=t.picture_moderations.find(t=>t.id===e);n&&this.approve(n.id)}),this.setState({selectedElements:[]})},this.deleteSelectedElements=()=>{const{state:t}=this;t.selectedElements.slice().forEach(e=>{this.delete(e);const n=t.picture_moderations.findIndex(t=>t.id===e);t.picture_moderations.splice(n,1)}),this.setState({selectedElements:[]})},this.state={picture_moderations:[],selectedElements:[],interval:void 0}}componentDidMount(){document.body.classList.add("picModMounted"),this.fetch(),this.update()}componentWillUnmount(){const{interval:t}=this.state;t&&clearInterval(t),document.body.classList.remove("picModMounted")}toggleElementSelection(t){var e;const{picture_moderations:n,selectedElements:i}=this.state,r=null===(e=n.find(e=>e.id===t))||void 0===e?void 0:e.imageHash,o=n.filter(t=>t.imageHash===r).map(t=>t.id);let s;s=i.includes(t)?i.filter(t=>!o.includes(t)):[...i,...o],this.setState({selectedElements:s})}selectAllElements(){const{picture_moderations:t,selectedElements:e}=this.state,n=t.map(t=>t.id);n.every(t=>e.includes(t))?this.setState({selectedElements:[]}):this.setState({selectedElements:n})}actionButtons(){const{picture_moderations:t,selectedElements:e}=this.state;return ot.a.createElement("div",null,ot.a.createElement("button",{onClick:()=>{this.approveSelectedElements()},type:"button"},"Approve Selected Images"),ot.a.createElement("button",{onClick:()=>{this.deleteSelectedElements()},type:"button"},"Delete Selected Images"),ot.a.createElement("button",{onClick:()=>{this.selectAllElements()},type:"button"},e.length&&t.length===e.length?"Unselect All":"Select All"),ot.a.createElement("button",{onClick:Me,type:"button"},"Clear Cache"))}render(){const{picture_moderations:t,selectedElements:e}=this.state,n=t=>{this.toggleElementSelection(t)};return ot.a.createElement("div",{className:"dashboard-container"},this.actionButtons(),ot.a.createElement("br",null),ot.a.createElement("div",{className:"meet-cards-container video-moderation"},t.map(t=>ot.a.createElement("div",{key:t.id,className:"checkmark-button-container"},ot.a.createElement(ke,{isSelected:e.includes(t.id),onClick:()=>n(t.id)}),ot.a.createElement(PictureModerationUnit,{key:"picture_moderation"+t.id,data:t,delete:this.delete,approve:this.approve})))),t.length?this.actionButtons():void 0,ot.a.createElement("br",null))}}function Vo(){SpamModeration.prototype.fetch_reports=function(){$.ajax({type:"GET",url:"/report_logs_moderation",dataType:"json",success:function(t){const e={report_logs:t};this.setState(e)}.bind(this)})},SpamModeration.prototype.componentDidMount=function(){this.fetch_data(),this.fetch_reports(),this.setState({sortByMessageCount:!1})},SpamModeration.prototype.sortMessages=function(){const{sortByMessageCount:t}=this.state;t?this.sortMessageCount():this.sortLastMessage()},SpamModeration.prototype.toggleSort=function(){this.sortMessages(),this.setState({sortByMessageCount:!this.state.sortByMessageCount}),this.forceUpdate()},SpamModeration.prototype.render=function(){const t=this.state.spam_moderations,e=this.state.report_logs;return this.sortMessages=this.sortMessages.bind(this),this.toggleSort=this.toggleSort.bind(this),ot.a.createElement("div",{className:"dashboard-background"},ot.a.createElement("div",{className:"dashboard-container"},ot.a.createElement("div",{className:"meet-cards-container video-moderation"},ot.a.createElement("button",{type:"button",onClick:this.toggleSort},this.state.sortByMessageCount?"Sort by message count":"Sort by last message"),ot.a.createElement("br",null),ot.a.createElement("br",null),function(t,e){let n=[];return e&&(n=e.map(t=>t.id)),t.map(t=>ot.a.createElement(SpamModerationUnit,{key:`spam_moderation_${t.id}_${t.content}`,has_report:n.includes(t.id),data:t}))}(t,e))))},SpamModeration.prototype.sortMessageCount=function(){const t=this.state.spam_moderations.sort((t,e)=>e.message_count-t.message_count);this.setState({spam_moderations:t})},SpamModeration.prototype.sortLastMessage=function(){const t=this.state.spam_moderations.sort((t,e)=>{const n=new Date(t.latest_message).getTime();return new Date(e.latest_message).getTime()-n});this.setState({spam_moderations:t})},SpamModerationUnit.prototype.render=function(){const{data:t}=this.props,e=this.props.has_report;let n=jQuery.timeago(new Date(t.latest_message));return"Now"!==n&&(n+=" ago"),ot.a.createElement("div",{className:"dashboard-button animated",style:{paddingTop:"30px",minHeight:"330px",border:e?"4px solid red":"",background:t.banned?"#2f0303":""}},ot.a.createElement("div",{className:"room-component-message-left"},ot.a.createElement("div",{style:{border:t.gold?"4px solid blue !important":""}},ot.a.createElement("div",null,t.gold?ot.a.createElement("img",{src:"https://emeraldchat.com/badges/tick.svg",alt:"",style:{zIndex:1,height:"25px",marginBottom:"-20px",marginRight:"-20px"}}):void 0,ot.a.createElement("img",{onMouseDown:e=>UserViewGenerator.generate({event:e,user:t}),src:t.display_picture,alt:"",className:"room-component-message-avatar"})))),ot.a.createElement("div",{className:"spam-user-info"},ot.a.createElement("p",null,"Name: ",t.display_name),ot.a.createElement("b",{style:{display:"flex"}},"Content:",ot.a.createElement("p",{style:{color:"orange",fontWeight:"bold"}}," "+t.content)),ot.a.createElement("p",null,"Last message: ",n),ot.a.createElement("p",null,"Message count: ",t.message_count)))}}class Bo extends ot.a.Component{constructor(t){super(t),this.update=()=>{const t=setInterval(()=>{document.body.classList.contains("picModMounted")&&this.fetch()},15e3);this.setState({interval:t})},this.handleFetch=async t=>{const e=await Te(t,this.approve,this.delete);Ne(e.length),this.setState({display_name_moderations:e})},this.fetch=()=>{$.ajax({type:"GET",url:"/display_name_moderations",dataType:"json",success:this.handleFetch.bind(this)})},this.stateUpdate=t=>{const{display_name_moderations:e}=this.state,n=e.filter(e=>e.id!==t),i={display_name_moderations:n};Ne(n.length),this.setState(i)},this.findNameObj=t=>{const{state:e}=this;return e.display_name_moderations.find(e=>e.id===t)},this.approve=t=>{const e=this.findNameObj(t);if(!e)return;const n=e.new_display_name;n&&Se(n,"approve"),$.ajax({type:"POST",url:`/display_name_moderations/${t}/approve`,dataType:"json",success:this.stateUpdate.bind(this,t),error:e=>{404!==e.status&&403!==e.status||this.stateUpdate.bind(this,t)}});Fo({nameModeration:n,action:"approve"})},this.delete=t=>{const e=this.findNameObj(t);if(!e)return;const n=e.new_display_name;n&&Se(n,"reject"),$.ajax({type:"DELETE",url:"/display_name_moderations/"+t,dataType:"json",success:this.stateUpdate.bind(this,t),error:e=>{404!==e.status&&403!==e.status||this.stateUpdate.bind(this,t)}});Fo({nameModeration:n,action:"reject"})},this.approveSelectedElements=()=>{const{state:t}=this;t.selectedElements.slice().forEach(e=>{const n=t.display_name_moderations.find(t=>t.id===e);n&&this.approve(n.id)}),this.setState({selectedElements:[]})},this.deleteSelectedElements=()=>{const{state:t}=this;t.selectedElements.slice().forEach(e=>{this.delete(e);const n=t.display_name_moderations.findIndex(t=>t.id===e);t.display_name_moderations.splice(n,1)}),this.setState({selectedElements:[]})},this.state={display_name_moderations:[],selectedElements:[],interval:void 0}}componentDidMount(){document.body.classList.add("picModMounted"),this.fetch(),this.update()}componentWillUnmount(){const{interval:t}=this.state;t&&clearInterval(t),document.body.classList.remove("picModMounted")}toggleElementSelection(t){var e;const{display_name_moderations:n,selectedElements:i}=this.state,r=null===(e=n.find(e=>e.id===t))||void 0===e?void 0:e.new_display_name,o=n.filter(t=>t.new_display_name===r).map(t=>t.id);let s;s=i.includes(t)?i.filter(t=>!o.includes(t)):[...i,...o],this.setState({selectedElements:s})}selectAllElements(){const{display_name_moderations:t,selectedElements:e}=this.state,n=t.map(t=>t.id);n.every(t=>e.includes(t))?this.setState({selectedElements:[]}):this.setState({selectedElements:n})}actionButtons(){const{display_name_moderations:t,selectedElements:e}=this.state;return ot.a.createElement("div",null,ot.a.createElement("button",{onClick:()=>{this.approveSelectedElements()},type:"button"},"Approve Selected Names"),ot.a.createElement("button",{onClick:()=>{this.deleteSelectedElements()},type:"button"},"Delete Selected Names"),ot.a.createElement("button",{onClick:()=>{this.selectAllElements()},type:"button"},e.length&&t.length===e.length?"Unselect All":"Select All"),ot.a.createElement("button",{onClick:_e,type:"button"},"Clear Cache"))}render(){const{display_name_moderations:t,selectedElements:e}=this.state,n=t=>{this.toggleElementSelection(t)};return ot.a.createElement("div",{className:"dashboard-container"},this.actionButtons(),ot.a.createElement("br",null),ot.a.createElement("div",{className:"meet-cards-container video-moderation"},t.map(t=>ot.a.createElement("div",{key:t.id,className:"checkmark-button-container"},ot.a.createElement(ke,{isSelected:e.includes(t.id),onClick:()=>n(t.id)}),ot.a.createElement(DisplayNameModerationUnit,{key:"picture_moderation"+t.id,data:t,delete:this.delete,approve:this.approve})))),t.length?this.actionButtons():void 0,ot.a.createElement("br",null))}}function Go(){VideoModerationUnit.prototype.render=function(){const{data:t}=this.props;return ot.a.createElement("div",{className:"dashboard-button animated",style:{paddingTop:"30px"}},ot.a.createElement("div",{className:"room-component-message-left"},ot.a.createElement("img",{onMouseDown:e=>{UserViewGenerator.generate({event:e,user:t})},src:t.display_picture,alt:"",className:"room-component-message-avatar"})),ot.a.createElement("p",null,t.display_name+(t.gold?"(G)":"")),ot.a.createElement("div",{className:"images-container"},ot.a.createElement("div",{className:"grid-item arrow",style:{marginLeft:"-15px"},title:"Previous",onClick:this.previous},ot.a.createElement("span",{className:"material-icons"},"arrow_back")),ot.a.createElement("img",{className:"grid-item",alt:"",src:t.images[this.state.imageId],onMouseDown:()=>(t=>{const e=ot.a.createElement(Picture,{data:{src:t}});ai.a.render(e,document.getElementById("ui-hatch-2"))})(t.images[this.state.imageId])}),ot.a.createElement("div",{className:"grid-item arrow",style:{marginRight:"-20px"},title:"Next",onClick:this.next},ot.a.createElement("span",{className:"material-icons"},"arrow_forward"))),ot.a.createElement("div",null,this.state.imageId+1," out of ",t.images.length),ot.a.createElement("button",{className:"ui-button-match-mega gold-button",type:"button",onClick:this.delete},"Delete"))}}function zo(){lt(Mo.a),Vo(),Oo(),PictureModeration=Lo,PictureModerationUnit.prototype.render=function(){const{data:t}=this.props;return ot.a.createElement("div",{className:"dashboard-button animated",style:{paddingTop:"30px",height:"400px"}},ot.a.createElement("div",null,ot.a.createElement("img",{src:t.image_url,onMouseDown:function(){const e=ot.a.createElement(Picture,{data:{src:t.image_url}});ai.a.render(e,document.getElementById("ui-hatch-2"))},alt:"",className:"mod-approval-pic"})),ot.a.createElement("div",{onMouseDown:async e=>{let n;n=this.state?this.state.user:(await Ce(t.user_id)).user,this.setState({user:n}),UserViewGenerator.generate({event:e,user:n})}},ot.a.createElement("h2",null,`${t.display_name}(${t.username})`)),ot.a.createElement("button",{className:"ui-button-match-mega gold-button",onClick:this.approve,type:"button"},"Approve"),ot.a.createElement("button",{className:"ui-button-match-mega red-button",onClick:this.delete,type:"button"},"Reject"))},DisplayNameModeration=Bo,DisplayNameModerationUnit.prototype.render=function(){const{data:t}=this.props;return ot.a.createElement("div",{className:"dashboard-button animated",style:{paddingTop:"30px",height:"300px"}},ot.a.createElement("div",{onMouseDown:async e=>{let n;n=this.state?this.state.user:(await Ce(t.user_id)).user,this.setState({user:n}),UserViewGenerator.generate({event:e,user:n})}},ot.a.createElement("h2",{style:{whiteSpace:"normal"}},"New: ",t.new_display_name),ot.a.createElement("h2",{style:{whiteSpace:"normal"}},"Old: ",t.old_display_name),ot.a.createElement("h2",null,"(",this.props.data.username,")")),ot.a.createElement("button",{className:"ui-button-match-mega gold-button",onClick:this.approve},"Approve"),ot.a.createElement("button",{className:"ui-button-match-mega red-button",onClick:this.delete},"Reject"))},Go(),To(),ModPanel.prototype.issue_ban_menu=function(){return ot.a.createElement(Do,{reasons:Io})}}!async function(){const t=`(${[]})`;i.log(`${s} Version ${c} ${t}`),async function(){Notifications.prototype.update=Gr,NotificationsReact&&(NotificationsReact.update=Gr,NotificationsReact.state&&NotificationsReact.state.data?Br(NotificationsReact.state.data):console.warn("failed to filter friend requests early"))}(),await(async t=>{for(;!t();)await pt()})(()=>!!x.App),bo.forEach(([t,e])=>{t.displayName=e}),wi(),function(){if("undefined"==typeof GM_getValue)return;const t=GM_getValue("theme",!1);t&&(et.set(Z.theme,t),i.log("Migrated THEME"),GM_deleteValue("theme"));const e=GM_getValue("hacks",!1);e&&(et.set(Z.adBlocker,!!e.disableNags),et.set(Z.fancyColors,!!e.fancyColors),i.log("Migrated HACKS"),GM_deleteValue("hacks"));const n=GM_getValue("settings",!1);n&&(et.set(Z.imgControl,!!n.imgControl),et.set(Z.imgProtect,!!n.imgProtect),et.set(Z.showInfo,!!n.showInfo),i.log("Migrated SETTINGS"),GM_deleteValue("settings"));const r=GM_getValue("blockedPictures",!1);if(r instanceof Array){const t=[...et.get(Z.blockedHashes)];r.forEach(e=>{t.includes(e)||t.push(e)}),et.set(Z.blockedHashes,t),i.log("Migrated BLOCKED PICTURES"),GM_deleteValue("blockedPictures")}const o=GM_getValue("savedPictures",!1);if(o instanceof Array){const t=[...et.get(Z.savedPictures)];o.forEach(e=>{t.includes(e)||t.push(e)}),et.set(Z.savedPictures,t),i.log("Migrated SAVED PICTURES"),GM_deleteValue("savedPictures")}}(),Si(),oi(),lt(Ft.a),document.body.addEventListener("mouseup",({target:t})=>{t instanceof HTMLElement&&t.classList.contains("mute-button")&&Cookies.set("muted",MuteButtonClient.state.muted?"t":"")}),MuteButton.prototype.componentDidMount=function(){const t=Cookies.get("muted");this.setState({muted:"t"===t||void 0===t})},yr(),Kn(),yi.load(),ki.load(),lt(Zt.a),ze(),Ke(),lt(Fe.a),function(){const t=RoomChannelSelect.prototype.join;RoomChannelSelect.prototype.join=function(e){e.members&&(e.members=xt(e.members)),t.call(this,e)};const e=RoomPrivate.prototype.setState;function n(){var t,e;null===(t=document.querySelector(".wfaf"))||void 0===t||t.classList.remove("channel-unit-active"),null===(e=document.querySelector(".private-rooms"))||void 0===e||e.classList.remove("channel-unit-active"),ht(App.room.client,"received",Xt,!0)}RoomPrivate.prototype.setState=function(t){return t&&"online"in t&&(t.online=xt(t.online)),t&&"offline"in t&&(t.offline=xt(t.offline)),e.call(this,t)},ht(App.room,"join",n),App.room.client&&n()}(),function(){const t=et.get(Z.showGender);document.documentElement.classList.toggle("showGender",t),lt(be.a);const e=MessageNotificationUnit.prototype.image;MessageNotificationUnit.prototype.image=function(){return ve.call(this,e)};const n=NotificationUnit.prototype.image;NotificationUnit.prototype.image=function(){return ve.call(this,n)};const i=SearchUnit.prototype.body;SearchUnit.prototype.body=function(){return ve.call(this,i)};const r=UserUnit.prototype.body;UserUnit.prototype.body=function(){return ve.call(this,r)};const o=FriendUnit.prototype.body;FriendUnit.prototype.body=function(){return ve.call(this,o)};const s=RoomUserUnit.prototype.body;RoomUserUnit.prototype.body=function(){return ve.call(this,s)};const a=Message.prototype.render;Message.prototype.render=function(){var t,e;const n=a.apply(this);return n&&"object"==typeof n&&"props"in n&&(n.props.children[0].props.children=ot.a.cloneElement(n.props.children[0].props.children,{"data-gender":null!==(e=null===(t=$t(this.props.data.user))||void 0===t?void 0:t.gender)&&void 0!==e?e:""})),n}}(),Wn(),Or(),function(){RoomChannelMembers.prototype.body=function(){const{members:t}=this.state;if(!t)return null;if(t.length<1)return ot.a.createElement("div",{className:"room-component-module"},ot.a.createElement("div",{className:"room-user-label"},Rr));const e=xt(t).map(t=>ot.a.createElement(UserUnit,{key:t.id,data:t}));return ot.a.createElement("div",{className:"room-component-module"},ot.a.createElement("div",{className:"room-user-label"},Rr,"online  "+t.length,Mr),e)};const t=RoomChannelMembers.prototype.setState;RoomChannelMembers.prototype.setState=function(e){var n;if(!e||!("members"in e))return;this.state.members||console.warn("this.state.members is falsy despite declaration");const i=xt(null!==(n=this.state.members)&&void 0!==n?n:[]).map(t=>t.id),r=xt(e.members),[o,s]=et.get(Z.userSort).split("."),a="asc"===s?"asc":"desc";"age"===o?vt(r,"id",bt(gt.numeric),a,!0):vt(r,"display_name",gt.string,a,!0),r.forEach(t=>{var e;i.some((e=t.id,t=>e===t))||x.RxE.dispatchEvent("room.userlist",t)}),e.members=r,t.call(this,e)},Room.prototype.disconnected=function(t){"channel"===this.state.mode&&RoomChannelMembersClient.remove_member(t.user)},lt(Ar.a)}(),function(){function t(){NotificationsReact.update(),null===UserViewReact||void 0===UserViewReact||UserViewReact.forceUpdate(),null===RoomClient||void 0===RoomClient||RoomClient.forceUpdate()}App.room.muted.push(...et.get(Z.permaMuteList).map(t=>t[0])),UserView.prototype.bottom=function(){const{id:t}=this.state.user,e=App.room.muted.includes(t),n=et.get(Z.permaMuteList).map(t=>t[0]).includes(t);return ot.a.createElement("div",{className:"user-profile-micro-bottom"},ot.a.createElement("div",{onMouseDown:this.view_profile.bind(this),className:"user-profile-micro-button"},"View Profile"),ot.a.createElement("div",{onMouseDown:this.message.bind(this),className:"user-profile-micro-button"},"Message"),this.mod_button(),ot.a.createElement("div",{onMouseDown:e?this.unmute.bind(this):this.mute.bind(this),className:"user-profile-micro-button",disabled:n},e?"Unmute":"Mute"),ot.a.createElement("div",{onMouseDown:n?this.permaunmute.bind(this):this.permamute.bind(this),className:"user-profile-micro-button"},n?"Perma Unmute":"Perma Mute"),ot.a.createElement("div",{onMouseDown:this.report_type.bind(this),className:"user-profile-micro-button"},"Report"),ot.a.createElement("div",{onMouseDown:this.close.bind(this),className:"user-profile-micro-button"},"Close"))},UserView.prototype.permamute=function(){const{id:e,display_name:n}=this.state.user;pn.addItem({key:e,item:n},Z.permaMuteList),App.room.mute(e,n,"Permamuted by user"),t()},UserView.prototype.permaunmute=function(){const{id:e}=this.state.user;pn.removeItem({key:e},Z.permaMuteList),App.room.unmute(e),t(),Wt(e)},UserView.prototype.mute=function(){App.room.mute(this.state.user.id),this.setState({muted:!0}),t()},UserView.prototype.unmute=function(){const{id:e}=this.state.user;App.room.unmute(e),this.setState({muted:!1}),t(),Wt(e)}}(),Ur(),function(){function t(t){const{data:e}=this.state;void 0!==e&&(e.comments.unshift(t.comment.id),this.setState({data:e,compact:this.state.compact,reply:!0}))}function e(t){const e=this.state.data||{microposts:[]};this.setState({data:{microposts:[t.micropost.id,...e.microposts]}})}function n(){return this.state.reply?ot.a.createElement("div",{className:"animated zoomIn user-comment-input-background"},ot.a.createElement("textarea",{className:"user-comment-input",onKeyDown:this.comment_input.bind(this),id:"comment-input",placeholder:"Comment..."})):null}lt(Fr.a),Room.prototype.input=function(t){const e=$(t.target),n=""+e.val(),i="ArrowUp"===t.key&&this.state.last_message;Lr(t)?(this.send(n),this.setState({last_message:n}),e.val(""),e.css("height","34px")):i&&e.val(this.state.last_message),0!==n.length&&n.includes("\n")||e.css("height","34px");const r=e.get(0);r.style.height=r.scrollHeight+"px",document.onpaste=Vr,null===RoomClient||void 0===RoomClient||RoomClient.scroll(),(Lr(t)||i)&&t.preventDefault(),Lr(t)||App.room.client.typing()},Micropost.prototype.comment_input=function(e){var n;if(!Lr(e))return;const i=$(e.target),r=encodeURIComponent(""+i.val());this.setState({data:this.state.data,reply:!1,compact:this.state.compact}),i.val(""),e.preventDefault(),i.trigger("blur");const o=null===(n=this.state.data)||void 0===n?void 0:n.micropost.id;void 0!==o&&$.ajax({type:"GET",url:`/comments_create?id=${o}&content=${r}`,dataType:"json",success:t.bind(this)})},Microposts.prototype.micropost_input=function(t){if(t.target instanceof HTMLInputElement)return;const n=$(t.target),i=encodeURIComponent(""+n.val());if(!Lr(t))return;n.val(""),n.trigger("blur"),t.preventDefault();const r=this.props.data.wall_id;$.ajax({type:"GET",url:`/microposts_create?id=${r}&content=${i}`,dataType:"json",success:e.bind(this)})},Microposts.prototype.render=function(){const t=this.state.data?this.state.data.microposts:[],e=ot.a.createElement("div",{className:"user-microposts"},t.map(t=>ot.a.createElement(Micropost,{key:t,data:{id:t}}))),n=ot.a.createElement("div",{className:"user-micropost-input-background"},ot.a.createElement("textarea",{className:"user-micropost-input",onKeyDown:this.micropost_input.bind(this),id:"micropost-input",placeholder:"Say Something..."}));return ot.a.createElement("span",{key:this.props.data.wall_id},n,e)},Micropost.prototype.write_comment=n,Comment.prototype.write_comment=n}(),qr(),go(),ho(),ko(),Co(),zo(),function(){if(!et.get(Z.hideTyping))return;const t=App.room.join;App.room.join=function(e){t.call(this,e),App.room.client.typing=function(){}}}(),lt(sn.a),lt(ye.a),function(t){function e(){t.forEach(t=>t())}let n;new MutationObserver(()=>{cancelAnimationFrame(n),n=requestAnimationFrame(e)}).observe(document.body,{subtree:!0,childList:!0}),e()}([Ro,te,un,Ti,xr,Ue,Ci,pe,Qn,Vt,me,Dr])}()}]);